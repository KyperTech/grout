<!doctype html>
<html lang='en'>
<head>
  <meta charset='utf-8'>
  <title>Matter-Client | Tester</title>
  <script src="https://cdn.firebase.com/js/client/2.2.9/firebase.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
  <!-- Polyfill (required by Babel) -->
  <script src='src/lib/superagent.js'></script>
  <script src='src/lib/aws-sdk-2.1.45.js'></script>
  <script src='dist/matter-client.js'></script>
  <script>
    var matter = new MatterClient();
    console.log('matter:', matter);
    document.addEventListener("DOMContentLoaded", function(event) { 
      if(matter.getAuthToken()){
        document.getElementById("status").innerHTML = "True";
      }
    });
    
    function login(){
      console.log('login called');
      matter.login({username:'test', password:'test'}).then(function(loginInfo){
        console.log('successful login:', loginInfo);
        document.getElementById("status").innerHTML = "True";
      });   
    }
    function logout(){
      console.log('logout called');
      matter.logout().then(function(){
        console.log('successful logout');
        document.getElementById("status").innerHTML = "False";
      });   
    }
    function getApps(){
      console.log('getApps called');
      matter.apps.get().then(function(appsList){
        console.log('apps list loaded:', appsList);
        var outHtml = '<ul>';
        appsList.forEach(function(app){
        	outHtml += '<li>' + app.name + '</li></br>'
        });
        outHtml += '</ul>';
        document.getElementById("output").innerHTML = outHtml;
      });   
    }
    function getStructure(){
      console.log('getStructure called');
      matter.app('exampleApp').getStructure().then(function(app){
        console.log('apps list loaded:', app);
        document.getElementById("output").innerHTML = JSON.stringify(app);
      });   
    }
  </script>

</head>
<body>
  <div style="text-align:center;">
    <h2>Matter Client Tester</h2>
    <h4>Logged In: <span id='status'>False</span></h4>
      <p class="submit">
        <button onclick="login()">Login As Test User</button>
        <button onclick="logout()">Logout</button>
      </p>
      <p>
        <button onclick="getApps()">Get Apps</button>
        <button onclick="getStructure()">Get Structure</button>
      	<span id="output"></span>
      </p>
  </div>

</body>
</html>
