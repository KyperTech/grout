{"version":3,"sources":["grout.min.js","/source/grout.js"],"names":["_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_classCallCheck","instance","Constructor","_get","_x","_x2","_x3","_again","object","property","receiver","Function","desc","getOwnPropertyDescriptor","undefined","getter","get","call","parent","getPrototypeOf","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","global","factory","exports","module","require","define","amd","Grout","Matter","_","Firepad","Firebase","AWS","this","_setAWSConfig","config","update","credentials","CognitoIdentityCredentials","IdentityPoolId","aws","cognito","poolId","region","setAWSConfig","childrenStructureFromArray","fileArray","mappedStructure","map","file","buildStructureObject","combineLikeObjs","pathArray","has","path","split","Key","pick","name","currentObj","type","finalObj","each","loc","ind","list","take","join","children","$id","mappedArray","takenNames","finishedArray","obj","indexOf","push","likeObj","findWhere","union","serverUrl","tokenName","fbUrl","appName","matterOptions","localServer","params","AuthRoleArn","UnauthRoleArn","matter","________request","utils","request","___________logger","logger","_Directory","actionData","isObject","directoryName","isString","error","description","func","Error","directoryEndpoint","then","response","info","errRes","Promise","reject","directoryData","debug","put","endpointArray","endpoint","app","splice","endpointStr","log","_______request","__________logger","DirectoriesAction","action","providedData","directoriesEndpoint","descrption","appData","post","query","searchEndpoint","resolve","______request","_________logger","_Group","groupData","groupEndpoint","text","del","accountsData","accountsArray","message","accounts","_____request","________logger","GroupsAction","groupsEndpoint","newGroupData","____request","_______logger","_Account","accountData","extend","username","accountEndpoint","______logger","AccountsAction","accountsEndpoint","newAccount","___request","_____logger","_Template","templateData","templateEndpoint","____logger","__request","TemplatesAction","templatesEndpoint","___logger","_File","fileData","_this","frontend","err","_ret","s3","S3","getData","Bucket","bucketName","contentType","ContentType","finalData","v","getObject","data","content","Body","toString","metaData","Metadata","_this2","_ret2","saveParams","ACL","putObject","_this3","_ret3","deleteObject","editor","_this4","firepad","firepadFromAce","on","setTheme","fromACE","settings","defaultText","isLoggedIn","currentUser","userId","fbRef","_this5","child","usersSnap","val","usersArray","forEach","userSnap","user","users","ext","re","exec","safeArray","replace","safePathArray","url","safePath","__logger","Files","filesData","isArray","_this6","warn","applicationData","_ret5","listParams","listObjects","Contents","filesArray","childStruct","childStructure","_request","_logger","Application","appEndpoint","application","_this7","userData","AppsAction","appsEndpoint","_Matter","template"],"mappings":"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","file":"grout.min.js","sourcesContent":["var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('kyper-matter'), require('lodash'), require('firepad'), require('firebase'), require('aws-sdk')) : typeof define === 'function' && define.amd ? define(['kyper-matter', 'lodash', 'firepad', 'firebase', 'aws-sdk'], factory) : global.Grout = factory(global.Matter, global._, global.Firepad, global.Firebase, global.AWS);\n})(this, function (Matter, _, Firepad, Firebase, AWS) {\n\t'use strict';\n\n\tMatter = 'default' in Matter ? Matter['default'] : Matter;\n\t_ = 'default' in _ ? _['default'] : _;\n\tFirepad = 'default' in Firepad ? Firepad['default'] : Firepad;\n\tFirebase = 'default' in Firebase ? Firebase['default'] : Firebase;\n\tAWS = 'default' in AWS ? AWS['default'] : AWS;\n\n\tvar config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'grout',\n\t\tfbUrl: 'https://kyper-tech.firebaseio.com/tessellate',\n\t\tappName: 'tessellate',\n\t\tmatterOptions: {\n\t\t\tlocalServer: false\n\t\t},\n\t\taws: {\n\t\t\tregion: 'us-east-1',\n\t\t\tcognito: {\n\t\t\t\tpoolId: 'us-east-1:72a20ffd-c638-48b0-b234-3312b3e64b2e',\n\t\t\t\tparams: {\n\t\t\t\t\tAuthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateUnauth_Role',\n\t\t\t\t\tUnauthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateAuth_Role'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tvar matter = new Matter(config.appName, config.matterOptions);\n\n\tvar ________request = matter.utils.request;\n\tvar ___________logger = matter.utils.logger;\n\n\t//Actions for specific directory\n\n\tvar _Directory = (function () {\n\t\tfunction _Directory(actionData) {\n\t\t\t_classCallCheck(this, _Directory);\n\n\t\t\tif (actionData && _.isObject(actionData) && (_.has(actionData, 'directoryName') || _.has(actionData, 'name'))) {\n\t\t\t\t//Data is object containing directory data\n\t\t\t\tthis.name = actionData.directoryName || actionData.name;\n\t\t\t\tif (_.has(actionData, 'appName')) {\n\t\t\t\t\tthis.appName = actionData.appName;\n\t\t\t\t}\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\t//Data is string name\n\t\t\t\tthis.name = actionData;\n\t\t\t} else {\n\t\t\t\t___________logger.error({\n\t\t\t\t\tdescription: 'Action data object with name is required to start a Directory Action.',\n\t\t\t\t\tfunc: 'constructor', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\tthrow new Error('Directory Data object with name is required to start a Directory action.');\n\t\t\t}\n\t\t}\n\n\t\t_createClass(_Directory, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get userlications or single userlication\n\t\t\tvalue: function get() {\n\t\t\t\treturn ________request.get(this.directoryEndpoint).then(function (response) {\n\t\t\t\t\t___________logger.info({\n\t\t\t\t\t\tdescription: 'Directory data loaded successfully.',\n\t\t\t\t\t\tresponse: response, func: 'get', obj: 'Directory'\n\t\t\t\t\t});\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t___________logger.info({\n\t\t\t\t\t\tdescription: 'Error getting directory.',\n\t\t\t\t\t\terror: errRes, func: 'get', obj: 'Directory'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Update an Directory\n\t\t}, {\n\t\t\tkey: 'update',\n\t\t\tvalue: function update(directoryData) {\n\t\t\t\t___________logger.debug({\n\t\t\t\t\tdescription: 'Directory updated called.',\n\t\t\t\t\tdirectoryData: directoryData, func: 'update', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn matter.utils.request.put(this.directoryEndpoint, directoryData).then(function (response) {\n\t\t\t\t\t___________logger.info({\n\t\t\t\t\t\tdescription: 'Directory updated successfully.',\n\t\t\t\t\t\tdirectoryData: directoryData, response: response,\n\t\t\t\t\t\tfunc: 'update', obj: 'Directory'\n\t\t\t\t\t});\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t___________logger.error({\n\t\t\t\t\t\tdescription: 'Error updating directory.',\n\t\t\t\t\t\tdirectoryData: directoryData, error: errRes,\n\t\t\t\t\t\tfunc: 'update', obj: 'Directory'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Delete an Directory\n\t\t}, {\n\t\t\tkey: 'del',\n\t\t\tvalue: function del(directoryData) {\n\t\t\t\t___________logger.debug({\n\t\t\t\t\tdescription: 'Delete directory called.',\n\t\t\t\t\tdirectoryData: directoryData, func: 'del', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn ________request['delete'](this.directoryEndpoint, directoryData).then(function (response) {\n\t\t\t\t\t___________logger.info({\n\t\t\t\t\t\tdescription: 'Directory deleted successfully.',\n\t\t\t\t\t\tdirectoryData: directoryData, func: 'del', obj: 'Directory'\n\t\t\t\t\t});\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t___________logger.error({\n\t\t\t\t\t\tdescription: 'Error deleting directory.',\n\t\t\t\t\t\terror: errRes, func: 'del', obj: 'Directory'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'directoryEndpoint',\n\t\t\tget: function get() {\n\t\t\t\tvar endpointArray = [matter.endpoint, 'directories', this.name];\n\t\t\t\t//Check for app account action\n\t\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t}\n\t\t\t\t//Create string from endpointArray\n\t\t\t\tvar endpointStr = endpointArray.join('/');\n\t\t\t\t___________logger.log({\n\t\t\t\t\tdescription: 'Directory endpoint built.',\n\t\t\t\t\tendpoint: endpointStr, func: 'directoryEndpoint',\n\t\t\t\t\tobj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn endpointStr;\n\t\t\t}\n\t\t}]);\n\n\t\treturn _Directory;\n\t})();\n\n\tvar _______request = matter.utils.request;\n\tvar __________logger = matter.utils.logger;\n\n\t//Actions for directories list\n\n\tvar DirectoriesAction = (function () {\n\t\tfunction DirectoriesAction(actionData) {\n\t\t\t_classCallCheck(this, DirectoriesAction);\n\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t__________logger.log({ description: 'Provided app data set to app parameter.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction' });\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = { name: actionData };\n\t\t\t\t__________logger.log({ description: 'App name provided as string was set.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction' });\n\t\t\t}\n\t\t\t__________logger.info({ description: 'New directories action.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction' });\n\t\t}\n\n\t\t_createClass(DirectoriesAction, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get users or single application\n\t\t\tvalue: function get() {\n\t\t\t\t__________logger.debug({ description: 'Directories get called.', action: this, func: 'get', obj: 'DirectoriesAction' });\n\t\t\t\treturn _______request.get(this.directoriesEndpoint).then(function (response) {\n\t\t\t\t\t__________logger.info({ descrption: 'Directories loaded successfully.', response: response, func: 'get', obj: 'DirectoriesAction' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t__________logger.error({ descrption: 'error getting users', error: errRes, func: 'get', obj: 'DirectoriesAction' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Add an application\n\t\t}, {\n\t\t\tkey: 'add',\n\t\t\tvalue: function add(appData) {\n\t\t\t\t__________logger.debug({ description: 'Add directory called.', action: this, appData: appData, func: 'get', obj: 'DirectoriesAction' });\n\t\t\t\treturn _______request.post(this.directoriesEndpoint, appData).then(function (response) {\n\t\t\t\t\t__________logger.log({ description: 'Application added successfully.', response: response, func: 'add', obj: 'DirectoriesAction' });\n\t\t\t\t\t//TODO: Return list of group objects\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t__________logger.error({ description: 'Error adding group.', error: errRes, func: 'add', obj: 'DirectoriesAction' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Search with partial of directory name\n\t\t}, {\n\t\t\tkey: 'search',\n\t\t\tvalue: function search(query) {\n\t\t\t\tvar searchEndpoint = this.directoriesEndpoint + '/search/';\n\t\t\t\tif (query && _.isString(query)) {\n\t\t\t\t\tsearchEndpoint += query;\n\t\t\t\t}\n\t\t\t\tif (!query || query == '') {\n\t\t\t\t\t__________logger.debug({ description: 'Null query, returning empty array.', func: 'search', obj: 'DirectoriesAction' });\n\t\t\t\t\treturn Promise.resolve([]);\n\t\t\t\t}\n\t\t\t\treturn _______request.get(searchEndpoint).then(function (response) {\n\t\t\t\t\t__________logger.log({ description: 'Found directories based on search.', response: response, func: 'search', obj: 'DirectoriesAction' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t__________logger.error({ description: 'Error searching directories.', error: errRes, func: 'search', obj: 'DirectoriesAction' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'directoriesEndpoint',\n\t\t\tget: function get() {\n\t\t\t\tvar endpointArray = [matter.endpoint, 'directories'];\n\t\t\t\t//Check for app groups action\n\t\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t}\n\t\t\t\t//Create string from endpointArray\n\t\t\t\tvar endpointStr = endpointArray.join('/');\n\t\t\t\t__________logger.log({ description: 'Directories endpoint built.', endpoint: endpointStr, func: 'directoriesEndpoint', obj: 'DirectoriesAction' });\n\t\t\t\treturn endpointStr;\n\t\t\t}\n\t\t}]);\n\n\t\treturn DirectoriesAction;\n\t})();\n\n\tvar ______request = matter.utils.request;\n\tvar _________logger = matter.utils.logger;\n\n\t//Actions for specific user\n\n\tvar _Group = (function () {\n\t\tfunction _Group(actionData) {\n\t\t\t_classCallCheck(this, _Group);\n\n\t\t\t//Call matter with name and settings\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'groupData')) {\n\t\t\t\t//Data is object containing group data\n\t\t\t\tthis.name = _.isObject(actionData.groupData) ? actionData.groupData.name : actionData.groupData;\n\t\t\t\tif (_.has(actionData, 'app')) {\n\t\t\t\t\tthis.app = actionData.app;\n\t\t\t\t}\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\t//Data is string name\n\t\t\t\tthis.name = actionData;\n\t\t\t} else {\n\t\t\t\t_________logger.error({ description: 'Action data is required to start a Group Action.', func: 'constructor', obj: 'Group' });\n\t\t\t\tthrow new Error('Username is required to start an Group');\n\t\t\t}\n\t\t}\n\n\t\t_createClass(_Group, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get userlications or single userlication\n\t\t\tvalue: function get() {\n\t\t\t\treturn ______request.get(this.groupEndpoint).then(function (response) {\n\t\t\t\t\t_________logger.info({ description: 'Group data loaded successfully.', response: response, func: 'get', obj: 'Group' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_________logger.info({ description: 'Error getting group.', error: errRes, func: 'get', obj: 'Group' });\n\t\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Update an Group\n\t\t}, {\n\t\t\tkey: 'update',\n\t\t\tvalue: function update(groupData) {\n\t\t\t\t_________logger.log({ description: 'Group updated called.', groupData: groupData, func: 'update', obj: 'Group' });\n\t\t\t\treturn matter.utils.request.put(this.groupEndpoint, groupData).then(function (response) {\n\t\t\t\t\t_________logger.info({ description: 'Group updated successfully.', groupData: groupData, response: response, func: 'update', obj: 'Group' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_________logger.error({ description: 'Error updating group.', groupData: groupData, error: errRes, func: 'update', obj: 'Group' });\n\t\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Delete an Group\n\t\t}, {\n\t\t\tkey: 'del',\n\t\t\tvalue: function del(groupData) {\n\t\t\t\t_________logger.log({ description: 'Delete group called.', groupData: groupData, func: 'del', obj: 'Group' });\n\t\t\t\treturn ______request.del(this.groupEndpoint, {}).then(function (response) {\n\t\t\t\t\t_________logger.info({ description: 'Group deleted successfully.', groupData: groupData, func: 'del', obj: 'Group' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_________logger.error({ description: 'Error deleting group.', error: errRes, text: errRes.response.text, groupData: groupData, func: 'del', obj: 'Group' });\n\t\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Update an Group\n\t\t}, {\n\t\t\tkey: 'addAccounts',\n\t\t\tvalue: function addAccounts(accountsData) {\n\t\t\t\t_________logger.log({ description: 'Group updated called.', accountsData: accountsData, func: 'update', obj: 'Group' });\n\t\t\t\tvar accountsArray = accountsData;\n\t\t\t\t//Handle provided data being a string list\n\t\t\t\tif (_.isString(accountsData)) {\n\t\t\t\t\taccountsArray = accountsData.split(',');\n\t\t\t\t}\n\t\t\t\t//Check item in array to see if it is a string (username) instead of _id\n\t\t\t\tif (_.isString(accountsArray[0])) {\n\t\t\t\t\t_________logger.error({ description: 'Accounts array only currently supports account._id not account.username.', accountsData: accountsData, func: 'update', obj: 'Group' });\n\t\t\t\t\treturn Promise.reject({ message: 'Accounts array only currently supports account._id not account.username.' });\n\t\t\t\t}\n\t\t\t\t_________logger.log({ description: 'Updating group with accounts array.', accountsArray: accountsArray, func: 'update', obj: 'Group' });\n\t\t\t\treturn this.update({ accounts: accountsArray }).then(function (response) {\n\t\t\t\t\t_________logger.info({ description: 'Account(s) added to group successfully.', response: response, func: 'addAccounts', obj: 'Group' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_________logger.error({ description: 'Error addAccountseting group.', error: errRes, func: 'addAccounts', obj: 'Group' });\n\t\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'groupEndpoint',\n\t\t\tget: function get() {\n\t\t\t\tvar endpointArray = [matter.endpoint, 'groups', this.name];\n\t\t\t\t//Check for app account action\n\n\t\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t}\n\t\t\t\t//Create string from endpointArray\n\t\t\t\tvar endpointStr = endpointArray.join('/');\n\t\t\t\t_________logger.log({ description: 'Group Endpoint built.', endpoint: endpointStr, func: 'groupEndpoint', obj: 'Group' });\n\t\t\t\treturn endpointStr;\n\t\t\t}\n\t\t}]);\n\n\t\treturn _Group;\n\t})();\n\n\tvar _____request = matter.utils.request;\n\tvar ________logger = matter.utils.logger;\n\n\t//Actions for users list\n\n\tvar GroupsAction = (function () {\n\t\tfunction GroupsAction(actionData) {\n\t\t\t_classCallCheck(this, GroupsAction);\n\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'Provided app data set to app parameter.',\n\t\t\t\t\taction: this, providedData: actionData,\n\t\t\t\t\tfunc: 'constructor', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = { name: actionData };\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'App name provided as string was set.',\n\t\t\t\t\taction: this, providedData: actionData,\n\t\t\t\t\tfunc: 'constructor', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t}\n\t\t\t________logger.info({\n\t\t\t\tdescription: 'New Groups action.', action: this,\n\t\t\t\tprovidedData: actionData, func: 'constructor', obj: 'GroupsAction'\n\t\t\t});\n\t\t}\n\n\t\t_createClass(GroupsAction, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get users or single application\n\t\t\tvalue: function get() {\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'Get group called.',\n\t\t\t\t\tfunc: 'get', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn _____request.get(this.groupsEndpoint).then(function (response) {\n\t\t\t\t\t________logger.info({\n\t\t\t\t\t\tdescription: 'Groups loaded successfully.',\n\t\t\t\t\t\tresponse: response, func: 'get', obj: 'GroupsAction'\n\t\t\t\t\t});\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t________logger.info({\n\t\t\t\t\t\tdescription: 'Error getting groups.', error: errRes,\n\t\t\t\t\t\tfunc: 'get', obj: 'GroupsAction'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Add an application\n\t\t}, {\n\t\t\tkey: 'add',\n\t\t\tvalue: function add(groupData) {\n\t\t\t\tvar newGroupData = groupData;\n\t\t\t\t________logger.debug({\n\t\t\t\t\tdescription: 'Add group called.', groupData: groupData,\n\t\t\t\t\tfunc: 'add', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\tif (_.isString(groupData)) {\n\t\t\t\t\t//Group data is string\n\t\t\t\t\tnewGroupData = { name: groupData };\n\t\t\t\t}\n\t\t\t\t________logger.debug({\n\t\t\t\t\tdescription: 'Add group called.', newGroupData: newGroupData,\n\t\t\t\t\tfunc: 'add', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn _____request.post(this.groupsEndpoint, newGroupData).then(function (response) {\n\t\t\t\t\t________logger.log({\n\t\t\t\t\t\tdescription: 'Group added to application successfully.',\n\t\t\t\t\t\tresponse: response, func: 'add', obj: 'GroupsAction'\n\t\t\t\t\t});\n\t\t\t\t\t//TODO: Return list of group objects\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t________logger.error({\n\t\t\t\t\t\tdescription: 'Error adding group.',\n\t\t\t\t\t\terror: errRes, func: 'add', obj: 'GroupsAction'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Search with partial of username\n\t\t}, {\n\t\t\tkey: 'search',\n\t\t\tvalue: function search(query) {\n\t\t\t\t________logger.debug({\n\t\t\t\t\tdescription: 'Search groups called.', query: query,\n\t\t\t\t\tfunc: 'search', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\tif (!query || query == '' || !_.isString(query)) {\n\t\t\t\t\t________logger.log({\n\t\t\t\t\t\tdescription: 'Null or invalid query, returning empty array.',\n\t\t\t\t\t\tfunc: 'search', obj: 'GroupsAction'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.resolve([]);\n\t\t\t\t}\n\t\t\t\tvar searchEndpoint = this.groupsEndpoint + '/search/' + query;\n\t\t\t\t________logger.debug({\n\t\t\t\t\tdescription: 'Search endpoint created.',\n\t\t\t\t\tendpoint: searchEndpoint, func: 'search', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn _____request.get(searchEndpoint).then(function (response) {\n\t\t\t\t\t________logger.log({\n\t\t\t\t\t\tdescription: 'Found groups based on search.',\n\t\t\t\t\t\tresponse: response, func: 'search', obj: 'GroupsAction'\n\t\t\t\t\t});\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t________logger.error({\n\t\t\t\t\t\tdescription: 'Error searching groups.',\n\t\t\t\t\t\terror: errRes, func: 'search', obj: 'GroupsAction'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'groupsEndpoint',\n\t\t\tget: function get() {\n\t\t\t\tvar endpointArray = [matter.endpoint, 'groups'];\n\t\t\t\t//Check for app groups action\n\t\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t}\n\t\t\t\t//Create string from endpointArray\n\t\t\t\tvar endpointStr = endpointArray.join('/');\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'Groups Endpoint built.', endpoint: endpointStr,\n\t\t\t\t\tfunc: 'groupsEndpoint', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn endpointStr;\n\t\t\t}\n\t\t}]);\n\n\t\treturn GroupsAction;\n\t})();\n\n\tvar ____request = matter.utils.request;\n\tvar _______logger = matter.utils.logger;\n\n\t//Actions for specific user\n\n\tvar _Account = (function () {\n\t\tfunction _Account(accountData) {\n\t\t\t_classCallCheck(this, _Account);\n\n\t\t\t//Call matter with name and settings\n\t\t\tif (accountData && _.isObject(accountData) && _.has(accountData, 'username')) {\n\t\t\t\t_.extend(this, accountData);\n\t\t\t} else if (accountData && _.isString(accountData)) {\n\t\t\t\tthis.username = accountData;\n\t\t\t} else {\n\t\t\t\t_______logger.error({\n\t\t\t\t\tdescription: 'AccountData is required to start an AccountAction',\n\t\t\t\t\tfunc: 'constructor', obj: 'Account'\n\t\t\t\t});\n\t\t\t\tthrow new Error('username is required to start an AccountAction');\n\t\t\t}\n\t\t}\n\n\t\t//Build endpoint based on accountData\n\n\t\t_createClass(_Account, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get a user\n\t\t\tvalue: function get() {\n\t\t\t\t_______logger.debug({ description: 'Account data loaded successfully.', func: 'get', obj: 'Account' });\n\t\t\t\treturn ____request.get(this.accountEndpoint).then(function (response) {\n\t\t\t\t\t_______logger.info({ description: 'Account data loaded successfully.', response: response, func: 'get', obj: 'Account' });\n\t\t\t\t\treturn new _Account(response);\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_______logger.error({ description: 'Error getting user.', error: errRes, func: 'get', obj: 'Account' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Update a Account\n\t\t}, {\n\t\t\tkey: 'update',\n\t\t\tvalue: function update(accountData) {\n\t\t\t\t_______logger.debug({ description: 'Update user called.', accountData: accountData, func: 'update', obj: 'Account' });\n\t\t\t\treturn ____request.put(this.accountEndpoint, accountData).then(function (response) {\n\t\t\t\t\t_______logger.info({ description: 'Account updated successfully.', func: 'update', obj: 'Account' });\n\t\t\t\t\t//TODO: Extend this with current info before returning\n\t\t\t\t\treturn new _Account(response);\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_______logger.error({ description: 'Error updating user.', func: 'update', obj: 'Account' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Delete a Account\n\t\t}, {\n\t\t\tkey: 'del',\n\t\t\tvalue: function del(accountData) {\n\t\t\t\t_______logger.debug({ description: 'Delete user called.', func: 'del', obj: 'Account' });\n\t\t\t\treturn ____request.del(this.accountEndpoint, accountData).then(function (response) {\n\t\t\t\t\t_______logger.info({ description: 'Delete user successful.', response: response, func: 'del', obj: 'Account' });\n\t\t\t\t\treturn new _Account(response);\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_______logger.error({ description: 'Error deleting user.', accountData: accountData, error: errRes, func: 'del', obj: 'Account' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'accountEndpoint',\n\t\t\tget: function get() {\n\t\t\t\tvar endpointArray = [matter.endpoint, 'accounts', this.username];\n\t\t\t\t//Check for app account action\n\t\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t}\n\t\t\t\t//Create string from endpointArray\n\t\t\t\tvar endpointStr = endpointArray.join('/');\n\t\t\t\t_______logger.log({ description: 'Account Endpoint built.', endpoint: endpointStr, func: 'accountEndpoint', obj: 'Account' });\n\t\t\t\treturn endpointStr;\n\t\t\t}\n\t\t}]);\n\n\t\treturn _Account;\n\t})();\n\n\tvar ______logger = matter.utils.logger;\n\t//Actions for accounts list\n\n\tvar AccountsAction = (function () {\n\t\tfunction AccountsAction(actionData) {\n\t\t\t_classCallCheck(this, AccountsAction);\n\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t______logger.log({ description: 'Provided app data set to app parameter.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction' });\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = { name: actionData };\n\t\t\t\t______logger.log({ description: 'App name provided as string was set.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction' });\n\t\t\t}\n\t\t\t______logger.info({ description: 'New Accounts action.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction' });\n\t\t}\n\n\t\t_createClass(AccountsAction, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get accounts or single application\n\t\t\tvalue: function get() {\n\t\t\t\t______logger.log({ description: 'Accounts get called.', func: 'get', obj: 'AccountsAction' });\n\t\t\t\treturn matter.utils.request.get(this.accountsEndpoint).then(function (response) {\n\t\t\t\t\t______logger.info({ description: 'Accounts loaded successfully.', func: 'get', obj: 'AccountsAction' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t______logger.info({ description: 'Error getting accounts.', error: errRes, func: 'get', obj: 'AccountsAction' });\n\t\t\t\t\treturn Promise.reject(errRes.message || 'Error getting accounts.');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Add an application\n\t\t}, {\n\t\t\tkey: 'add',\n\t\t\tvalue: function add(accountData) {\n\t\t\t\t______logger.info({ description: 'Account add called.', accountData: accountData, func: 'add', obj: 'AccountsAction' });\n\t\t\t\treturn this.utils.request.post(this.accountsEndpoint, accountData).then(function (response) {\n\t\t\t\t\t______logger.info({ description: 'Account added successfully.', response: response, newAccount: new _Account(response), func: 'add', obj: 'AccountsAction' });\n\t\t\t\t\treturn new _Account(response);\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t______logger.error({ description: 'Account add called.', error: errRes, accountData: accountData, func: 'add', obj: 'AccountsAction' });\n\t\t\t\t\treturn Promise.reject(errRes.message || 'Error adding account.');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Search with partial of accountname\n\t\t}, {\n\t\t\tkey: 'search',\n\t\t\tvalue: function search(query) {\n\t\t\t\t______logger.log({ description: 'Accounts search called.', query: query, func: 'search', obj: 'AccountsAction' });\n\t\t\t\tvar searchEndpoint = this.accountsEndpoint + '/search/';\n\t\t\t\tif (query && _.isString(query)) {\n\t\t\t\t\tsearchEndpoint += query;\n\t\t\t\t}\n\t\t\t\tif (!query || query == '') {\n\t\t\t\t\t______logger.log({ description: 'Null query, returning empty array.', func: 'search', obj: 'AccountsAction' });\n\t\t\t\t\treturn Promise.resolve([]);\n\t\t\t\t}\n\t\t\t\treturn matter.utils.request.get(searchEndpoint).then(function (response) {\n\t\t\t\t\t______logger.log({ description: 'Accounts search responded.', response: response, query: query, func: 'search', obj: 'AccountsAction' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t______logger.error({ description: 'Error searching Accounts.', error: errRes, query: query, func: 'search', obj: 'AccountsAction' });\n\t\t\t\t\treturn Promise.reject(errRes.message || 'Error searching accounts.');\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'accountsEndpoint',\n\t\t\tget: function get() {\n\t\t\t\tvar endpointArray = [matter.endpoint, 'accounts'];\n\t\t\t\t//Check for app account action\n\t\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t\t//Splice apps, appName into index 1\n\t\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t}\n\t\t\t\t//Create string from endpointArray\n\t\t\t\tvar endpointStr = endpointArray.join('/');\n\t\t\t\t______logger.log({ description: 'Accounts Endpoint built.', endpoint: endpointStr, func: 'accountsEndpoint', obj: 'AccountsAction' });\n\t\t\t\treturn endpointStr;\n\t\t\t}\n\t\t}]);\n\n\t\treturn AccountsAction;\n\t})();\n\n\tvar ___request = matter.utils.request;\n\tvar _____logger = matter.utils.logger;\n\t//Actions for specific user\n\n\tvar _Template = (function () {\n\t\tfunction _Template(templateData) {\n\t\t\t_classCallCheck(this, _Template);\n\n\t\t\t//Call matter with name and settings\n\t\t\tif (templateData && _.isString(templateData)) {\n\t\t\t\tthis.name = templateData;\n\t\t\t} else {\n\t\t\t\t_____logger.error({\n\t\t\t\t\tdescription: 'Template data is required to start a Template action.',\n\t\t\t\t\tfunc: 'constructor', obj: 'Template'\n\t\t\t\t});\n\t\t\t\tthrow new Error('Template data is required to start a Template action.');\n\t\t\t}\n\t\t}\n\n\t\t_createClass(_Template, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get userlications or single userlication\n\t\t\tvalue: function get() {\n\t\t\t\t_____logger.log({ description: 'Get template called.', name: this.name, func: 'get', obj: 'Template' });\n\t\t\t\treturn ___request.get(this.templateEndpoint).then(function (response) {\n\t\t\t\t\t_____logger.log({ description: 'Get template responded.', response: response, func: 'get', obj: 'Template' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_____logger.error({ description: 'Error getting template.', error: errRes, func: 'get', obj: 'Template' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Update an userlication\n\t\t}, {\n\t\t\tkey: 'update',\n\t\t\tvalue: function update(templateData) {\n\t\t\t\t_____logger.log({ description: 'Update template called.', templateData: templateData, func: 'update', obj: 'Template' });\n\t\t\t\treturn ___request.put(this.templateEndpoint, templateData).then(function (response) {\n\t\t\t\t\t_____logger.log({ description: 'Update template responded.', response: response, templateData: templateData, func: 'update', obj: 'Template' });\n\t\t\t\t\t//TODO: Return template object\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_____logger.error({ description: 'Error updating template.', error: errRes, func: 'update', obj: 'Template' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Delete a template\n\t\t}, {\n\t\t\tkey: 'del',\n\t\t\tvalue: function del(templateData) {\n\t\t\t\t_____logger.log({ description: 'Delete template called.', templateData: templateData, func: 'del', obj: 'Template' });\n\t\t\t\treturn ___request['delete'](this.endpoint, templateData).then(function (response) {\n\t\t\t\t\t_____logger.log({ description: 'Template deleted successfully.', response: response, func: 'del', obj: 'Template' });\n\t\t\t\t\t//TODO: Return template object\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_____logger.error({ description: 'Error deleting template.', error: errRes, func: 'del', obj: 'Template' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'templateEndpoint',\n\t\t\tget: function get() {\n\t\t\t\treturn matter.endpoint + '/templates/' + this.name;\n\t\t\t}\n\t\t}]);\n\n\t\treturn _Template;\n\t})();\n\n\tvar ____logger = matter.utils.logger;\n\tvar __request = matter.utils.request;\n\n\t//Actions for templates list\n\n\tvar TemplatesAction = (function () {\n\t\tfunction TemplatesAction() {\n\t\t\t_classCallCheck(this, TemplatesAction);\n\t\t}\n\n\t\t//Convenience vars\n\n\t\t_createClass(TemplatesAction, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get templates or single application\n\t\t\tvalue: function get() {\n\t\t\t\t____logger.log({ description: 'Get template called.', func: 'get', obj: 'TemplatesAction' });\n\t\t\t\treturn __request.get(this.templatesEndpoint).then(function (response) {\n\t\t\t\t\t____logger.log({ description: 'Templates loaded.', response: response, func: 'get', obj: 'TemplatesAction' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t____logger.error({ description: 'Error getting templates.', error: errRes, func: 'get', obj: 'TemplatesAction' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Add an application\n\t\t}, {\n\t\t\tkey: 'add',\n\t\t\tvalue: function add(appData) {\n\t\t\t\t____logger.log({ description: 'Add template called.', func: 'add', obj: 'TemplatesAction' });\n\t\t\t\treturn __request.post(this.templatesEndpoint, appData).then(function (response) {\n\t\t\t\t\t____logger.log({ description: 'Templates added successfully.', func: 'add', obj: 'TemplatesAction' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t____logger.error({ description: 'Error adding template.', error: errRes, func: 'add', obj: 'TemplatesAction' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Search with partial of username\n\t\t}, {\n\t\t\tkey: 'search',\n\t\t\tvalue: function search(query) {\n\t\t\t\t____logger.log({ description: 'Search template called.', query: query, func: 'search', obj: 'TemplatesAction' });\n\t\t\t\tvar searchEndpoint = this.templatesEndpoint + '/search/';\n\t\t\t\tif (query && _.isString(query)) {\n\t\t\t\t\tsearchEndpoint += query;\n\t\t\t\t}\n\t\t\t\t____logger.log({ description: 'Search endpoint created.', endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction' });\n\t\t\t\treturn __request.get(searchEndpoint).then(function (response) {\n\t\t\t\t\t____logger.log({ description: 'Template(s) found successfully.', response: response, endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction' });\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t____logger.log({ description: 'Error searching for templates.', query: query, error: errRes, endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'templatesEndpoint',\n\t\t\tget: function get() {\n\t\t\t\tvar endpointArray = [matter.endpoint, 'templates'];\n\t\t\t\t//Check for app groups action\n\t\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t\t// endpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t\t____logger.log({ description: 'Templates action is not currently supported for a specific application.', func: 'accountsEndpoint', obj: 'AccountsAction' });\n\t\t\t\t}\n\t\t\t\t//Create string from endpointArray\n\t\t\t\tvar endpointStr = endpointArray.join('/');\n\t\t\t\t____logger.log({ description: 'Templates endpoint built.', endpoint: endpointStr, func: 'templatesEndpoint', obj: 'TemplatesAction' });\n\t\t\t\treturn endpointStr;\n\t\t\t}\n\t\t}]);\n\n\t\treturn TemplatesAction;\n\t})();\n\n\tvar ___logger = matter.utils.logger;\n\n\tvar _File = (function () {\n\t\tfunction _File(actionData) {\n\t\t\t_classCallCheck(this, _File);\n\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'fileData') && _.has(actionData, 'app')) {\n\t\t\t\t_.extend(this, actionData.fileData);\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\tthis.pathArray = this.path.split('/');\n\t\t\t\t//Get name from data or from pathArray\n\t\t\t\tthis.name = _.has(actionData.fileData, 'name') ? actionData.fileData.name : this.pathArray[this.pathArray.length - 1];\n\t\t\t} else if (actionData && !_.isObject(actionData)) {\n\t\t\t\t___logger.error({\n\t\t\t\t\tdescription: 'File data is not an object. File data must be an object that includes path and appName.',\n\t\t\t\t\tfunc: 'constructor', obj: 'File'\n\t\t\t\t});\n\t\t\t\t//TODO: Get appName from path data?\n\t\t\t\tthrow new Error('File data must be an object that includes path and appName.');\n\t\t\t} else {\n\t\t\t\t___logger.error({ description: 'File data that includes path and app is needed to create a File action.', func: 'constructor', obj: 'File' });\n\t\t\t\tthrow new Error('File data with path and app is needed to create file action.');\n\t\t\t}\n\t\t\tthis.type = 'file';\n\t\t\t___logger.debug({ description: 'File object constructed.', file: this, func: 'constructor', obj: 'File' });\n\t\t}\n\n\t\t//------------------ Utility Functions ------------------//\n\n\t\t// AWS Config\n\n\t\t_createClass(_File, [{\n\t\t\tkey: 'get',\n\t\t\tvalue: function get() {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tif (!this.app || !this.app.frontend) {\n\t\t\t\t\t___logger.log({\n\t\t\t\t\t\tdescription: 'Application Frontend data not available. Calling applicaiton get.', func: 'get', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\treturn this.app.get().then(function (appData) {\n\t\t\t\t\t\t_this.app = appData;\n\t\t\t\t\t\t___logger.log({\n\t\t\t\t\t\t\tdescription: 'Application get successful. Getting file.',\n\t\t\t\t\t\t\tapp: appData, func: 'get', obj: 'File'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn _this.get();\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\tdescription: 'Application Frontend data not available.',\n\t\t\t\t\t\t\terror: err, func: 'get', obj: 'File'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn Promise.reject({ message: 'Front end data is required to get file.' });\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvar _ret = (function () {\n\t\t\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t\t\t___logger.log({\n\t\t\t\t\t\t\t\tdescription: 'AWS creds do not exist, so they are being set.',\n\t\t\t\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t_setAWSConfig();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar s3 = new AWS.S3();\n\t\t\t\t\t\tvar getData = {\n\t\t\t\t\t\t\tBucket: _this.app.frontend.bucketName,\n\t\t\t\t\t\t\tKey: _this.path\n\t\t\t\t\t\t};\n\t\t\t\t\t\t//Set contentType from actionData to ContentType parameter of new object\n\t\t\t\t\t\tif (_this.contentType) {\n\t\t\t\t\t\t\tgetData.ContentType = _this.contentType;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t___logger.debug({\n\t\t\t\t\t\t\tdescription: 'File get params built.', getData: getData,\n\t\t\t\t\t\t\tfile: _this, func: 'get', obj: 'File'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar finalData = _this;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: new Promise(function (resolve, reject) {\n\t\t\t\t\t\t\t\ts3.getObject(getData, function (err, data) {\n\t\t\t\t\t\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\t\t\t\tdescription: 'File loaded successfully.',\n\t\t\t\t\t\t\t\t\t\t\tdata: data, func: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tif (_.has(data, 'Body')) {\n\t\t\t\t\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\t\t\t\t\tdescription: 'File has content.',\n\t\t\t\t\t\t\t\t\t\t\t\tcontent: data.Body.toString(),\n\t\t\t\t\t\t\t\t\t\t\t\tmetaData: data.Metadata.toString(),\n\t\t\t\t\t\t\t\t\t\t\t\tfunc: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tfinalData.content = data.Body.toString();\n\t\t\t\t\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\t\t\t\t\tdescription: 'File content has been added to file.',\n\t\t\t\t\t\t\t\t\t\t\t\tfile: finalData,\n\t\t\t\t\t\t\t\t\t\t\t\tfunc: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tresolve(finalData);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\t\t\t\t\tdescription: 'Error loading file from S3.',\n\t\t\t\t\t\t\t\t\t\t\terror: err, func: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t};\n\t\t\t\t\t})();\n\n\t\t\t\t\tif (typeof _ret === 'object') return _ret.v;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Alias for get\n\t\t}, {\n\t\t\tkey: 'open',\n\t\t\tvalue: function open() {\n\t\t\t\treturn this.get();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'publish',\n\t\t\tvalue: function publish(fileData) {\n\t\t\t\tvar _this2 = this;\n\n\t\t\t\t//TODO: Publish file to application\n\t\t\t\t___logger.debug({\n\t\t\t\t\tdescription: 'File publish called.', file: this,\n\t\t\t\t\tfileData: fileData, func: 'publish', obj: 'File'\n\t\t\t\t});\n\t\t\t\tif (!this.app.frontend) {\n\t\t\t\t\t___logger.error({\n\t\t\t\t\t\tdescription: 'Application Frontend data not available. Make sure to call .get().',\n\t\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject({ message: 'Front end data is required to publish file.' });\n\t\t\t\t} else {\n\t\t\t\t\tvar _ret2 = (function () {\n\t\t\t\t\t\tif (!_.has(fileData, ['content', 'path'])) {\n\t\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\t\tdescription: 'File data including path and content required to publish.',\n\t\t\t\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tv: Promise.reject({ message: 'File data including path and content required to publish.' })\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar saveParams = {\n\t\t\t\t\t\t\tBucket: _this2.app.frontend.bucketName,\n\t\t\t\t\t\t\tKey: fileData.path,\n\t\t\t\t\t\t\tBody: fileData.content,\n\t\t\t\t\t\t\tACL: 'public-read'\n\t\t\t\t\t\t};\n\t\t\t\t\t\t//Set contentType from fileData to ContentType parameter of new object\n\t\t\t\t\t\tif (_this2.contentType) {\n\t\t\t\t\t\t\tsaveParams.ContentType = _this2.contentType;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t\t\t___logger.debug({\n\t\t\t\t\t\t\t\tdescription: 'AWS creds do not exist, so they are being set.',\n\t\t\t\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t_setAWSConfig();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar s3 = new AWS.S3();\n\t\t\t\t\t\t___logger.debug({\n\t\t\t\t\t\t\tdescription: 'File publish params built.',\n\t\t\t\t\t\t\tsaveParams: saveParams, fileData: _this2,\n\t\t\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: new Promise(function (resolve, reject) {\n\t\t\t\t\t\t\t\ts3.putObject(saveParams, function (err, data) {\n\t\t\t\t\t\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t\t\t\t___logger.log({\n\t\t\t\t\t\t\t\t\t\t\tdescription: 'File saved successfully.',\n\t\t\t\t\t\t\t\t\t\t\tresponse: data, func: 'publish', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\t\t\t\t\tdescription: 'Error saving file to S3.',\n\t\t\t\t\t\t\t\t\t\t\terror: err, func: 'publish', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t};\n\t\t\t\t\t})();\n\n\t\t\t\t\tif (typeof _ret2 === 'object') return _ret2.v;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'del',\n\t\t\tvalue: function del() {\n\t\t\t\tvar _this3 = this;\n\n\t\t\t\tif (!this.app || !this.app.frontend) {\n\t\t\t\t\t___logger.log({ description: 'Application Frontend data not available. Calling applicaiton get.', func: 'get', obj: 'File' });\n\t\t\t\t\treturn this.app.get().then(function (appData) {\n\t\t\t\t\t\t_this3.app = appData;\n\t\t\t\t\t\t___logger.log({ description: 'Application get successful. Getting file.', app: appData, func: 'get', obj: 'File' });\n\t\t\t\t\t\treturn _this3.get();\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\t___logger.error({ description: 'Application Frontend data not available. Make sure to call .get().', error: err, func: 'get', obj: 'File' });\n\t\t\t\t\t\treturn Promise.reject({ message: 'Front end data is required to get file.' });\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvar _ret3 = (function () {\n\t\t\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t\t\t___logger.debug({ description: 'AWS creds do not exist, so they are being set.', func: 'publish', obj: 'File' });\n\t\t\t\t\t\t\t_setAWSConfig();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar s3 = new AWS.S3();\n\t\t\t\t\t\tvar saveParams = {\n\t\t\t\t\t\t\tBucket: _this3.app.frontend.bucketName,\n\t\t\t\t\t\t\tKey: _this3.path\n\t\t\t\t\t\t};\n\t\t\t\t\t\t//Set contentType from actionData to ContentType parameter of new object\n\t\t\t\t\t\tif (_this3.contentType) {\n\t\t\t\t\t\t\tsaveParams.ContentType = _this3.contentType;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t___logger.debug({\n\t\t\t\t\t\t\tdescription: 'File get params built.',\n\t\t\t\t\t\t\tsaveParams: saveParams, file: _this3,\n\t\t\t\t\t\t\tfunc: 'get', obj: 'File'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: new Promise(function (resolve, reject) {\n\t\t\t\t\t\t\t\ts3.deleteObject(saveParams, function (err, data) {\n\t\t\t\t\t\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\t\t\t\tdescription: 'File loaded successfully.',\n\t\t\t\t\t\t\t\t\t\t\tfileData: data, func: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tif (_.has(data, 'Body')) {\n\t\t\t\t\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\t\t\t\t\tdescription: 'File has content.',\n\t\t\t\t\t\t\t\t\t\t\t\tfileData: data.Body.toString(), func: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tresolve(data.Body.toString());\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\t\t\t\t\tdescription: 'Error loading file from S3.',\n\t\t\t\t\t\t\t\t\t\t\terror: err, func: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t};\n\t\t\t\t\t})();\n\n\t\t\t\t\tif (typeof _ret3 === 'object') return _ret3.v;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'openInFirepad',\n\t\t\tvalue: function openInFirepad(editor) {\n\t\t\t\tvar _this4 = this;\n\n\t\t\t\t//Load file contents from s3\n\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\t_this4.get().then(function (file) {\n\t\t\t\t\t\t___logger.log({\n\t\t\t\t\t\t\tdescription: 'File contents loaded. Opening firepad.',\n\t\t\t\t\t\t\teditor: editor, file: file,\n\t\t\t\t\t\t\tfunc: 'openInFirepad', obj: 'File'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//Open firepad from ace with file content as default\n\t\t\t\t\t\tvar firepad = file.firepadFromAce(editor);\n\t\t\t\t\t\t//Wait for firepad to be ready\n\t\t\t\t\t\tfirepad.on('ready', function () {\n\t\t\t\t\t\t\tresolve(file);\n\t\t\t\t\t\t\t// firepad.setText()\n\t\t\t\t\t\t});\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\tdescription: 'Valid ace editor instance required to create firepad.',\n\t\t\t\t\t\t\tfunc: 'openInFirepad', obj: 'File', editor: editor\n\t\t\t\t\t\t});\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'firepadFromAce',\n\t\t\tvalue: function firepadFromAce(editor) {\n\t\t\t\t//TODO:Create new Firepad instance within div\n\t\t\t\tif (!editor || typeof editor.setTheme !== 'function') {\n\t\t\t\t\t___logger.error({\n\t\t\t\t\t\tdescription: 'Valid ace editor instance required to create firepad.',\n\t\t\t\t\t\tfunc: 'fbRef', obj: 'File', editor: editor\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof Firepad.fromACE !== 'function') {\n\t\t\t\t\t___logger.error({\n\t\t\t\t\t\tdescription: 'Firepad does not have fromACE method.',\n\t\t\t\t\t\tfirepad: Firepad, func: 'fbRef', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar settings = {};\n\t\t\t\tif (this.content) {\n\t\t\t\t\tsettings.defaultText = this.content;\n\t\t\t\t}\n\t\t\t\tif (matter.isLoggedIn && matter.currentUser) {\n\t\t\t\t\tsettings.userId = matter.currentUser.username || matter.currentUser.name;\n\t\t\t\t}\n\t\t\t\t___logger.log({\n\t\t\t\t\tdescription: 'Creating firepad from ace.',\n\t\t\t\t\tsettings: settings, func: 'fbRef', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn Firepad.fromACE(this.fbRef, editor, settings);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getConnectedUsers',\n\t\t\tvalue: function getConnectedUsers() {\n\t\t\t\tvar _this5 = this;\n\n\t\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\t\t_this5.fbRef.child('users').on('value', function (usersSnap) {\n\t\t\t\t\t\tif (usersSnap.val() === null) {\n\t\t\t\t\t\t\tresolve([]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t(function () {\n\t\t\t\t\t\t\t\tvar usersArray = [];\n\t\t\t\t\t\t\t\tusersSnap.forEach(function (userSnap) {\n\t\t\t\t\t\t\t\t\tvar user = userSnap.val();\n\t\t\t\t\t\t\t\t\tuser.username = userSnap.key();\n\t\t\t\t\t\t\t\t\tusersArray.push(user);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t___logger.log({\n\t\t\t\t\t\t\t\t\tdescription: 'Connected users array built.',\n\t\t\t\t\t\t\t\t\tusers: usersArray, func: 'connectedUsers', obj: 'File'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tresolve(usersArray);\n\t\t\t\t\t\t\t})();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\tdescription: 'Error loading connected users.',\n\t\t\t\t\t\t\terror: err, func: 'connectedUsers', obj: 'File'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getDefaultContent',\n\t\t\tvalue: function getDefaultContent() {\n\t\t\t\t//TODO: Fill with default data for matching file type\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'fileType',\n\t\t\tget: function get() {\n\t\t\t\tif (this.ext == 'js') {\n\t\t\t\t\treturn 'javascript';\n\t\t\t\t} else {\n\t\t\t\t\treturn this.ext;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'ext',\n\t\t\tget: function get() {\n\t\t\t\tvar re = /(?:\\.([^.]+))?$/;\n\t\t\t\treturn re.exec(this.name)[1];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'safePathArray',\n\t\t\tget: function get() {\n\t\t\t\tvar safeArray = this.pathArray.map(function (loc) {\n\t\t\t\t\t//Replace periods with colons and other unsafe chars as --\n\t\t\t\t\treturn loc.replace(/[.]/g, ':').replace(/[#$\\[\\]]/g, '--');\n\t\t\t\t});\n\t\t\t\t___logger.log({\n\t\t\t\t\tdescription: 'Safe path array created.',\n\t\t\t\t\tsafeArray: safeArray, func: 'safePathArray', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn safeArray;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'safePath',\n\t\t\tget: function get() {\n\t\t\t\treturn this.safePathArray.join('/');\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'fbUrl',\n\t\t\tget: function get() {\n\t\t\t\tvar url = [config.fbUrl, 'files', this.app.name, this.safePath].join('/');\n\t\t\t\t___logger.log({\n\t\t\t\t\tdescription: 'File ref url generated',\n\t\t\t\t\turl: url, func: 'fbRef', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn url;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'fbRef',\n\t\t\tget: function get() {\n\t\t\t\t___logger.log({\n\t\t\t\t\tdescription: 'Fb ref generatating.',\n\t\t\t\t\turl: this.fbUrl, func: 'fbRef', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn new Firebase(this.fbUrl);\n\t\t\t}\n\t\t}]);\n\n\t\treturn _File;\n\t})();\n\n\tfunction _setAWSConfig() {\n\t\tAWS.config.update({\n\t\t\tcredentials: new AWS.CognitoIdentityCredentials({\n\t\t\t\tIdentityPoolId: config.aws.cognito.poolId\n\t\t\t}),\n\t\t\tregion: config.aws.region\n\t\t});\n\t}\n\n\t//Convenience vars\n\tvar __logger = matter.utils.logger;\n\n\tvar Files = (function () {\n\t\tfunction Files(filesData) {\n\t\t\t_classCallCheck(this, Files);\n\n\t\t\tif (filesData && _.isObject(filesData) && _.has(filesData, 'app')) {\n\t\t\t\t//Data is object containing directory data\n\t\t\t\tthis.app = filesData.app;\n\t\t\t} else if (filesData && _.isString(filesData)) {\n\t\t\t\t//Data is string name\n\t\t\t\tthis.app = { name: filesData };\n\t\t\t} else if (filesData && _.isArray(filesData)) {\n\t\t\t\t//TODO: Handle an array of files being passed as data\n\t\t\t\t__logger.error({ description: 'Action data object with name is required to start a Files Action.', func: 'constructor', obj: 'Files' });\n\t\t\t\tthrow new Error('Files Data object with application is required to start a Files action.');\n\t\t\t} else {\n\t\t\t\t__logger.error({ description: 'Action data object with name is required to start a Files Action.', func: 'constructor', obj: 'Files' });\n\t\t\t\tthrow new Error('Files Data object with name is required to start a Files action.');\n\t\t\t}\n\t\t\t__logger.debug({ description: 'Files object constructed.', func: 'constructor', obj: 'Files' });\n\t\t}\n\n\t\t//------------------ Utility Functions ------------------//\n\n\t\t// AWS Config\n\n\t\t_createClass(Files, [{\n\t\t\tkey: 'publish',\n\t\t\tvalue: function publish() {\n\t\t\t\t//TODO: Publish all files\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'get',\n\t\t\tvalue: function get() {\n\t\t\t\tvar _this6 = this;\n\n\t\t\t\tif (!this.app.frontend || !this.app.frontend.bucketName) {\n\t\t\t\t\t__logger.warn({ description: 'Application Frontend data not available. Calling .get().', app: this.app, func: 'get', obj: 'Files' });\n\t\t\t\t\treturn this.app.get().then(function (applicationData) {\n\t\t\t\t\t\t__logger.log({ description: 'Application get returned.', data: applicationData, func: 'get', obj: 'Files' });\n\t\t\t\t\t\t_this6.app = applicationData;\n\t\t\t\t\t\tif (_.has(applicationData, 'frontend')) {\n\t\t\t\t\t\t\treturn _this6.get();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t__logger.error({ description: 'Application does not have Frontend to get files from.', func: 'get', obj: 'Files' });\n\t\t\t\t\t\t\treturn Promise.reject({ message: 'Application does not have frontend to get files from.' });\n\t\t\t\t\t\t}\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\t__logger.error({\n\t\t\t\t\t\t\tdescription: 'Application Frontend data not available. Make sure to call .get().',\n\t\t\t\t\t\t\terror: err, func: 'get', obj: 'Files' });\n\t\t\t\t\t\treturn Promise.reject({ message: 'Bucket name required to get objects' });\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvar _ret5 = (function () {\n\t\t\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t\t\t// logger.info('AWS creds are being updated to make request');\n\t\t\t\t\t\t\tsetAWSConfig();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar s3 = new AWS.S3();\n\t\t\t\t\t\tvar listParams = { Bucket: _this6.app.frontend.bucketName };\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: new Promise(function (resolve, reject) {\n\t\t\t\t\t\t\t\ts3.listObjects(listParams, function (err, data) {\n\t\t\t\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t\t\t\t__logger.info({ description: 'Files list loaded.', filesData: data, func: 'get', obj: 'Files' });\n\t\t\t\t\t\t\t\t\t\treturn resolve(data.Contents);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t__logger.error({ description: 'Error getting files from S3.', error: err, func: 'get', obj: 'Files' });\n\t\t\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t};\n\t\t\t\t\t})();\n\n\t\t\t\t\tif (typeof _ret5 === 'object') return _ret5.v;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'add',\n\t\t\tvalue: function add() {\n\t\t\t\t//TODO: Add a file to files list\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'del',\n\t\t\tvalue: function del() {\n\t\t\t\t//TODO: Delete a file from files list\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'buildStructure',\n\t\t\tvalue: function buildStructure() {\n\t\t\t\t__logger.debug({ description: 'Build Structure called.', func: 'buildStructure', obj: 'Application' });\n\t\t\t\treturn this.get().then(function (filesArray) {\n\t\t\t\t\tvar childStruct = childrenStructureFromArray(filesArray);\n\t\t\t\t\t//TODO: have child objects have correct classes (file/folder)\n\t\t\t\t\t__logger.log({ description: 'Child struct from array.', childStructure: childStruct, func: 'buildStructure', obj: 'Application' });\n\t\t\t\t\treturn childStruct;\n\t\t\t\t}, function (err) {\n\t\t\t\t\t__logger.error({ description: 'Error getting application files.', error: err, func: 'buildStructure', obj: 'Application' });\n\t\t\t\t\treturn Promise.reject({ message: 'Error getting files.', error: err });\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//ALIAS FOR buildStructure\n\t\t\t// get structure() {\n\t\t\t// \treturn this.buildStructure();\n\t\t\t// }\n\t\t}]);\n\n\t\treturn Files;\n\t})();\n\n\tfunction setAWSConfig() {\n\t\tAWS.config.update({\n\t\t\tcredentials: new AWS.CognitoIdentityCredentials({\n\t\t\t\tIdentityPoolId: config.aws.cognito.poolId\n\t\t\t}),\n\t\t\tregion: config.aws.region\n\t\t});\n\t}\n\t//Convert from array file structure (from S3) to 'children' structure used in Editor GUI (angular-tree-control)\n\t//Examples for two files (index.html and /testFolder/file.js):\n\t//Array structure: [{path:'index.html'}, {path:'testFolder/file.js'}]\n\t//Children Structure [{type:'folder', name:'testfolder', children:[{path:'testFolder/file.js', name:'file.js', filetype:'javascript', contentType:'application/javascript'}]}]\n\tfunction childrenStructureFromArray(fileArray) {\n\t\t// logger.log('childStructureFromArray called:', fileArray);\n\t\t//Create a object for each file that stores the file in the correct 'children' level\n\t\tvar mappedStructure = fileArray.map(function (file) {\n\t\t\treturn buildStructureObject(file);\n\t\t});\n\t\treturn combineLikeObjs(mappedStructure);\n\t}\n\t//Convert file with key into a folder/file children object\n\tfunction buildStructureObject(file) {\n\t\tvar pathArray;\n\t\t// console.log('buildStructureObject with:', file);\n\t\tif (_.has(file, 'path')) {\n\t\t\t//Coming from files already having path (structure)\n\t\t\tpathArray = file.path.split('/');\n\t\t} else {\n\t\t\t//Coming from aws\n\t\t\tpathArray = file.Key.split('/');\n\t\t\t// console.log('file before pick:', file);\n\t\t\tfile = _.pick(file, 'Key');\n\t\t\tfile.path = file.Key;\n\t\t\tfile.name = file.Key;\n\t\t}\n\t\tvar currentObj = file;\n\t\tif (pathArray.length == 1) {\n\t\t\tcurrentObj.name = pathArray[0];\n\t\t\tif (!_.has(currentObj, 'type')) {\n\t\t\t\tcurrentObj.type = 'file';\n\t\t\t}\n\t\t\tcurrentObj.path = pathArray[0];\n\t\t\treturn currentObj;\n\t\t} else {\n\t\t\tvar finalObj = {};\n\t\t\t_.each(pathArray, function (loc, ind, list) {\n\t\t\t\tif (ind != list.length - 1) {\n\t\t\t\t\t//Not the last loc\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = _.take(list, ind + 1).join('/');\n\t\t\t\t\tcurrentObj.type = 'folder';\n\t\t\t\t\tcurrentObj.children = [{}];\n\t\t\t\t\t//TODO: Find out why this works\n\t\t\t\t\tif (ind == 0) {\n\t\t\t\t\t\tfinalObj = currentObj;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentObj = currentObj.children[0];\n\t\t\t\t} else {\n\t\t\t\t\tcurrentObj.type = 'file';\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = pathArray.join('/');\n\t\t\t\t\tif (file.$id) {\n\t\t\t\t\t\tcurrentObj.$id = file.$id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn finalObj;\n\t\t}\n\t}\n\t//Recursivley combine children of object's that have the same names\n\tfunction combineLikeObjs(mappedArray) {\n\t\tvar takenNames = [];\n\t\tvar finishedArray = [];\n\t\t_.each(mappedArray, function (obj) {\n\t\t\tif (takenNames.indexOf(obj.name) == -1) {\n\t\t\t\ttakenNames.push(obj.name);\n\t\t\t\tfinishedArray.push(obj);\n\t\t\t} else {\n\t\t\t\tvar likeObj = _.findWhere(mappedArray, { name: obj.name });\n\t\t\t\t//Combine children of like objects\n\t\t\t\tlikeObj.children = _.union(obj.children, likeObj.children);\n\t\t\t\tlikeObj.children = combineLikeObjs(likeObj.children);\n\t\t\t\t// logger.log('extended obj:',likeObj);\n\t\t\t}\n\t\t});\n\t\treturn finishedArray;\n\t}\n\n\t//Convenience vars\n\tvar _request = matter.utils.request;\n\tvar _logger = matter.utils.logger;\n\n\t/**\n  * Application class.\n  *\n  */\n\n\tvar Application = (function () {\n\t\tfunction Application(appData) {\n\t\t\t_classCallCheck(this, Application);\n\n\t\t\t//Setup application data based on input\n\t\t\tif (appData && _.isObject(appData)) {\n\t\t\t\t_.extend(this, appData);\n\t\t\t} else if (appData && _.isString(appData)) {\n\t\t\t\tthis.name = appData;\n\t\t\t}\n\t\t\tif (Firebase && _.has(config, 'fbUrl') && _.has(this, 'name')) {\n\t\t\t\tthis.fbRef = new Firebase(config.fbUrl + this.name);\n\t\t\t}\n\t\t\t// logger.debug({description: 'Application object created.', application: this, func: 'constructor', obj: 'Application'});\n\t\t}\n\n\t\t_createClass(Application, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get applications or single application\n\t\t\tvalue: function get() {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Application get called.', func: 'get', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn _request.get(this.appEndpoint).then(function (response) {\n\t\t\t\t\t_logger.info({\n\t\t\t\t\t\tdescription: 'Application loaded successfully.', response: response,\n\t\t\t\t\t\tapplication: new Application(response), func: 'get', obj: 'Application'\n\t\t\t\t\t});\n\t\t\t\t\treturn new Application(response);\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_logger.error({\n\t\t\t\t\t\tdescription: 'Error getting Application.',\n\t\t\t\t\t\tmessage: errRes.response.text, error: errRes,\n\t\t\t\t\t\tfunc: 'get', obj: 'Application'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Update an application\n\t\t}, {\n\t\t\tkey: 'update',\n\t\t\tvalue: function update(appData) {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Application update called.',\n\t\t\t\t\tfunc: 'update', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn _request.put(this.appEndpoint, appData).then(function (response) {\n\t\t\t\t\t_logger.info({\n\t\t\t\t\t\tdescription: 'Application updated successfully.',\n\t\t\t\t\t\tresponse: response, func: 'update', obj: 'Application'\n\t\t\t\t\t});\n\t\t\t\t\treturn new Application(response);\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_logger.error({\n\t\t\t\t\t\tdescription: 'Error updating application.',\n\t\t\t\t\t\terror: errRes, func: 'update', obj: 'Application'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'addStorage',\n\t\t\tvalue: function addStorage() {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Application add storage called.', application: this,\n\t\t\t\t\tfunc: 'addStorage', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn _request.post(this.appEndpoint + '/storage', {}).then(function (response) {\n\t\t\t\t\t_logger.info({\n\t\t\t\t\t\tdescription: 'Storage successfully added to application.',\n\t\t\t\t\t\tresponse: response, application: new Application(response),\n\t\t\t\t\t\tfunc: 'addStorage', obj: 'Application'\n\t\t\t\t\t});\n\t\t\t\t\treturn new Application(response);\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_logger.error({\n\t\t\t\t\t\tdescription: 'Error adding storage to application.',\n\t\t\t\t\t\terror: errRes, func: 'addStorage', obj: 'Application'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'applyTemplate',\n\t\t\tvalue: function applyTemplate() {\n\t\t\t\tvar _this7 = this;\n\n\t\t\t\t_logger.error({\n\t\t\t\t\tdescription: 'Applying templates to existing applications is not currently supported.',\n\t\t\t\t\tfunc: 'applyTemplate', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn _request.post(this.appEndpoint, {}).then(function (response) {\n\t\t\t\t\t_logger.info({\n\t\t\t\t\t\tdescription: 'Template successfully applied to application.',\n\t\t\t\t\t\tresponse: response, application: _this7,\n\t\t\t\t\t\tfunc: 'applyTemplate', obj: 'Application'\n\t\t\t\t\t});\n\t\t\t\t\treturn new Application(response);\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\t_logger.error({\n\t\t\t\t\t\tdescription: 'Error applying template to application.',\n\t\t\t\t\t\terror: errRes, application: _this7,\n\t\t\t\t\t\tfunc: 'applyTemplate', obj: 'Application'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Files object that contains files methods\n\t\t}, {\n\t\t\tkey: 'File',\n\t\t\tvalue: function File(fileData) {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications file action called.',\n\t\t\t\t\tfileData: fileData, application: this,\n\t\t\t\t\tfunc: 'file', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new _File({ app: this, fileData: fileData });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'User',\n\t\t\tvalue: function User(userData) {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications user action called.',\n\t\t\t\t\tuserData: userData, application: this, func: 'user',\n\t\t\t\t\tobj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new _Account({ app: this, userData: userData });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Account',\n\t\t\tvalue: function Account(userData) {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications account action called.',\n\t\t\t\t\tuserData: userData, application: this,\n\t\t\t\t\tfunc: 'user', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new _Account({ app: this, userData: userData });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Group',\n\t\t\tvalue: function Group(groupData) {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications group action called.',\n\t\t\t\t\tgroupData: groupData, application: this,\n\t\t\t\t\tfunc: 'group', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new _Group({ app: this, groupData: groupData });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Directory',\n\t\t\tvalue: function Directory(directoryData) {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications directory action called.',\n\t\t\t\t\tdirectoryData: directoryData, application: this,\n\t\t\t\t\tfunc: 'directory', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new _Directory({ app: this, directoryData: directoryData });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'appEndpoint',\n\t\t\tget: function get() {\n\t\t\t\treturn matter.endpoint + '/apps/' + this.name;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Files',\n\t\t\tget: function get() {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications files action called.',\n\t\t\t\t\tapplication: this, func: 'files', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new Files({ app: this });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Users',\n\t\t\tget: function get() {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications users action called.',\n\t\t\t\t\tapplication: this, func: 'user', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new AccountsAction({ app: this });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Accounts',\n\t\t\tget: function get() {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications account action called.',\n\t\t\t\t\tapplication: this, func: 'user', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new AccountsAction({ app: this });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Groups',\n\t\t\tget: function get() {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications groups action called.',\n\t\t\t\t\tapplication: this, func: 'groups', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new GroupsAction({ app: this });\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Directories',\n\t\t\tget: function get() {\n\t\t\t\t_logger.debug({\n\t\t\t\t\tdescription: 'Applications directories action called.',\n\t\t\t\t\tapplication: this, func: 'directories', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new DirectoriesAction({ app: this });\n\t\t\t}\n\t\t}]);\n\n\t\treturn Application;\n\t})();\n\n\tvar request = matter.utils.request;\n\tvar logger = matter.utils.logger;\n\n\t//Actions for applications list\n\n\tvar AppsAction = (function () {\n\t\tfunction AppsAction() {\n\t\t\t_classCallCheck(this, AppsAction);\n\t\t}\n\n\t\t/**Grout Client Class\n   * @ description Extending matter provides token storage and login/logout/signup capabilities\n   */\n\n\t\t_createClass(AppsAction, [{\n\t\t\tkey: 'get',\n\n\t\t\t//Get applications or single application\n\t\t\tvalue: function get() {\n\t\t\t\tlogger.debug({ description: 'Apps get called.', action: this, func: 'get', obj: 'AppsAction' });\n\t\t\t\treturn request.get(this.appsEndpoint).then(function (response) {\n\t\t\t\t\tlogger.info({ description: 'Apps data loaded successfully.', response: response, func: 'get', obj: 'AppsAction' });\n\t\t\t\t\t//TODO: Return application object\n\t\t\t\t\t// return new Application(response);\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\tlogger.error({ description: 'Error getting apps data.', error: errRes, func: 'get', obj: 'AppsAction' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Add an application\n\t\t}, {\n\t\t\tkey: 'add',\n\t\t\tvalue: function add(appData) {\n\t\t\t\tlogger.debug({ description: 'Application add called.', appData: appData, func: 'add', obj: 'AppsAction' });\n\t\t\t\treturn matter.utils.request.post(this.appsEndpoint, appData).then(function (response) {\n\t\t\t\t\tlogger.info({ description: 'Application added successfully.', response: response, func: 'add', obj: 'AppsAction' });\n\t\t\t\t\t// TODO: Return application object\n\t\t\t\t\t// return new Application(response);\n\t\t\t\t\treturn response;\n\t\t\t\t})['catch'](function (errRes) {\n\t\t\t\t\tlogger.error({ description: 'Error adding app.', error: errRes, func: 'add', obj: 'AppsAction' });\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'appsEndpoint',\n\n\t\t\t//Call matter with name and settings\n\t\t\tget: function get() {\n\t\t\t\treturn matter.endpoint + '/apps';\n\t\t\t}\n\t\t}]);\n\n\t\treturn AppsAction;\n\t})();\n\n\tvar Grout = (function (_Matter) {\n\t\t_inherits(Grout, _Matter);\n\n\t\t//TODO: Use getter/setter to make this not a function\n\n\t\tfunction Grout() {\n\t\t\t_classCallCheck(this, Grout);\n\n\t\t\t//Call matter with tessellate\n\t\t\t_get(Object.getPrototypeOf(Grout.prototype), 'constructor', this).call(this, config.appName, config.matterOptions);\n\t\t}\n\n\t\t//Start a new Apps Action\n\n\t\t_createClass(Grout, [{\n\t\t\tkey: 'App',\n\n\t\t\t//Start a new App action\n\t\t\tvalue: function App(appName) {\n\t\t\t\tthis.utils.logger.debug({ description: 'Application action called.', appName: appName, template: new Application(appName), func: 'App', obj: 'Grout' });\n\t\t\t\treturn new Application(appName);\n\t\t\t}\n\n\t\t\t//Start a new Apps Action\n\t\t}, {\n\t\t\tkey: 'Template',\n\n\t\t\t//Start a new App action\n\t\t\tvalue: function Template(templateData) {\n\t\t\t\tthis.utils.logger.debug({ description: 'Template Action called.', templateData: templateData, template: new _Template(templateData), func: 'Template', obj: 'Grout' });\n\t\t\t\treturn new _Template(templateData);\n\t\t\t}\n\n\t\t\t//Start a new Accounts action\n\t\t}, {\n\t\t\tkey: 'Account',\n\n\t\t\t//Start a new Account action\n\t\t\tvalue: function Account(userData) {\n\t\t\t\tthis.utils.logger.debug({ description: 'Account Action called.', userData: userData, user: new _Account(userData), func: 'user', obj: 'Grout' });\n\t\t\t\treturn new _Account(userData);\n\t\t\t}\n\n\t\t\t//ALIAS OF ACCOUNTS\n\t\t\t//Start a new Accounts action\n\t\t}, {\n\t\t\tkey: 'User',\n\n\t\t\t//ALIAS OF ACCOUNT\n\t\t\t//Start a new Account action\n\t\t\tvalue: function User(userData) {\n\t\t\t\tthis.utils.logger.debug({ description: 'Account Action called.', userData: userData, user: new _Account(userData), func: 'user', obj: 'Grout' });\n\t\t\t\treturn new _Account(userData);\n\t\t\t}\n\n\t\t\t//Start a new Groups action\n\t\t}, {\n\t\t\tkey: 'Group',\n\n\t\t\t//Start a new Group action\n\t\t\tvalue: function Group(groupData) {\n\t\t\t\tthis.utils.logger.debug({\n\t\t\t\t\tdescription: 'Group Action called.', groupData: groupData,\n\t\t\t\t\taction: new _Group({ app: this, groupData: groupData }),\n\t\t\t\t\tfunc: 'group', obj: 'Grout'\n\t\t\t\t});\n\t\t\t\treturn new _Group(groupData);\n\t\t\t}\n\n\t\t\t//Start a new Directories action\n\t\t}, {\n\t\t\tkey: 'Directory',\n\n\t\t\t//Start a new Group action\n\t\t\tvalue: function Directory(directoryData) {\n\t\t\t\tthis.utils.logger.debug({\n\t\t\t\t\tdescription: 'Directory Action called.', directoryData: directoryData,\n\t\t\t\t\taction: new _Directory(directoryData), func: 'directory', obj: 'Grout'\n\t\t\t\t});\n\t\t\t\treturn new _Directory(directoryData);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Apps',\n\t\t\tget: function get() {\n\t\t\t\tthis.utils.logger.debug({\n\t\t\t\t\tdescription: 'Apps Action called.', action: new AppsAction(),\n\t\t\t\t\tfunc: 'Apps', obj: 'Grout'\n\t\t\t\t});\n\t\t\t\treturn new AppsAction();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Templates',\n\t\t\tget: function get() {\n\t\t\t\tthis.utils.logger.debug({ description: 'Templates Action called.', action: new TemplatesAction(), func: 'Templates', obj: 'Grout' });\n\t\t\t\treturn new TemplatesAction();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Accounts',\n\t\t\tget: function get() {\n\t\t\t\tthis.utils.logger.debug({ description: 'Account Action called.', action: new AccountsAction(), func: 'users', obj: 'Grout' });\n\t\t\t\treturn new AccountsAction();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Users',\n\t\t\tget: function get() {\n\t\t\t\tthis.utils.logger.debug({ description: 'Accounts Action called.', action: new AccountsAction(), func: 'Users', obj: 'Grout' });\n\t\t\t\treturn new AccountsAction();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Groups',\n\t\t\tget: function get() {\n\t\t\t\tthis.utils.logger.debug({\n\t\t\t\t\tdescription: 'Groups Action called.', action: new GroupsAction(), func: 'groups', obj: 'Grout'\n\t\t\t\t});\n\t\t\t\treturn new GroupsAction();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'Directories',\n\t\t\tget: function get() {\n\t\t\t\tthis.utils.logger.debug({\n\t\t\t\t\tdescription: 'Directories Action called.',\n\t\t\t\t\taction: new DirectoriesAction(), func: 'directories', obj: 'Grout'\n\t\t\t\t});\n\t\t\t\treturn new DirectoriesAction();\n\t\t\t}\n\t\t}]);\n\n\t\treturn Grout;\n\t})(Matter);\n\n\treturn Grout;\n});\n//# sourceMappingURL=grout.js.map\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('kyper-matter'), require('lodash'), require('firepad'), require('firebase'), require('aws-sdk')) :\n\ttypeof define === 'function' && define.amd ? define(['kyper-matter', 'lodash', 'firepad', 'firebase', 'aws-sdk'], factory) :\n\tglobal.Grout = factory(global.Matter,global._,global.Firepad,global.Firebase,global.AWS);\n}(this, function (Matter,_,Firepad,Firebase,AWS) { 'use strict';\n\n\tMatter = 'default' in Matter ? Matter['default'] : Matter;\n\t_ = 'default' in _ ? _['default'] : _;\n\tFirepad = 'default' in Firepad ? Firepad['default'] : Firepad;\n\tFirebase = 'default' in Firebase ? Firebase['default'] : Firebase;\n\tAWS = 'default' in AWS ? AWS['default'] : AWS;\n\n\tlet config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'grout',\n\t\tfbUrl: 'https://kyper-tech.firebaseio.com/tessellate',\n\t\tappName: 'tessellate',\n\t\tmatterOptions: {\n\t\t\tlocalServer: false\n\t\t},\n\t\taws: {\n\t\t\tregion: 'us-east-1',\n\t\t\tcognito: {\n\t\t\t\tpoolId: 'us-east-1:72a20ffd-c638-48b0-b234-3312b3e64b2e',\n\t\t\t\tparams: {\n\t\t\t\t\tAuthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateUnauth_Role',\n\t\t\t\t\tUnauthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateAuth_Role'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tlet matter = new Matter(config.appName, config.matterOptions);\n\n\tlet ________request = matter.utils.request;\n\tlet ___________logger = matter.utils.logger;\n\n\t//Actions for specific directory\n\tclass Directory {\n\t\tconstructor(actionData) {\n\t\t\tif (actionData && _.isObject(actionData) && (_.has(actionData, 'directoryName') || _.has(actionData, 'name'))) { //Data is object containing directory data\n\t\t\t\tthis.name = actionData.directoryName || actionData.name;\n\t\t\t\tif (_.has(actionData, 'appName')) {\n\t\t\t\t\tthis.appName = actionData.appName;\n\t\t\t\t}\n\t\t\t} else if (actionData && _.isString(actionData)) { //Data is string name\n\t\t\t\tthis.name = actionData;\n\t\t\t} else {\n\t\t\t\t___________logger.error({\n\t\t\t\t\tdescription: 'Action data object with name is required to start a Directory Action.',\n\t\t\t\t\tfunc: 'constructor', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\tthrow new Error('Directory Data object with name is required to start a Directory action.');\n\t\t\t}\n\t\t}\n\t\tget directoryEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'directories', this.name];\n\t\t\t//Check for app account action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t___________logger.log({\n\t\t\t\tdescription: 'Directory endpoint built.',\n\t\t\t\tendpoint: endpointStr, func: 'directoryEndpoint',\n\t\t\t\tobj: 'Directory'\n\t\t\t});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get userlications or single userlication\n\t\tget() {\n\t\t\treturn ________request.get(this.directoryEndpoint).then((response) => {\n\t\t\t\t___________logger.info({\n\t\t\t\t\tdescription: 'Directory data loaded successfully.',\n\t\t\t\t\tresponse: response, func: 'get', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t___________logger.info({\n\t\t\t\t\tdescription: 'Error getting directory.',\n\t\t\t\t\terror: errRes, func: 'get', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update an Directory\n\t\tupdate(directoryData) {\n\t\t\t___________logger.debug({\n\t\t\t\tdescription: 'Directory updated called.',\n\t\t\t\tdirectoryData: directoryData, func: 'update', obj: 'Directory'\n\t\t\t});\n\t\t\treturn matter.utils.request.put(this.directoryEndpoint, directoryData).then((response) => {\n\t\t\t\t___________logger.info({\n\t\t\t\t\tdescription: 'Directory updated successfully.',\n\t\t\t\t\tdirectoryData: directoryData, response: response,\n\t\t\t\t\tfunc: 'update', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t___________logger.error({\n\t\t\t\t\tdescription: 'Error updating directory.',\n\t\t\t\t\tdirectoryData: directoryData, error: errRes,\n\t\t\t\t\tfunc: 'update', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete an Directory\n\t\tdel(directoryData) {\n\t\t\t___________logger.debug({\n\t\t\t\tdescription: 'Delete directory called.',\n\t\t\t\tdirectoryData: directoryData, func: 'del', obj: 'Directory'\n\t\t\t});\n\t\t\treturn ________request.delete(this.directoryEndpoint, directoryData).then((response) => {\n\t\t\t\t___________logger.info({\n\t\t\t\t\tdescription: 'Directory deleted successfully.',\n\t\t\t\t\tdirectoryData: directoryData, func: 'del', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t___________logger.error({\n\t\t\t\t\tdescription: 'Error deleting directory.',\n\t\t\t\t\terror: errRes, func: 'del', obj: 'Directory'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet _______request = matter.utils.request;\n\tlet __________logger = matter.utils.logger;\n\n\t//Actions for directories list\n\tclass DirectoriesAction {\n\t\tconstructor(actionData) {\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t__________logger.log({description: 'Provided app data set to app parameter.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction'});\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = {name: actionData};\n\t\t\t\t__________logger.log({description: 'App name provided as string was set.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction'});\n\t\t\t}\n\t\t\t__________logger.info({description: 'New directories action.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction'});\n\t\t}\n\t\tget directoriesEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'directories'];\n\t\t\t//Check for app groups action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t__________logger.log({description: 'Directories endpoint built.', endpoint: endpointStr, func: 'directoriesEndpoint', obj: 'DirectoriesAction'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get users or single application\n\t\tget() {\n\t\t\t__________logger.debug({description: 'Directories get called.', action: this, func: 'get', obj: 'DirectoriesAction'});\n\t\t\treturn _______request.get(this.directoriesEndpoint).then((response) => {\n\t\t\t\t__________logger.info({descrption: 'Directories loaded successfully.', response: response, func: 'get', obj: 'DirectoriesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t__________logger.error({descrption: 'error getting users', error: errRes, func: 'get', obj: 'DirectoriesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\t__________logger.debug({description: 'Add directory called.', action: this, appData: appData, func: 'get', obj: 'DirectoriesAction'});\n\t\t\treturn _______request.post(this.directoriesEndpoint, appData).then((response) => {\n\t\t\t\t__________logger.log({description: 'Application added successfully.', response: response, func: 'add', obj: 'DirectoriesAction'});\n\t\t\t\t//TODO: Return list of group objects\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t__________logger.error({description: 'Error adding group.', error: errRes, func: 'add', obj: 'DirectoriesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Search with partial of directory name\n\t\tsearch(query) {\n\t\t\tvar searchEndpoint = this.directoriesEndpoint + '/search/';\n\t\t\tif (query && _.isString(query)) {\n\t\t\t\tsearchEndpoint += query;\n\t\t\t}\n\t\t\tif (!query || query == '') {\n\t\t\t\t__________logger.debug({description: 'Null query, returning empty array.', func: 'search', obj: 'DirectoriesAction'});\n\t\t\t\treturn Promise.resolve([]);\n\t\t\t}\n\t\t\treturn _______request.get(searchEndpoint).then((response) => {\n\t\t\t\t__________logger.log({description: 'Found directories based on search.', response: response, func: 'search', obj: 'DirectoriesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t__________logger.error({description: 'Error searching directories.', error: errRes, func: 'search', obj: 'DirectoriesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ______request = matter.utils.request;\n\tlet _________logger = matter.utils.logger;\n\n\t//Actions for specific user\n\tclass Group {\n\t\tconstructor(actionData) {\n\t\t\t//Call matter with name and settings\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'groupData')) { //Data is object containing group data\n\t\t\t\tthis.name = _.isObject(actionData.groupData) ? actionData.groupData.name : actionData.groupData;\n\t\t\t\tif (_.has(actionData, 'app')) {\n\t\t\t\t\tthis.app = actionData.app;\n\t\t\t\t}\n\t\t\t} else if (actionData && _.isString(actionData)) { //Data is string name\n\t\t\t\tthis.name = actionData;\n\t\t\t} else {\n\t\t\t\t_________logger.error({description: 'Action data is required to start a Group Action.', func: 'constructor', obj: 'Group'});\n\t\t\t\tthrow new Error('Username is required to start an Group');\n\t\t\t}\n\t\t}\n\t\tget groupEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'groups', this.name];\n\t\t\t//Check for app account action\n\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t_________logger.log({description: 'Group Endpoint built.', endpoint: endpointStr, func: 'groupEndpoint', obj: 'Group'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get userlications or single userlication\n\t\tget() {\n\t\t\treturn ______request.get(this.groupEndpoint).then((response) => {\n\t\t\t\t_________logger.info({description: 'Group data loaded successfully.', response: response, func: 'get', obj: 'Group'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_________logger.info({description: 'Error getting group.', error: errRes, func: 'get', obj: 'Group'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Update an Group\n\t\tupdate(groupData) {\n\t\t\t_________logger.log({description: 'Group updated called.', groupData: groupData, func: 'update', obj: 'Group'});\n\t\t\treturn matter.utils.request.put(this.groupEndpoint, groupData).then((response) => {\n\t\t\t\t_________logger.info({description: 'Group updated successfully.', groupData: groupData, response: response, func: 'update', obj: 'Group'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_________logger.error({description: 'Error updating group.', groupData: groupData, error: errRes, func: 'update', obj: 'Group'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Delete an Group\n\t\tdel(groupData) {\n\t\t\t_________logger.log({description: 'Delete group called.', groupData: groupData, func: 'del', obj: 'Group'});\n\t\t\treturn ______request.del(this.groupEndpoint, {}).then((response) => {\n\t\t\t\t_________logger.info({description: 'Group deleted successfully.', groupData: groupData, func: 'del', obj: 'Group'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_________logger.error({description: 'Error deleting group.', error: errRes, text: errRes.response.text, groupData: groupData,  func: 'del', obj: 'Group'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Update an Group\n\t\taddAccounts(accountsData) {\n\t\t\t_________logger.log({description: 'Group updated called.', accountsData: accountsData, func: 'update', obj: 'Group'});\n\t\t\tlet accountsArray = accountsData;\n\t\t\t//Handle provided data being a string list\n\t\t\tif (_.isString(accountsData)) {\n\t\t\t\taccountsArray = accountsData.split(',');\n\t\t\t}\n\t\t\t//Check item in array to see if it is a string (username) instead of _id\n\t\t\tif (_.isString(accountsArray[0])) {\n\t\t\t\t_________logger.error({description: 'Accounts array only currently supports account._id not account.username.', accountsData: accountsData, func: 'update', obj: 'Group'});\n\t\t\t\treturn Promise.reject({message: 'Accounts array only currently supports account._id not account.username.'});\n\t\t\t}\n\t\t\t_________logger.log({description: 'Updating group with accounts array.', accountsArray: accountsArray, func: 'update', obj: 'Group'});\n\t\t\treturn this.update({accounts: accountsArray}).then((response) => {\n\t\t\t\t_________logger.info({description: 'Account(s) added to group successfully.', response: response, func: 'addAccounts', obj: 'Group'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_________logger.error({description: 'Error addAccountseting group.', error: errRes,  func: 'addAccounts', obj: 'Group'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet _____request = matter.utils.request;\n\tlet ________logger = matter.utils.logger;\n\n\t//Actions for users list\n\tclass GroupsAction {\n\t\tconstructor(actionData) {\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'Provided app data set to app parameter.',\n\t\t\t\t\taction: this, providedData: actionData,\n\t\t\t\t\tfunc: 'constructor', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = {name: actionData};\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'App name provided as string was set.',\n\t\t\t\t\taction: this, providedData: actionData,\n\t\t\t\t\tfunc: 'constructor', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t}\n\t\t\t________logger.info({\n\t\t\t\tdescription: 'New Groups action.', action: this,\n\t\t\t\tprovidedData: actionData, func: 'constructor', obj: 'GroupsAction'\n\t\t\t});\n\t\t}\n\t\tget groupsEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'groups'];\n\t\t\t//Check for app groups action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t________logger.log({\n\t\t\t\tdescription: 'Groups Endpoint built.', endpoint: endpointStr,\n\t\t\t\tfunc: 'groupsEndpoint', obj: 'GroupsAction'\n\t\t\t});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get users or single application\n\t\tget() {\n\t\t\t________logger.log({\n\t\t\t\tdescription: 'Get group called.',\n\t\t\t\tfunc: 'get', obj: 'GroupsAction'\n\t\t\t});\n\t\t\treturn _____request.get(this.groupsEndpoint).then((response) => {\n\t\t\t\t________logger.info({\n\t\t\t\t\tdescription: 'Groups loaded successfully.',\n\t\t\t\t\tresponse: response, func: 'get', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t________logger.info({\n\t\t\t\t\tdescription: 'Error getting groups.', error: errRes,\n\t\t\t\t\tfunc: 'get', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(groupData) {\n\t\t\tvar newGroupData = groupData;\n\t\t\t________logger.debug({\n\t\t\t\tdescription: 'Add group called.', groupData: groupData,\n\t\t\t\tfunc: 'add', obj: 'GroupsAction'\n\t\t\t});\n\t\t\tif (_.isString(groupData)) {\n\t\t\t\t//Group data is string\n\t\t\t\tnewGroupData = {name: groupData};\n\t\t\t}\n\t\t\t________logger.debug({\n\t\t\t\tdescription: 'Add group called.', newGroupData: newGroupData,\n\t\t\t\tfunc: 'add', obj: 'GroupsAction'\n\t\t\t});\n\t\t\treturn _____request.post(this.groupsEndpoint, newGroupData).then((response) => {\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'Group added to application successfully.',\n\t\t\t\t\tresponse: response, func: 'add', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\t//TODO: Return list of group objects\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t________logger.error({\n\t\t\t\t\tdescription: 'Error adding group.',\n\t\t\t\t\terror: errRes, func: 'add', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Search with partial of username\n\t\tsearch(query) {\n\t\t\t________logger.debug({\n\t\t\t\tdescription: 'Search groups called.', query: query,\n\t\t\t\tfunc: 'search', obj: 'GroupsAction'\n\t\t\t});\n\t\t\tif (!query || query == '' || !_.isString(query)) {\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'Null or invalid query, returning empty array.',\n\t\t\t\t\tfunc: 'search', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn Promise.resolve([]);\n\t\t\t}\n\t\t\tlet searchEndpoint = `${this.groupsEndpoint}/search/${query}`;\n\t\t\t________logger.debug({\n\t\t\t\tdescription: 'Search endpoint created.',\n\t\t\t\tendpoint: searchEndpoint, func: 'search', obj: 'GroupsAction'\n\t\t\t});\n\t\t\treturn _____request.get(searchEndpoint).then((response) => {\n\t\t\t\t________logger.log({\n\t\t\t\t\tdescription: 'Found groups based on search.',\n\t\t\t\t\tresponse: response, func: 'search', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t________logger.error({\n\t\t\t\t\tdescription: 'Error searching groups.',\n\t\t\t\t\terror: errRes, func: 'search', obj: 'GroupsAction'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ____request = matter.utils.request;\n\tlet _______logger = matter.utils.logger;\n\n\t//Actions for specific user\n\tclass Account {\n\t\tconstructor(accountData) {\n\t\t\t//Call matter with name and settings\n\t\t\tif (accountData && _.isObject(accountData) && _.has(accountData, 'username')) {\n\t\t\t\t_.extend(this, accountData);\n\t\t\t} else if (accountData && _.isString(accountData)) {\n\t\t\t\tthis.username = accountData;\n\t\t\t} else {\n\t\t\t\t_______logger.error({\n\t\t\t\t\tdescription: 'AccountData is required to start an AccountAction',\n\t\t\t\t\tfunc: 'constructor', obj: 'Account'\n\t\t\t\t});\n\t\t\t\tthrow new Error('username is required to start an AccountAction');\n\t\t\t}\n\t\t}\n\t\t//Build endpoint based on accountData\n\t\tget accountEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'accounts', this.username];\n\t\t\t//Check for app account action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t_______logger.log({description: 'Account Endpoint built.', endpoint: endpointStr, func: 'accountEndpoint', obj: 'Account'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get a user\n\t\tget() {\n\t\t\t_______logger.debug({description: 'Account data loaded successfully.', func: 'get', obj: 'Account'});\n\t\t\treturn ____request.get(this.accountEndpoint).then((response) => {\n\t\t\t\t_______logger.info({description: 'Account data loaded successfully.', response: response, func: 'get', obj: 'Account'});\n\t\t\t\treturn new Account(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_______logger.error({description: 'Error getting user.', error: errRes, func: 'get', obj: 'Account'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update a Account\n\t\tupdate(accountData) {\n\t\t\t_______logger.debug({description: 'Update user called.', accountData: accountData, func: 'update', obj: 'Account'});\n\t\t\treturn ____request.put(this.accountEndpoint, accountData).then((response) => {\n\t\t\t\t_______logger.info({description: 'Account updated successfully.', func: 'update', obj: 'Account'});\n\t\t\t\t//TODO: Extend this with current info before returning\n\t\t\t\treturn new Account(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_______logger.error({description: 'Error updating user.', func: 'update', obj: 'Account'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete a Account\n\t\tdel(accountData) {\n\t\t\t_______logger.debug({description: 'Delete user called.', func: 'del', obj: 'Account'});\n\t\t\treturn ____request.del(this.accountEndpoint, accountData).then((response) => {\n\t\t\t\t_______logger.info({description: 'Delete user successful.', response: response, func: 'del', obj: 'Account'});\n\t\t\t\treturn new Account(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_______logger.error({description: 'Error deleting user.', accountData: accountData, error: errRes, func: 'del', obj: 'Account'});\n\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ______logger = matter.utils.logger;\n\t//Actions for accounts list\n\tclass AccountsAction {\n\t\tconstructor(actionData) {\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t______logger.log({description: 'Provided app data set to app parameter.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction'});\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = {name: actionData};\n\t\t\t\t______logger.log({description: 'App name provided as string was set.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction'});\n\t\t\t}\n\t\t\t______logger.info({description: 'New Accounts action.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction'});\n\t\t}\n\t\tget accountsEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'accounts'];\n\t\t\t//Check for app account action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t//Splice apps, appName into index 1\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t______logger.log({description: 'Accounts Endpoint built.', endpoint: endpointStr, func: 'accountsEndpoint', obj: 'AccountsAction'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get accounts or single application\n\t\tget() {\n\t\t\t______logger.log({description: 'Accounts get called.', func: 'get', obj: 'AccountsAction'});\n\t\t\treturn matter.utils.request.get(this.accountsEndpoint).then((response) => {\n\t\t\t\t______logger.info({description: 'Accounts loaded successfully.', func: 'get', obj: 'AccountsAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t______logger.info({description: 'Error getting accounts.', error: errRes, func: 'get', obj: 'AccountsAction'});\n\t\t\t\treturn Promise.reject(errRes.message || 'Error getting accounts.');\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(accountData) {\n\t\t\t______logger.info({description: 'Account add called.', accountData: accountData, func: 'add', obj: 'AccountsAction'});\n\t\t\treturn this.utils.request.post(this.accountsEndpoint, accountData).then((response) => {\n\t\t\t\t______logger.info({description: 'Account added successfully.', response: response, newAccount: new Account(response), func: 'add', obj: 'AccountsAction'});\n\t\t\t\treturn new Account(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t______logger.error({description: 'Account add called.', error: errRes, accountData: accountData, func: 'add', obj: 'AccountsAction'});\n\t\t\t\treturn Promise.reject(errRes.message || 'Error adding account.');\n\t\t\t});\n\t\t}\n\t\t//Search with partial of accountname\n\t\tsearch(query) {\n\t\t\t______logger.log({description: 'Accounts search called.', query: query, func: 'search', obj: 'AccountsAction'});\n\t\t\tvar searchEndpoint = this.accountsEndpoint + '/search/';\n\t\t\tif (query && _.isString(query)) {\n\t\t\t\tsearchEndpoint += query;\n\t\t\t}\n\t\t\tif (!query || query == '') {\n\t\t\t\t______logger.log({description: 'Null query, returning empty array.', func: 'search', obj: 'AccountsAction'});\n\t\t\t\treturn Promise.resolve([]);\n\t\t\t}\n\t\t\treturn matter.utils.request.get(searchEndpoint).then((response) => {\n\t\t\t\t______logger.log({description: 'Accounts search responded.', response: response, query: query, func: 'search', obj: 'AccountsAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t______logger.error({description: 'Error searching Accounts.', error: errRes, query: query, func: 'search', obj: 'AccountsAction'});\n\t\t\t\treturn Promise.reject(errRes.message || 'Error searching accounts.');\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ___request = matter.utils.request;\n\tlet _____logger = matter.utils.logger;\n\t//Actions for specific user\n\tclass Template {\n\t\tconstructor(templateData) {\n\t\t\t//Call matter with name and settings\n\t\t\tif (templateData && _.isString(templateData)) {\n\t\t\t\tthis.name = templateData;\n\t\t\t} else {\n\t\t\t\t_____logger.error({\n\t\t\t\t\tdescription: 'Template data is required to start a Template action.',\n\t\t\t\t\tfunc: 'constructor', obj: 'Template'\n\t\t\t\t});\n\t\t\t\tthrow new Error('Template data is required to start a Template action.');\n\t\t\t}\n\t\t}\n\t\tget templateEndpoint() {\n\t\t\treturn `${matter.endpoint}/templates/${this.name}`;\n\t\t}\n\t\t//Get userlications or single userlication\n\t\tget() {\n\t\t\t_____logger.log({description: 'Get template called.', name: this.name, func: 'get', obj: 'Template'});\n\t\t\treturn ___request.get(this.templateEndpoint).then((response) => {\n\t\t\t\t_____logger.log({description: 'Get template responded.', response: response, func: 'get', obj: 'Template'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_____logger.error({description: 'Error getting template.', error: errRes, func: 'get', obj: 'Template'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update an userlication\n\t\tupdate(templateData) {\n\t\t\t_____logger.log({description: 'Update template called.', templateData: templateData, func: 'update', obj: 'Template'});\n\t\t\treturn ___request.put(this.templateEndpoint, templateData).then((response) => {\n\t\t\t\t_____logger.log({description: 'Update template responded.', response: response, templateData: templateData, func: 'update', obj: 'Template'});\n\t\t\t\t//TODO: Return template object\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_____logger.error({description: 'Error updating template.', error: errRes, func: 'update', obj: 'Template'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete a template\n\t\tdel(templateData) {\n\t\t\t_____logger.log({description: 'Delete template called.', templateData: templateData, func: 'del', obj: 'Template'});\n\t\t\treturn ___request.delete(this.endpoint, templateData).then((response) => {\n\t\t\t\t_____logger.log({description: 'Template deleted successfully.', response: response, func: 'del', obj: 'Template'});\n\t\t\t\t//TODO: Return template object\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_____logger.error({description: 'Error deleting template.', error: errRes, func: 'del', obj: 'Template'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ____logger = matter.utils.logger;\n\tlet __request = matter.utils.request;\n\n\t//Actions for templates list\n\tclass TemplatesAction {\n\t\tget templatesEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'templates'];\n\t\t\t//Check for app groups action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t// endpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t____logger.log({description: 'Templates action is not currently supported for a specific application.', func: 'accountsEndpoint', obj: 'AccountsAction'});\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t____logger.log({description: 'Templates endpoint built.', endpoint: endpointStr, func: 'templatesEndpoint', obj: 'TemplatesAction'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get templates or single application\n\t\tget() {\n\t\t\t____logger.log({description: 'Get template called.', func: 'get', obj: 'TemplatesAction'});\n\t\t\treturn __request.get(this.templatesEndpoint).then((response) => {\n\t\t\t\t____logger.log({description: 'Templates loaded.', response: response, func: 'get', obj: 'TemplatesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____logger.error({description: 'Error getting templates.', error: errRes, func: 'get', obj: 'TemplatesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\t____logger.log({description: 'Add template called.', func: 'add', obj: 'TemplatesAction'});\n\t\t\treturn __request.post(this.templatesEndpoint, appData).then((response) => {\n\t\t\t\t____logger.log({description: 'Templates added successfully.', func: 'add', obj: 'TemplatesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____logger.error({description: 'Error adding template.', error: errRes, func: 'add', obj: 'TemplatesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Search with partial of username\n\t\tsearch(query) {\n\t\t\t____logger.log({description: 'Search template called.', query: query, func: 'search', obj: 'TemplatesAction'});\n\t\t\tvar searchEndpoint = this.templatesEndpoint + '/search/';\n\t\t\tif (query && _.isString(query)) {\n\t\t\t\tsearchEndpoint += query;\n\t\t\t}\n\t\t\t____logger.log({description: 'Search endpoint created.', endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction'});\n\t\t\treturn __request.get(searchEndpoint).then((response) => {\n\t\t\t\t____logger.log({description: 'Template(s) found successfully.', response: response, endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____logger.log({description: 'Error searching for templates.', query: query, error: errRes, endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\t//Convenience vars\n\tlet ___logger = matter.utils.logger;\n\n\tclass File {\n\t\tconstructor(actionData) {\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'fileData') && _.has(actionData, 'app')) {\n\t\t\t\t_.extend(this, actionData.fileData);\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\tthis.pathArray = this.path.split('/');\n\t\t\t\t//Get name from data or from pathArray\n\t\t\t\tthis.name = _.has(actionData.fileData, 'name') ? actionData.fileData.name : this.pathArray[this.pathArray.length - 1];\n\t\t\t} else if (actionData && !_.isObject(actionData)) {\n\t\t\t\t___logger.error({\n\t\t\t\t\tdescription: 'File data is not an object. File data must be an object that includes path and appName.',\n\t\t\t\t\tfunc: 'constructor', obj: 'File'\n\t\t\t\t});\n\t\t\t\t//TODO: Get appName from path data?\n\t\t\t\tthrow new Error('File data must be an object that includes path and appName.');\n\t\t\t} else {\n\t\t\t\t___logger.error({description: 'File data that includes path and app is needed to create a File action.', func: 'constructor', obj: 'File'});\n\t\t\t\tthrow new Error('File data with path and app is needed to create file action.');\n\t\t\t}\n\t\t\tthis.type = 'file';\n\t\t\t___logger.debug({description: 'File object constructed.', file: this, func: 'constructor', obj: 'File'});\n\t\t}\n\n\t\tget() {\n\t\t\tif (!this.app || !this.app.frontend) {\n\t\t\t\t___logger.log({\n\t\t\t\t\tdescription: 'Application Frontend data not available. Calling applicaiton get.', func: 'get', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn this.app.get().then((appData) => {\n\t\t\t\t\tthis.app = appData;\n\t\t\t\t\t___logger.log({\n\t\t\t\t\t\tdescription: 'Application get successful. Getting file.',\n\t\t\t\t\t\tapp: appData, func: 'get', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\treturn this.get();\n\t\t\t\t}, (err) => {\n\t\t\t\t\t___logger.error({\n\t\t\t\t\t\tdescription: 'Application Frontend data not available.',\n\t\t\t\t\t\terror: err, func: 'get', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject({message: 'Front end data is required to get file.'});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t___logger.log({\n\t\t\t\t\t\tdescription: 'AWS creds do not exist, so they are being set.',\n\t\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\t_setAWSConfig();\n\t\t\t\t}\n\t\t\t\tlet s3 = new AWS.S3();\n\t\t\t\tlet getData = {\n\t\t\t\t\tBucket: this.app.frontend.bucketName,\n\t\t\t\t\tKey: this.path\n\t\t\t\t};\n\t\t\t\t//Set contentType from actionData to ContentType parameter of new object\n\t\t\t\tif (this.contentType) {\n\t\t\t\t\tgetData.ContentType = this.contentType;\n\t\t\t\t}\n\t\t\t\t___logger.debug({\n\t\t\t\t\tdescription: 'File get params built.', getData: getData,\n\t\t\t\t\tfile: this, func: 'get', obj: 'File'\n\t\t\t\t});\n\t\t\t\tlet finalData = this;\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\ts3.getObject(getData, (err, data) => {\n\t\t\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\tdescription: 'File loaded successfully.',\n\t\t\t\t\t\t\t\tdata: data, func: 'get', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (_.has(data, 'Body')) {\n\t\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\t\tdescription: 'File has content.',\n\t\t\t\t\t\t\t\t\tcontent: data.Body.toString(),\n\t\t\t\t\t\t\t\t\tmetaData: data.Metadata.toString(),\n\t\t\t\t\t\t\t\t\tfunc: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tfinalData.content = data.Body.toString();\n\t\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\t\tdescription: 'File content has been added to file.',\n\t\t\t\t\t\t\t\t\tfile: finalData,\n\t\t\t\t\t\t\t\t\tfunc: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tresolve(finalData);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\t\tdescription: 'Error loading file from S3.',\n\t\t\t\t\t\t\t\terror: err, func: 'get', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t//Alias for get\n\t\topen() {\n\t\t\treturn this.get();\n\t\t}\n\t\tpublish(fileData) {\n\t\t\t//TODO: Publish file to application\n\t\t\t___logger.debug({\n\t\t\t\tdescription: 'File publish called.', file: this,\n\t\t\t\tfileData: fileData, func: 'publish', obj: 'File'\n\t\t\t});\n\t\t\tif (!this.app.frontend) {\n\t\t\t\t___logger.error({\n\t\t\t\t\tdescription: 'Application Frontend data not available. Make sure to call .get().',\n\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject({message: 'Front end data is required to publish file.'});\n\t\t\t} else {\n\t\t\t\tif (!_.has(fileData, ['content', 'path'])) {\n\t\t\t\t\t___logger.error({\n\t\t\t\t\t\tdescription: 'File data including path and content required to publish.',\n\t\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\treturn Promise.reject({message: 'File data including path and content required to publish.'});\n\t\t\t\t}\n\t\t\t\tlet saveParams = {\n\t\t\t\t\tBucket: this.app.frontend.bucketName,\n\t\t\t\t\tKey: fileData.path,\n\t\t\t\t\tBody: fileData.content,\n\t\t\t\t\tACL: 'public-read'\n\t\t\t\t};\n\t\t\t\t//Set contentType from fileData to ContentType parameter of new object\n\t\t\t\tif (this.contentType) {\n\t\t\t\t\tsaveParams.ContentType = this.contentType;\n\t\t\t\t}\n\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t___logger.debug({\n\t\t\t\t\t\tdescription: 'AWS creds do not exist, so they are being set.',\n\t\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\t_setAWSConfig();\n\t\t\t\t}\n\t\t\t\tlet s3 = new AWS.S3();\n\t\t\t\t___logger.debug({\n\t\t\t\t\tdescription: 'File publish params built.',\n\t\t\t\t\tsaveParams: saveParams, fileData: this,\n\t\t\t\t\tfunc: 'publish', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\ts3.putObject(saveParams, function(err, data) {\n\t\t\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t___logger.log({\n\t\t\t\t\t\t\t\tdescription: 'File saved successfully.',\n\t\t\t\t\t\t\t\tresponse: data, func: 'publish', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t}\telse {\n\t\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\t\tdescription: 'Error saving file to S3.',\n\t\t\t\t\t\t\t\terror: err, func: 'publish', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tdel() {\n\t\t\tif (!this.app || !this.app.frontend) {\n\t\t\t\t___logger.log({description: 'Application Frontend data not available. Calling applicaiton get.', func: 'get', obj: 'File'});\n\t\t\t\treturn this.app.get().then((appData) => {\n\t\t\t\t\tthis.app = appData;\n\t\t\t\t\t___logger.log({description: 'Application get successful. Getting file.', app: appData, func: 'get', obj: 'File'});\n\t\t\t\t\treturn this.get();\n\t\t\t\t}, (err) => {\n\t\t\t\t\t___logger.error({description: 'Application Frontend data not available. Make sure to call .get().', error: err, func: 'get', obj: 'File'});\n\t\t\t\t\treturn Promise.reject({message: 'Front end data is required to get file.'});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t___logger.debug({description: 'AWS creds do not exist, so they are being set.', func: 'publish', obj: 'File'});\n\t\t\t\t\t_setAWSConfig();\n\t\t\t\t}\n\t\t\t\tlet s3 = new AWS.S3();\n\t\t\t\tlet saveParams = {\n\t\t\t\t\tBucket: this.app.frontend.bucketName,\n\t\t\t\t\tKey: this.path\n\t\t\t\t};\n\t\t\t\t//Set contentType from actionData to ContentType parameter of new object\n\t\t\t\tif (this.contentType) {\n\t\t\t\t\tsaveParams.ContentType = this.contentType;\n\t\t\t\t}\n\t\t\t\t___logger.debug({\n\t\t\t\t\tdescription: 'File get params built.',\n\t\t\t\t\tsaveParams: saveParams, file: this,\n\t\t\t\t\tfunc: 'get', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\ts3.deleteObject(saveParams, function(err, data) {\n\t\t\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\tdescription: 'File loaded successfully.',\n\t\t\t\t\t\t\t\tfileData: data, func: 'get', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (_.has(data, 'Body')) {\n\t\t\t\t\t\t\t\t___logger.info({\n\t\t\t\t\t\t\t\t\tdescription: 'File has content.',\n\t\t\t\t\t\t\t\t\tfileData: data.Body.toString(), func: 'get', obj: 'File'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tresolve(data.Body.toString());\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\telse {\n\t\t\t\t\t\t\t___logger.error({\n\t\t\t\t\t\t\t\tdescription: 'Error loading file from S3.',\n\t\t\t\t\t\t\t\terror: err, func: 'get', obj: 'File'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tget fileType() {\n\t\t\tif (this.ext == 'js') {\n\t\t\t\treturn 'javascript';\n\t\t\t} else {\n\t\t\t\treturn this.ext;\n\t\t\t}\n\t\t}\n\t\tget ext() {\n\t\t\tlet re = /(?:\\.([^.]+))?$/;\n\t\t\treturn re.exec(this.name)[1];\n\t\t}\n\t\tget safePathArray() {\n\t\t\tlet safeArray = this.pathArray.map((loc) => {\n\t\t\t\t//Replace periods with colons and other unsafe chars as --\n\t\t\t\treturn loc.replace(/[.]/g, ':').replace(/[#$\\[\\]]/g, '--');\n\t\t\t});\n\t\t\t___logger.log({\n\t\t\t\tdescription: 'Safe path array created.',\n\t\t\t\tsafeArray: safeArray, func: 'safePathArray', obj: 'File'\n\t\t\t});\n\t\t\treturn safeArray;\n\t\t}\n\t\tget safePath() {\n\t\t\treturn this.safePathArray.join('/');\n\t\t}\n\t\tget fbUrl() {\n\t\t\tlet url = [config.fbUrl, 'files', this.app.name, this.safePath].join('/');\n\t\t\t___logger.log({\n\t\t\t\tdescription: 'File ref url generated',\n\t\t\t\turl: url, func: 'fbRef', obj: 'File'\n\t\t\t});\n\t\t\treturn url;\n\t\t}\n\t\tget fbRef() {\n\t\t\t___logger.log({\n\t\t\t\tdescription: 'Fb ref generatating.',\n\t\t\t\turl: this.fbUrl, func: 'fbRef', obj: 'File'\n\t\t\t});\n\t\t\treturn new Firebase(this.fbUrl);\n\t\t}\n\t\topenInFirepad(editor) {\n\t\t\t//Load file contents from s3\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.get().then((file) => {\n\t\t\t\t\t___logger.log({\n\t\t\t\t\t\tdescription: 'File contents loaded. Opening firepad.',\n\t\t\t\t\t\teditor: editor, file: file,\n\t\t\t\t\t\tfunc: 'openInFirepad', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\t//Open firepad from ace with file content as default\n\t\t\t\t\tlet firepad = file.firepadFromAce(editor);\n\t\t\t\t\t//Wait for firepad to be ready\n\t\t\t\t\tfirepad.on('ready', () => {\n\t\t\t\t\t\tresolve(file);\n\t\t\t\t\t\t// firepad.setText()\n\t\t\t\t\t});\n\t\t\t\t}, (err) => {\n\t\t\t\t\t___logger.error({\n\t\t\t\t\t\tdescription: 'Valid ace editor instance required to create firepad.',\n\t\t\t\t\t\tfunc: 'openInFirepad', obj: 'File', editor: editor\n\t\t\t\t\t});\n\t\t\t\t\treject(err);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tfirepadFromAce(editor) {\n\t\t\t//TODO:Create new Firepad instance within div\n\t\t\tif (!editor || typeof editor.setTheme !== 'function') {\n\t\t\t\t___logger.error({\n\t\t\t\t\tdescription: 'Valid ace editor instance required to create firepad.',\n\t\t\t\t\tfunc: 'fbRef', obj: 'File', editor: editor\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (typeof Firepad.fromACE !== 'function') {\n\t\t\t\t___logger.error({\n\t\t\t\t\tdescription: 'Firepad does not have fromACE method.',\n\t\t\t\t\tfirepad: Firepad, func: 'fbRef', obj: 'File'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet settings = {};\n\t\t\tif (this.content) {\n\t\t\t\tsettings.defaultText = this.content;\n\t\t\t}\n\t\t\tif (matter.isLoggedIn && matter.currentUser) {\n\t\t\t\tsettings.userId = matter.currentUser.username || matter.currentUser.name;\n\t\t\t}\n\t\t\t___logger.log({\n\t\t\t\tdescription: 'Creating firepad from ace.',\n\t\t\t\tsettings: settings, func: 'fbRef', obj: 'File'\n\t\t\t});\n\t\t\treturn Firepad.fromACE(this.fbRef, editor, settings);\n\t\t}\n\t\tgetConnectedUsers() {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.fbRef.child('users').on('value', (usersSnap) => {\n\t\t\t\t\tif (usersSnap.val() === null) {\n\t\t\t\t\t\tresolve([]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet usersArray = [];\n\t\t\t\t\t\tusersSnap.forEach((userSnap) => {\n\t\t\t\t\t\t\tlet user = userSnap.val();\n\t\t\t\t\t\t\tuser.username = userSnap.key();\n\t\t\t\t\t\t\tusersArray.push(user);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t___logger.log({\n\t\t\t\t\t\t\tdescription: 'Connected users array built.',\n\t\t\t\t\t\t\tusers: usersArray, func: 'connectedUsers', obj: 'File'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(usersArray);\n\t\t\t\t\t}\n\t\t\t\t}, (err) => {\n\t\t\t\t\t___logger.error({\n\t\t\t\t\t\tdescription: 'Error loading connected users.',\n\t\t\t\t\t\terror: err, func: 'connectedUsers', obj: 'File'\n\t\t\t\t\t});\n\t\t\t\t\treject(err);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tgetDefaultContent() {\n\t\t\t//TODO: Fill with default data for matching file type\n\t\t}\n\t}\n\t//------------------ Utility Functions ------------------//\n\n\t// AWS Config\n\tfunction _setAWSConfig() {\n\t\tAWS.config.update({\n\t\t\tcredentials: new AWS.CognitoIdentityCredentials({\n\t\t\tIdentityPoolId: config.aws.cognito.poolId\n\t\t}),\n\t\t\tregion: config.aws.region\n\t\t});\n\t}\n\n\t//Convenience vars\n\tlet __logger = matter.utils.logger;\n\n\tclass Files {\n\t\tconstructor(filesData) {\n\t\t\tif (filesData && _.isObject(filesData) && _.has(filesData, 'app')) { //Data is object containing directory data\n\t\t\t\tthis.app = filesData.app;\n\t\t\t} else if (filesData && _.isString(filesData)) { //Data is string name\n\t\t\t\tthis.app = {name: filesData};\n\t\t\t} else if (filesData && _.isArray(filesData)) {\n\t\t\t\t//TODO: Handle an array of files being passed as data\n\t\t\t\t__logger.error({description: 'Action data object with name is required to start a Files Action.', func: 'constructor', obj: 'Files'});\n\t\t\t\tthrow new Error('Files Data object with application is required to start a Files action.');\n\t\t\t} else {\n\t\t\t\t__logger.error({description: 'Action data object with name is required to start a Files Action.', func: 'constructor', obj: 'Files'});\n\t\t\t\tthrow new Error('Files Data object with name is required to start a Files action.');\n\t\t\t}\n\t\t\t__logger.debug({description: 'Files object constructed.', func: 'constructor', obj: 'Files'});\n\t\t}\n\t\tpublish() {\n\t\t\t//TODO: Publish all files\n\t\t}\n\t\tget() {\n\t\t\tif (!this.app.frontend || !this.app.frontend.bucketName) {\n\t\t\t\t__logger.warn({description: 'Application Frontend data not available. Calling .get().', app: this.app, func: 'get', obj: 'Files'});\n\t\t\t\treturn this.app.get().then((applicationData) => {\n\t\t\t\t\t__logger.log({description: 'Application get returned.', data: applicationData, func: 'get', obj: 'Files'});\n\t\t\t\t\tthis.app = applicationData;\n\t\t\t\t\tif (_.has(applicationData, 'frontend')) {\n\t\t\t\t\t\treturn this.get();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t__logger.error({description: 'Application does not have Frontend to get files from.', func: 'get', obj: 'Files'});\n\t\t\t\t\t\treturn Promise.reject({message: 'Application does not have frontend to get files from.'});\n\t\t\t\t\t}\n\t\t\t\t}, (err) => {\n\t\t\t\t\t__logger.error({\n\t\t\t\t\t\tdescription: 'Application Frontend data not available. Make sure to call .get().',\n\t\t\t\t\t\terror: err, func: 'get', obj: 'Files'});\n\t\t\t\t\treturn Promise.reject({message: 'Bucket name required to get objects'});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t// logger.info('AWS creds are being updated to make request');\n\t\t\t\t\tsetAWSConfig();\n\t\t\t\t}\n\t\t\t\tlet s3 = new AWS.S3();\n\t\t\t\tlet listParams = {Bucket: this.app.frontend.bucketName};\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\ts3.listObjects(listParams, function(err, data) {\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t__logger.info({description: 'Files list loaded.', filesData: data, func: 'get', obj: 'Files'});\n\t\t\t\t\t\t\treturn resolve(data.Contents);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t__logger.error({description: 'Error getting files from S3.', error: err, func: 'get', obj: 'Files'});\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tadd() {\n\t\t\t//TODO: Add a file to files list\n\t\t}\n\t\tdel() {\n\t\t\t//TODO: Delete a file from files list\n\t\t}\n\t\tbuildStructure() {\n\t\t\t__logger.debug({description: 'Build Structure called.', func: 'buildStructure', obj: 'Application'});\n\t\t\treturn this.get().then((filesArray) => {\n\t\t\t\tconst childStruct = childrenStructureFromArray(filesArray);\n\t\t\t\t//TODO: have child objects have correct classes (file/folder)\n\t\t\t\t__logger.log({description: 'Child struct from array.', childStructure: childStruct, func: 'buildStructure', obj: 'Application'});\n\t\t\t\treturn childStruct;\n\t\t\t}, (err) => {\n\t\t\t\t__logger.error({description: 'Error getting application files.', error: err, func: 'buildStructure', obj: 'Application'});\n\t\t\t\treturn Promise.reject({message: 'Error getting files.', error: err});\n\t\t\t});\n\t\t}\n\t\t//ALIAS FOR buildStructure\n\t\t// get structure() {\n\t\t// \treturn this.buildStructure();\n\t\t// }\n\t}\n\t//------------------ Utility Functions ------------------//\n\n\t// AWS Config\n\tfunction setAWSConfig() {\n\t\tAWS.config.update({\n\t\t\tcredentials: new AWS.CognitoIdentityCredentials({\n\t\t\tIdentityPoolId: config.aws.cognito.poolId\n\t\t}),\n\t\t\tregion: config.aws.region\n\t\t});\n\t}\n\t//Convert from array file structure (from S3) to 'children' structure used in Editor GUI (angular-tree-control)\n\t//Examples for two files (index.html and /testFolder/file.js):\n\t//Array structure: [{path:'index.html'}, {path:'testFolder/file.js'}]\n\t//Children Structure [{type:'folder', name:'testfolder', children:[{path:'testFolder/file.js', name:'file.js', filetype:'javascript', contentType:'application/javascript'}]}]\n\tfunction childrenStructureFromArray(fileArray) {\n\t\t// logger.log('childStructureFromArray called:', fileArray);\n\t\t//Create a object for each file that stores the file in the correct 'children' level\n\t\tvar mappedStructure = fileArray.map(function(file) {\n\t\t\treturn buildStructureObject(file);\n\t\t});\n\t\treturn combineLikeObjs(mappedStructure);\n\t}\n\t//Convert file with key into a folder/file children object\n\tfunction buildStructureObject(file) {\n\t\tvar pathArray;\n\t\t// console.log('buildStructureObject with:', file);\n\t\tif (_.has(file, 'path')) {\n\t\t\t//Coming from files already having path (structure)\n\t\t\tpathArray = file.path.split('/');\n\t\t} else {\n\t\t\t//Coming from aws\n\t\t\tpathArray = file.Key.split('/');\n\t\t\t// console.log('file before pick:', file);\n\t\t\tfile = _.pick(file, 'Key');\n\t\t\tfile.path = file.Key;\n\t\t\tfile.name = file.Key;\n\t\t}\n\t\tvar currentObj = file;\n\t\tif (pathArray.length == 1) {\n\t\t\tcurrentObj.name = pathArray[0];\n\t\t\tif (!_.has(currentObj,'type')) {\n\t\t\t\tcurrentObj.type = 'file';\n\t\t\t}\n\t\t\tcurrentObj.path = pathArray[0];\n\t\t\treturn currentObj;\n\t\t} else {\n\t\t\tvar finalObj = {};\n\t\t\t_.each(pathArray, (loc, ind, list) => {\n\t\t\t\tif (ind != list.length - 1) {//Not the last loc\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = _.take(list, ind + 1).join('/');\n\t\t\t\t\tcurrentObj.type = 'folder';\n\t\t\t\t\tcurrentObj.children = [{}];\n\t\t\t\t\t//TODO: Find out why this works\n\t\t\t\t\tif (ind == 0) {\n\t\t\t\t\t\tfinalObj = currentObj;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentObj = currentObj.children[0];\n\t\t\t\t} else {\n\t\t\t\t\tcurrentObj.type = 'file';\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = pathArray.join('/');\n\t\t\t\t\tif (file.$id) {\n\t\t\t\t\t\tcurrentObj.$id = file.$id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn finalObj;\n\t\t}\n\t}\n\t//Recursivley combine children of object's that have the same names\n\tfunction combineLikeObjs(mappedArray) {\n\t\tvar takenNames = [];\n\t\tvar finishedArray = [];\n\t\t_.each(mappedArray, (obj) => {\n\t\t\tif (takenNames.indexOf(obj.name) == -1) {\n\t\t\t\ttakenNames.push(obj.name);\n\t\t\t\tfinishedArray.push(obj);\n\t\t\t} else {\n\t\t\t\tvar likeObj = _.findWhere(mappedArray, {name: obj.name});\n\t\t\t\t//Combine children of like objects\n\t\t\t\tlikeObj.children = _.union(obj.children, likeObj.children);\n\t\t\t\tlikeObj.children = combineLikeObjs(likeObj.children);\n\t\t\t\t// logger.log('extended obj:',likeObj);\n\t\t\t}\n\t\t});\n\t\treturn finishedArray;\n\t}\n\n\t//Convenience vars\n\tlet _request = matter.utils.request;\n\tlet _logger = matter.utils.logger;\n\n\t/**\n\t * Application class.\n\t *\n\t */\n\tclass Application {\n\t\tconstructor(appData) {\n\t\t\t//Setup application data based on input\n\t\t\tif (appData && _.isObject(appData)) {\n\t\t\t\t_.extend(this, appData);\n\t\t\t} else if (appData && _.isString(appData)) {\n\t\t\t\tthis.name = appData;\n\t\t\t}\n\t\t\tif (Firebase && _.has(config, 'fbUrl') && _.has(this, 'name')) {\n\t\t\t\tthis.fbRef = new Firebase(config.fbUrl + this.name);\n\t\t\t}\n\t\t\t// logger.debug({description: 'Application object created.', application: this, func: 'constructor', obj: 'Application'});\n\t\t}\n\t\tget appEndpoint() {\n\t\t\treturn `${matter.endpoint}/apps/${this.name}`;\n\t\t}\n\t\t//Get applications or single application\n\t\tget() {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Application get called.', func: 'get', obj: 'Application'\n\t\t\t});\n\t\t\treturn _request.get(this.appEndpoint).then((response) => {\n\t\t\t\t_logger.info({\n\t\t\t\t\tdescription: 'Application loaded successfully.', response: response,\n\t\t\t\t\tapplication: new Application(response), func: 'get', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_logger.error({\n\t\t\t\t\tdescription: 'Error getting Application.',\n\t\t\t\t\tmessage: errRes.response.text ,error: errRes,\n\t\t\t\t\tfunc: 'get', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Update an application\n\t\tupdate(appData) {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Application update called.',\n\t\t\t\tfunc: 'update', obj: 'Application'\n\t\t\t});\n\t\t\treturn _request.put(this.appEndpoint, appData).then((response) => {\n\t\t\t\t_logger.info({\n\t\t\t\t\tdescription: 'Application updated successfully.',\n\t\t\t\t\tresponse: response, func: 'update', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_logger.error({\n\t\t\t\t\tdescription: 'Error updating application.',\n\t\t\t\t\terror: errRes, func: 'update', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\n\t\taddStorage() {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Application add storage called.', application: this,\n\t\t\t\tfunc: 'addStorage', obj: 'Application'\n\t\t\t});\n\t\t\treturn _request.post(`${this.appEndpoint}/storage`, {}).then((response) => {\n\t\t\t\t_logger.info({\n\t\t\t\t\tdescription: 'Storage successfully added to application.',\n\t\t\t\t\tresponse: response, application: new Application(response),\n\t\t\t\t\tfunc: 'addStorage', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_logger.error({\n\t\t\t\t\tdescription: 'Error adding storage to application.',\n\t\t\t\t\terror: errRes, func: 'addStorage', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\tapplyTemplate() {\n\t\t\t_logger.error({\n\t\t\t\tdescription: 'Applying templates to existing applications is not currently supported.',\n\t\t\t\tfunc: 'applyTemplate', obj: 'Application'\n\t\t\t});\n\t\t\treturn _request.post(this.appEndpoint, {}).then((response) => {\n\t\t\t\t_logger.info({\n\t\t\t\t\tdescription: 'Template successfully applied to application.',\n\t\t\t\t\tresponse: response, application: this,\n\t\t\t\t\tfunc: 'applyTemplate', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_logger.error({\n\t\t\t\t\tdescription: 'Error applying template to application.',\n\t\t\t\t\terror: errRes, application: this,\n\t\t\t\t\tfunc: 'applyTemplate', obj: 'Application'\n\t\t\t\t});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Files object that contains files methods\n\t\tget Files() {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications files action called.',\n\t\t\t\tapplication: this, func: 'files', obj: 'Application'\n\t\t\t});\n\t\t\treturn new Files({app: this});\n\t\t}\n\t\tFile(fileData) {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications file action called.',\n\t\t\t\tfileData: fileData, application: this,\n\t\t\t\tfunc: 'file', obj: 'Application'\n\t\t\t});\n\t\t\treturn new File({app: this, fileData: fileData});\n\t\t}\n\t\tget Users() {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications users action called.',\n\t\t\t\tapplication: this, func: 'user', obj: 'Application'\n\t\t\t});\n\t\t\treturn new AccountsAction({app: this});\n\t\t}\n\t\tUser(userData) {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications user action called.',\n\t\t\t\tuserData: userData, application: this, func: 'user',\n\t\t\t\tobj: 'Application'\n\t\t\t});\n\t\t\treturn new Account({app: this, userData: userData});\n\t\t}\n\t\tget Accounts() {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications account action called.',\n\t\t\t\tapplication: this, func: 'user', obj: 'Application'\n\t\t\t});\n\t\t\treturn new AccountsAction({app: this});\n\t\t}\n\t\tAccount(userData) {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications account action called.',\n\t\t\t\tuserData: userData, application: this,\n\t\t\t\tfunc: 'user', obj: 'Application'\n\t\t\t});\n\t\t\treturn new Account({app: this, userData: userData});\n\t\t}\n\t\tget Groups() {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications groups action called.',\n\t\t\t\tapplication: this, func: 'groups', obj: 'Application'\n\t\t\t});\n\t\t\treturn new GroupsAction({app: this});\n\t\t}\n\t\tGroup(groupData) {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications group action called.',\n\t\t\t\tgroupData: groupData, application: this,\n\t\t\t\tfunc: 'group', obj: 'Application'\n\t\t\t});\n\t\t\treturn new Group({app: this, groupData: groupData});\n\t\t}\n\t\tget Directories() {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications directories action called.',\n\t\t\t\tapplication: this, func: 'directories', obj: 'Application'\n\t\t\t});\n\t\t\treturn new DirectoriesAction({app: this});\n\t\t}\n\t\tDirectory(directoryData) {\n\t\t\t_logger.debug({\n\t\t\t\tdescription: 'Applications directory action called.',\n\t\t\t\tdirectoryData: directoryData, application: this,\n\t\t\t\tfunc: 'directory', obj: 'Application'\n\t\t\t});\n\t\t\treturn new Directory({app: this, directoryData: directoryData});\n\t\t}\n\t}\n\n\tlet request = matter.utils.request;\n\tlet logger = matter.utils.logger;\n\n\t//Actions for applications list\n\tclass AppsAction {\n\t\tconstructor() {\n\t\t\t//Call matter with name and settings\n\t\t}\n\t\tget appsEndpoint() {\n\t\t\treturn `${matter.endpoint}/apps`;\n\t\t}\n\t\t//Get applications or single application\n\t\tget() {\n\t\t\tlogger.debug({description: 'Apps get called.', action: this, func: 'get', obj: 'AppsAction'});\n\t\t\treturn request.get(this.appsEndpoint).then((response) => {\n\t\t\t\tlogger.info({description: 'Apps data loaded successfully.', response: response, func: 'get', obj: 'AppsAction'});\n\t\t\t\t//TODO: Return application object\n\t\t\t\t// return new Application(response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error getting apps data.', error: errRes, func: 'get', obj: 'AppsAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\tlogger.debug({description: 'Application add called.', appData: appData, func: 'add', obj: 'AppsAction'});\n\t\t\treturn matter.utils.request.post(this.appsEndpoint, appData).then((response) => {\n\t\t\t\tlogger.info({description: 'Application added successfully.', response: response, func: 'add', obj: 'AppsAction'});\n\t\t\t\t// TODO: Return application object\n\t\t\t\t// return new Application(response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error adding app.', error: errRes, func: 'add', obj: 'AppsAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**Grout Client Class\n\t * @ description Extending matter provides token storage and login/logout/signup capabilities\n\t */\n\tclass Grout extends Matter {\n\t\t//TODO: Use getter/setter to make this not a function\n\t\tconstructor() {\n\t\t\t//Call matter with tessellate\n\t\t\tsuper(config.appName, config.matterOptions);\n\t\t}\n\t\t//Start a new Apps Action\n\t\tget Apps() {\n\t\t\tthis.utils.logger.debug({\n\t\t\t\tdescription: 'Apps Action called.', action: new AppsAction(),\n\t\t\t\tfunc: 'Apps', obj: 'Grout'\n\t\t\t});\n\t\t\treturn new AppsAction();\n\t\t}\n\t\t//Start a new App action\n\t\tApp(appName) {\n\t\t\tthis.utils.logger.debug({description: 'Application action called.', appName: appName, template: new Application(appName), func: 'App', obj: 'Grout'});\n\t\t\treturn new Application(appName);\n\t\t}\n\t\t//Start a new Apps Action\n\t\tget Templates() {\n\t\t\tthis.utils.logger.debug({description: 'Templates Action called.', action: new TemplatesAction(), func: 'Templates', obj: 'Grout'});\n\t\t\treturn new TemplatesAction();\n\t\t}\n\t\t//Start a new App action\n\t\tTemplate(templateData) {\n\t\t\tthis.utils.logger.debug({description: 'Template Action called.', templateData: templateData, template: new Template(templateData), func: 'Template', obj: 'Grout'});\n\t\t\treturn new Template(templateData);\n\t\t}\n\t\t//Start a new Accounts action\n\t\tget Accounts() {\n\t\t\tthis.utils.logger.debug({description: 'Account Action called.', action: new AccountsAction(), func: 'users', obj: 'Grout'});\n\t\t\treturn new AccountsAction();\n\t\t}\n\t\t//Start a new Account action\n\t\tAccount(userData) {\n\t\t\tthis.utils.logger.debug({description: 'Account Action called.', userData: userData, user: new Account(userData), func: 'user', obj: 'Grout'});\n\t\t\treturn new Account(userData);\n\t\t}\n\t\t//ALIAS OF ACCOUNTS\n\t\t//Start a new Accounts action\n\t\tget Users() {\n\t\t\tthis.utils.logger.debug({description: 'Accounts Action called.', action: new AccountsAction(), func: 'Users', obj: 'Grout'});\n\t\t\treturn new AccountsAction();\n\t\t}\n\t\t//ALIAS OF ACCOUNT\n\t\t//Start a new Account action\n\t\tUser(userData) {\n\t\t\tthis.utils.logger.debug({description: 'Account Action called.', userData: userData, user: new Account(userData), func: 'user', obj: 'Grout'});\n\t\t\treturn new Account(userData);\n\t\t}\n\t\t//Start a new Groups action\n\t\tget Groups() {\n\t\t\tthis.utils.logger.debug({\n\t\t\t\tdescription: 'Groups Action called.', action: new GroupsAction(), func: 'groups', obj: 'Grout'\n\t\t\t});\n\t\t\treturn new GroupsAction();\n\t\t}\n\t\t//Start a new Group action\n\t\tGroup(groupData) {\n\t\t\tthis.utils.logger.debug({\n\t\t\t\tdescription: 'Group Action called.', groupData: groupData,\n\t\t\t\taction: new Group({app: this, groupData: groupData}),\n\t\t\t\tfunc: 'group', obj: 'Grout'\n\t\t\t});\n\t\t\treturn new Group(groupData);\n\t\t}\n\t\t//Start a new Directories action\n\t\tget Directories() {\n\t\t\tthis.utils.logger.debug({\n\t\t\t\tdescription: 'Directories Action called.',\n\t\t\t\taction: new DirectoriesAction(), func: 'directories', obj: 'Grout'\n\t\t\t});\n\t\t\treturn new DirectoriesAction();\n\t\t}\n\t\t//Start a new Group action\n\t\tDirectory(directoryData) {\n\t\t\tthis.utils.logger.debug({\n\t\t\t\tdescription: 'Directory Action called.', directoryData: directoryData,\n\t\t\t\taction: new Directory(directoryData), func: 'directory', obj: 'Grout'\n\t\t\t});\n\t\t\treturn new Directory(directoryData);\n\t\t}\n\t}\n\n\treturn Grout;\n\n}));"],"sourceRoot":"/source/"}