{"version":3,"sources":["grout.min.js","/source/grout.js"],"names":["_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_classCallCheck","instance","Constructor","_get","_x","_x2","_x3","_again","object","property","receiver","desc","parent","getter","undefined","Function","getOwnPropertyDescriptor","get","call","getPrototypeOf","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","global","factory","exports","module","require","define","amd","Grout","superagent","_","Firebase","this","_handleResponse","req","Promise","resolve","reject","end","err","res","status","console","warn","body","_addAuthHeader","_storage","getItem","_config","tokenName","set","log","handleResponse","addAuthHeader","storage","config","setAWSConfig","AWS","update","credentials","CognitoIdentityCredentials","IdentityPoolId","aws","cognito","poolId","region","childrenStructureFromArray","fileArray","mappedStructure","map","file","buildStructureObject","combineLikeObjs","pathArray","has","path","split","Key","pick","name","currentObj","type","finalObj","each","loc","ind","list","first","join","children","$id","mappedArray","takenNames","finishedArray","obj","indexOf","push","likeObj","findWhere","union","serverUrl","setItem","itemName","itemValue","exists","window","sessionStorage","removeItem","clear","testKey","_token","tokenStr","string","_request","endpoint","queryData","query","post","data","send","put","del","_user","Matter","appName","opts","Error","options","signupData","then","response","errRes","error","loginData","password","username","token","text","message","localServer","location","host","fbUrl","params","AuthRoleArn","UnauthRoleArn","request","_Application","appData","owner","collaborators","createdAt","updatedAt","frontend","backend","fbRef","getFiles","filesArray","childStruct","bucketName","s3","S3","listParams","Bucket","listObjects","Contents","fileData","saveParams","frontent","Body","content","ACL","contentType","ContentType","putObject","AppAction","app","getStructure","structure","AppsAction","Application","User","userData","UserAction","userName","UsersAction","userEndpoint","isString","msg","searchEndpoint","_Matter"],"mappings":"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","file":"grout.min.js","sourcesContent":["function _inherits(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}var _get=function(e,t,n){for(var r=!0;r;){var o=e,i=t,s=n;a=c=u=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if(\"value\"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(s)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=s,r=!0}},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t(require(\"superagent\"),require(\"underscore\"),require(\"firebase\")):\"function\"==typeof define&&define.amd?define([\"superagent\",\"underscore\",\"firebase\"],t):e.Grout=t(e.superagent,e._,e.Firebase)}(this,function(e,t,n){\"use strict\";function r(e){return new Promise(function(t,n){e.end(function(e,r){return e?(401==e.status&&console.warn(\"Unauthorized. You must be signed into make this request.\"),n(e)):t(r.body)})})}function o(e){return f.getItem(p.tokenName)&&(e=e.set(\"Authorization\",\"Bearer \"+f.getItem(p.tokenName)),console.log(\"Set auth header\")),e}function i(e){return new Promise(function(t,n){e.end(function(e,r){return e?(401==e.status&&console.warn(\"Unauthorized. You must be signed into make this request.\"),n(e)):t(r.body)})})}function s(e){return w.getItem(v.tokenName)&&(e=e.set(\"Authorization\",\"Bearer \"+w.getItem(v.tokenName)),console.log(\"Set auth header\")),e}function a(){AWS.config.update({credentials:new AWS.CognitoIdentityCredentials({IdentityPoolId:v.aws.cognito.poolId}),region:v.aws.region})}function u(e){var t=e.map(function(e){return c(e)});return l(t)}function c(e){var n;t.has(e,\"path\")?n=e.path.split(\"/\"):(n=e.Key.split(\"/\"),e=t.pick(e,\"Key\"),e.path=e.Key,e.name=e.Key);var r=e;if(1==n.length)return r.name=n[0],t.has(r,\"type\")||(r.type=\"file\"),r.path=n[0],r;var o={};return t.each(n,function(i,s,a){s!=a.length-1?(r.name=i,r.path=t.first(a,s+1).join(\"/\"),r.type=\"folder\",r.children=[{}],0==s&&(o=r),r=r.children[0]):(r.type=\"file\",r.name=i,r.path=n.join(\"/\"),e.$id&&(r.$id=e.$id))}),o}function l(e){var n=[],r=[];return t.each(e,function(o,i,s){if(-1==n.indexOf(o.name))n.push(o.name),r.push(o);else{var a=t.findWhere(e,{name:o.name});a.children=t.union(o.children,a.children),a.children=l(a.children)}}),r}e=\"default\"in e?e[\"default\"]:e,t=\"default\"in t?t[\"default\"]:t,n=\"default\"in n?n[\"default\"]:n;var p={serverUrl:\"http://tessellate.elasticbeanstalk.com\",tokenName:\"matter\"},f=Object.defineProperties({setItem:function(e,t){this.exists&&window.sessionStorage.setItem(e,t)},getItem:function(e){return this.exists?window.sessionStorage.getItem(e):null},removeItem:function(e){if(this.exists)try{window.sessionStorage.removeItem(e)}catch(t){console.warn(\"Item could not be removed from session storage.\",t)}},clear:function(){if(this.exists)try{window.sessionStorage.clear()}catch(e){console.warn(\"Session storage could not be cleared.\",e)}}},{exists:{get:function(){var e=\"test\";if(\"undefined\"==typeof window)return!1;try{return window.sessionStorage.setItem(e,\"1\"),window.sessionStorage.removeItem(e),!0}catch(t){return console.warn(\"Session storage does not exist.\",t),!1}},configurable:!0,enumerable:!0}}),d=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:\"string\",value:function(e){return console.log(\"Token was set\",e),f.setItem(p.tokenName,e)}},{key:\"save\",value:function(e){this.string=e,f.setItem(p.tokenName,e)}},{key:\"delete\",value:function(){f.removeItem(p.tokenName),console.log(\"Token was removed\")}},{key:\"string\",get:function(){return f.getItem(p.tokenName)}},{key:\"data\",get:function(){}}]),e}(),g={get:function(t,n){var i=e.get(t);return n&&i.query(n),i=o(i),r(i)},post:function(t,n){var i=e.post(t).send(n);return i=o(i),r(i)},put:function(t,n){var i=e.put(t).send(n);return i=o(i),r(i)},del:function(t,n){var i=e.put(t).send(n);return i=o(i),r(i)}},h=void 0,m=function(){function e(t,n){if(_classCallCheck(this,e),!t)throw new Error(\"Application name is required to use Matter\");this.name=t,n&&(this.options=n)}return _createClass(e,[{key:\"signup\",value:function(e){return g.post(this.endpoint+\"/signup\",e).then(function(e){console.log(e)})[\"catch\"](function(e){return console.error(\"[signup()] Error signing up:\",e),Promise.reject(e)})}},{key:\"login\",value:function(e){return e&&e.password&&e.username?g.put(this.endpoint+\"/login\",e).then(function(e){return t.has(e,\"data\")&&t.has(e.data,\"status\")&&409==e.data.status?(console.error(\"[Matter.login()] Account not found: \",e),Promise.reject(e.data)):(t.has(e,\"token\")&&(d.string=e.token),console.log(\"[Matter.login()] Successful login: \",e),e)})[\"catch\"](function(e){return(409==e.status||400==e.status)&&(e=e.response.text),Promise.reject(e)}):(console.error(\"Username/Email and Password are required to login\"),Promise.reject({message:\"Username/Email and Password are required to login\"}))}},{key:\"logout\",value:function(){return g.put(this.endpoint+\"/logout\").then(function(e){return console.log(\"[Matter.logout()] Logout successful: \",e),d[\"delete\"](),e})[\"catch\"](function(e){return console.error(\"[Matter.logout()] Error logging out: \",e),d[\"delete\"](),Promise.reject(e)})}},{key:\"getCurrentUser\",value:function(){return g.get(this.endpoint+\"/user\",{}).then(function(e){return console.log(\"[getCurrentUser()] Current User:\",e.data),h=e.data})[\"catch\"](function(e){return console.error(\"[getCurrentUser()] Error getting current user: \",e),Promise.reject(e)})}},{key:\"getAuthToken\",value:function(){return d.string}},{key:\"endpoint\",get:function(){var e=p.serverUrl;return t.has(this,\"options\")&&this.options.localServer&&(e=\"http://localhost:4000\"),\"tessellate\"==this.name?window&&t.has(window,\"location\")&&window.location.host==e&&(console.warn(\"Host is Server, serverUrl simplified!\"),e=\"\"):e=p.serverUrl+\"/apps/\"+this.name,e}}]),e}(),v={serverUrl:\"http://tessellate.elasticbeanstalk.com\",tokenName:\"grout-client\",fbUrl:\"https://pruvit.firebaseio.com/\",aws:{region:\"us-east-1\",cognito:{poolId:\"us-east-1:72a20ffd-c638-48b0-b234-3312b3e64b2e\",params:{AuthRoleArn:\"arn:aws:iam::823322155619:role/Cognito_TessellateUnauth_Role\",UnauthRoleArn:\"arn:aws:iam::823322155619:role/Cognito_TessellateAuth_Role\"}}}},w=Object.defineProperties({setItem:function(e,t){this.exists&&window.sessionStorage.setItem(e,t)},getItem:function(e){return this.exists?window.sessionStorage.getItem(e):null},removeItem:function(e){if(this.exists)try{window.sessionStorage.removeItem(e)}catch(t){console.warn(\"Item could not be removed from session storage.\",t)}},clear:function(){if(this.exists)try{window.sessionStorage.clear()}catch(e){console.warn(\"Session storage could not be cleared.\",e)}}},{exists:{get:function(){var e=\"test\";if(\"undefined\"==typeof window)return!1;try{return window.sessionStorage.setItem(e,\"1\"),window.sessionStorage.removeItem(e),!0}catch(t){return console.warn(\"Session storage does not exist.\",t),!1}},configurable:!0,enumerable:!0}}),y={get:function(t,n){var r=e.get(t);return n&&r.query(n),r=s(r),i(r)},post:function(t,n){var r=e.post(t).send(n);return r=s(r),i(r)},put:function(t,n){var r=e.put(t).send(n);return r=s(r),i(r)},del:function(t,n){var r=e.put(t).send(n);return r=s(r),i(r)}},k=function(){function e(t){_classCallCheck(this,e),this.name=t.name,this.owner=t.owner||null,this.collaborators=t.collaborators||[],this.createdAt=t.createdAt,this.updatedAt=t.updatedAt,this.frontend=t.frontend||{},this.backend=t.backend||{},n&&(this.fbRef=new n(v.fbUrl+t.name))}return _createClass(e,[{key:\"getStructure\",value:function(){return this.getFiles().then(function(e){var t=u(e);return console.log(\"Child struct from array:\",t),t},function(e){return console.error(\"[Application.getStructure] Error getting files: \",e),Promise.reject({message:\"Error getting files.\",error:e})})}},{key:\"getFiles\",value:function(){if(this.frontend&&this.frontend.bucketName){\"undefined\"!=typeof AWS.config.credentials&&AWS.config.credentials||a();var e=new AWS.S3,t={Bucket:this.frontend.bucketName};return new Promise(function(n,r){e.listObjects(t,function(e,t){return e?(console.error(\"[Application.getObjects()] Error listing objects:\",e),r(e)):(console.log(\"[Application.getObjects()] listObjects returned:\",t),n(t.Contents))})})}return console.error(\"[Applicaiton.getFiles] Attempting to get objects for bucket without name.\"),Promise.reject({message:\"Bucket name required to get objects\"})}},{key:\"publishFile\",value:function(e){if(!this.frontend)return console.error(\"Frontend data not available. Make sure to call .get().\"),Promise.reject({message:\"Front end data is required to publish file.\"});var t={Bucket:this.frontent.bucketName,Key:e.key,Body:e.content,ACL:\"public-read\"};return e.contentType&&(t.ContentType=e.contentType),s3.putObject(t,function(e,t){return e?(console.error(\"[Application.publishFile()] Error saving file:\",e),Promise.reject(e)):(console.log(\"[Application.publishFile()] file saved successfully. Returning:\",t),t)})}},{key:\"addStorage\",value:function(){var t=v.serverUrl+\"/apps/\"+this.name+\"/storage\";return y.post(t,appData).then(function(t){return console.log(\"[Application.addStorage()] Apps:\",t),new e(t)})[\"catch\"](function(e){return console.error(\"[Application.addStorage()] Error getting apps list: \",e),Promise.reject(e)})}},{key:\"applyTemplate\",value:function(){v.serverUrl+\"/apps/\"+this.name+\"/template\";console.log(\"Applying templates to existing\")}}]),e}(),C=function(){function e(t){if(_classCallCheck(this,e),!t)throw console.error(\"Application name is required to start an AppAction\"),new Error(\"Application name is required to start an AppAction\");this.name=t,this.endpoint=v.serverUrl+\"/apps/\"+this.name}return _createClass(e,[{key:\"get\",value:function(){return y.get(this.endpoint).then(function(e){return console.log(\"[MatterClient.app().get()] App(s) data loaded:\",e),new k(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.app().get()] Error getting apps list: \",e),Promise.reject(e)})}},{key:\"update\",value:function(e){return y.put(this.endpoint,e).then(function(e){return console.log(\"[MatterClient.apps().update()] App:\",e),new k(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.apps().update()] Error updating app: \",e),Promise.reject(e)})}},{key:\"del\",value:function(e){return y[\"delete\"](this.endpoint,e).then(function(e){return console.log(\"[MatterClient.apps().del()] Apps:\",e),new k(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.apps().del()] Error deleting app: \",e),Promise.reject(e)})}},{key:\"getFiles\",value:function(){return this.get().then(function(e){e.getFiles().then(function(e){return e})[\"catch\"](function(e){return console.error(\"[MatterClient.app().getFiles()] Error getting application files: \",e),Promise.reject(e)})})[\"catch\"](function(e){return console.error(\"[MatterClient.app().getFiles()] Error getting application: \",e),Promise.reject(e)})}},{key:\"getStructure\",value:function(){return this.get().then(function(e){return e.getStructure().then(function(e){return console.log(\"Structure loaded: \",e),e})[\"catch\"](function(e){return console.error(\"[MatterClient.app().getStructure()] Error getting application structure: \",e),Promise.reject(e)})})[\"catch\"](function(e){return console.error(\"[MatterClient.app().getStructure()] Error getting application: \",e),Promise.reject(e)})}}]),e}(),b=function(){function e(){_classCallCheck(this,e),this.endpoint=v.serverUrl+\"/apps\"}return _createClass(e,[{key:\"get\",value:function(){return y.get(this.endpoint).then(function(e){return console.log(\"[MatterClient.apps().get()] App(s) data loaded:\",e),e})[\"catch\"](function(e){return console.error(\"[MatterClient.apps().get()] Error getting apps list: \",e),Promise.reject(e)})}},{key:\"add\",value:function(e){return y.post(this.endpoint,e).then(function(e){return console.log(\"[MatterClient.apps().add()] Application added successfully: \",e),new Application(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.getApps()] Error adding application: \",e),Promise.reject(e)})}}]),e}(),A=function(){function e(t){_classCallCheck(this,e),this.name=t.name,this.username=t.username,this.createdAt=t.createdAt,this.updatedAt=t.updatedAt}return _createClass(e,[{key:\"app\",value:function(e){return new C(e)}},{key:\"apps\",get:function(){return new b}}]),e}(),j=function(){function e(t){if(_classCallCheck(this,e),!t)throw console.error(\"Username is required to start an UserAction\"),new Error(\"Username is required to start an UserAction\");this.name=t,this.endpoint=v.serverUrl+\"/users/\"+this.name}return _createClass(e,[{key:\"get\",value:function(){return y.get(this.endpoint).then(function(e){return console.log(\"[MatterClient.user().get()] App(s) data loaded:\",e),new A(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.user().get()] Error getting users list: \",e),Promise.reject(e)})}},{key:\"update\",value:function(e){return y.put(this.endpoint,e).then(function(e){return console.log(\"[MatterClient.users().update()] App:\",e),new A(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.users().update()] Error updating user: \",e),Promise.reject(e)})}},{key:\"del\",value:function(e){console.error(\"Deleting a user is currently disabled.\")}}]),e}(),S=function(){function e(){_classCallCheck(this,e),this.endpoint=v.serverUrl+\"/users\"}return _createClass(e,[{key:\"get\",value:function(e){var n=this.endpoint;if(e&&!t.isString(e)){var r=\"Get only handles username as a string\";return console.error(r),Promise.reject({message:r})}return e&&(n=n+\"/\"+e),y.get(n).then(function(e){return console.log(\"[MatterClient.apps().get()] App(s) data loaded:\",e),e})[\"catch\"](function(e){return console.error(\"[MatterClient.apps().get()] Error getting apps list: \",e),Promise.reject(e)})}},{key:\"add\",value:function(e){return y.post(this.endpoint,e).then(function(e){return console.log(\"[MatterClient.apps().add()] Application added successfully: \",e),new Application(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.getApps()] Error adding application: \",e),Promise.reject(e)})}},{key:\"search\",value:function(e){console.log(\"search called:\",e);var n=this.endpoint+\"/search/\";return e&&t.isString(e)&&(n+=e),console.log(\"searchEndpoint:\",n),y.get(n).then(function(e){return console.log(\"[MatterClient.users().search()] Users(s) data loaded:\",e),e})[\"catch\"](function(e){return console.error(\"[MatterClient.users().search()] Error getting apps list: \",e),Promise.reject(e)})}}]),e}(),P=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),\"constructor\",this).call(this,\"tessellate\",{localServer:!0})}return _inherits(t,e),_createClass(t,[{key:\"app\",value:function(e){return console.log(\"New AppAction:\",new C(e)),new C(e)}},{key:\"user\",value:function(e){return new j(e)}},{key:\"apps\",get:function(){return console.log(\"New AppsAction:\",new b),new b}},{key:\"users\",get:function(){return new S}}]),t}(m);return P});\n//# sourceMappingURL=grout.min.js.map","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('superagent'), require('underscore'), require('firebase')) :\n\ttypeof define === 'function' && define.amd ? define(['superagent', 'underscore', 'firebase'], factory) :\n\tglobal.Grout = factory(global.superagent,global._,global.Firebase);\n}(this, function (superagent,_,Firebase) { 'use strict';\n\n\tsuperagent = 'default' in superagent ? superagent['default'] : superagent;\n\t_ = 'default' in _ ? _['default'] : _;\n\tFirebase = 'default' in Firebase ? Firebase['default'] : Firebase;\n\n\tlet _config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'matter'\n\t};\n\n\tlet _storage = {\n\t\tget exists() {\n\t\t\tconst testKey = 'test';\n\t\t\tif (typeof window != 'undefined') {\n\t\t\t\ttry {\n\t\t\t\t\twindow.sessionStorage.setItem(testKey, '1');\n\t\t\t\t\twindow.sessionStorage.removeItem(testKey);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Session storage does not exist.', err);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t *  @private\n\t\t */\n\t\tsetItem(itemName, itemValue) {\n\t\t\t//TODO: Handle itemValue being an object instead of a string\n\t\t\tif (this.exists) {\n\t\t\t\twindow.sessionStorage.setItem(itemName, itemValue);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley gets an item from session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t *\n\t\t * @return {String}\n\t\t *\n\t\t */\n\t\tgetItem(itemName) {\n\t\t\tif (this.exists) {\n\t\t\t\treturn window.sessionStorage.getItem(itemName);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName - The items name\n\t\t *\n\t\t */\n\t\tremoveItem(itemName) {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (this.exists) {\n\t\t\t\ttry {\n\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.removeItem(itemName);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Item could not be removed from session storage.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName the items name\n\t\t * @param {String} itemValue the items value\n\t\t *\n\t\t *  @private\n\t\t */\n\t\tclear() {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (this.exists) {\n\t\t\t\ttry {\n\t\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.clear();\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Session storage could not be cleared.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n\tclass _token {\n\t\tget string() {\n\t\t\treturn _storage.getItem(_config.tokenName);\n\t\t}\n\t\tget data() {\n\t\t\t//TODO: Decode token\n\t\t}\n\t\tstring(tokenStr) {\n\t\t\tconsole.log('Token was set', tokenStr);\n\t\t\treturn _storage.setItem(_config.tokenName, tokenStr);\n\t\t}\n\t\tsave(tokenStr) {\n\t\t\tthis.string = tokenStr;\n\t\t\t_storage.setItem(_config.tokenName, tokenStr);\n\t\t}\n\t\tdelete() {\n\t\t\t_storage.removeItem(_config.tokenName);\n\t\t\tconsole.log('Token was removed');\n\t\t}\n\t}\n\n\tlet _request = {\n\t\tget(endpoint, queryData) {\n\t\t\tvar req = superagent.get(endpoint);\n\t\t\tif (queryData) {\n\t\t\t\treq.query(queryData);\n\t\t\t}\n\t\t\treq = _addAuthHeader(req);\n\t\t\treturn _handleResponse(req);\n\t\t},\n\t\tpost(endpoint, data) {\n\t\t\tvar req = superagent.post(endpoint).send(data);\n\t\t\treq = _addAuthHeader(req);\n\t\t\treturn _handleResponse(req);\n\t\t},\n\t\tput(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = _addAuthHeader(req);\n\t\t\treturn _handleResponse(req);\n\t\t},\n\t\tdel(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = _addAuthHeader(req);\n\t\t\treturn _handleResponse(req);\n\t\t}\n\n\t};\n\n\tfunction _handleResponse(req) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treq.end((err, res) => {\n\t\t\t\tif (!err) {\n\t\t\t\t\t// console.log('Response:', res);\n\t\t\t\t\treturn resolve(res.body);\n\t\t\t\t} else {\n\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\tconsole.warn('Unauthorized. You must be signed into make this request.');\n\t\t\t\t\t}\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tfunction _addAuthHeader(req) {\n\t\tif (_storage.getItem(_config.tokenName)) {\n\t\t\treq = req.set('Authorization', 'Bearer ' + _storage.getItem(_config.tokenName));\n\t\t\tconsole.log('Set auth header');\n\t\t}\n\t\treturn req;\n\t}\n\n\tlet _user;\n\tclass Matter {\n\t\t/* Constructor\n\t\t * @param {string} appName Name of application\n\t\t */\n\t\tconstructor(appName, opts) {\n\t\t\tif (!appName) {\n\t\t\t\tthrow new Error('Application name is required to use Matter');\n\t\t\t} else {\n\t\t\t\tthis.name = appName;\n\t\t\t}\n\t\t\tif (opts) {\n\t\t\t\tthis.options = opts;\n\t\t\t}\n\t\t}\n\t\t/* Endpoint getter\n\t\t *\n\t\t */\n\t\tget endpoint() {\n\t\t\tlet serverUrl = _config.serverUrl;\n\t\t\tif (_.has(this, 'options') && this.options.localServer) {\n\t\t\t\tserverUrl = 'http://localhost:4000';\n\t\t\t}\n\t\t\tif (this.name == 'tessellate') {\n\t\t\t\t//Remove url if host is server\n\t\t\t\tif (window && _.has(window, 'location') && window.location.host == serverUrl) {\n\t\t\t\t\tconsole.warn('Host is Server, serverUrl simplified!');\n\t\t\t\t\tserverUrl = '';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tserverUrl = _config.serverUrl + '/apps/' + this.name;\n\t\t\t}\n\t\t\treturn serverUrl;\n\t\t}\n\t\t/* Signup\n\t\t *\n\t\t */\n\t\tsignup(signupData) {\n\t\t\treturn _request.post(this.endpoint + '/signup', signupData)\n\t\t\t.then(function(response) {\n\t\t\t  console.log(response);\n\t\t\t})\n\t\t\t['catch'](function(errRes) {\n\t\t\t  console.error('[signup()] Error signing up:', errRes);\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Login\n\t\t *\n\t\t */\n\t\tlogin(loginData) {\n\t\t\tif (!loginData || !loginData.password || !loginData.username) {\n\t\t\t\tconsole.error('Username/Email and Password are required to login');\n\t\t\t  return Promise.reject({message: 'Username/Email and Password are required to login'});\n\t\t\t}\n\t\t\treturn _request.put(this.endpoint + '/login', loginData)\n\t\t\t.then(function(response) {\n\t\t\t\t//TODO: Save token locally\n\t\t\t\tif (_.has(response, 'data') && _.has(response.data, 'status') && response.data.status == 409) {\n\t\t\t\t\tconsole.error('[Matter.login()] Account not found: ', response);\n\t\t\t\t\treturn Promise.reject(response.data);\n\t\t\t\t} else {\n\t\t\t\t\tif (_.has(response, 'token')) {\n\t\t\t\t\t\t_token.string = response.token;\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log('[Matter.login()] Successful login: ', response);\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t})['catch'](function(errRes) {\n\t\t\t\tif (errRes.status == 409 || errRes.status == 400) {\n\t\t\t\t\terrRes = errRes.response.text;\n\t\t\t\t}\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Logout\n\t\t */\n\t\tlogout() {\n\t\t\treturn _request.put(this.endpoint + '/logout').then(function(response) {\n\t\t\t  console.log('[Matter.logout()] Logout successful: ', response);\n\t\t\t  _token.delete();\n\t\t\t  return response;\n\t\t\t})['catch'](function(errRes) {\n\t\t\t  console.error('[Matter.logout()] Error logging out: ', errRes);\n\t\t\t  _token.delete();\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\n\t\tgetCurrentUser() {\n\t\t\t//TODO: Check Current user variable\n\t\t\treturn _request.get(this.endpoint + '/user', {\n\t\t\t}).then(function(response) {\n\t\t\t\t//TODO: Save user information locally\n\t\t\t\tconsole.log('[getCurrentUser()] Current User:', response.data);\n\t\t\t\t_user = response.data;\n\t\t\t\treturn _user;\n\t\t\t})['catch'](function(errRes) {\n\t\t\t\tconsole.error('[getCurrentUser()] Error getting current user: ', errRes);\n\t\t\t  return Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\n\t\tgetAuthToken() {\n\t\t\treturn _token.string;\n\t\t}\n\t}\n\n\tlet config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'grout-client',\n\t\tfbUrl: 'https://pruvit.firebaseio.com/',\n\t\taws: {\n\t\t\tregion: 'us-east-1',\n\t\t\tcognito: {\n\t\t\t\tpoolId: 'us-east-1:72a20ffd-c638-48b0-b234-3312b3e64b2e',\n\t\t\t\tparams: {\n\t\t\t\t\tAuthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateUnauth_Role',\n\t\t\t\t\tUnauthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateAuth_Role'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tlet storage = {\n\t\tget exists() {\n\t\t\tconst testKey = 'test';\n\t\t\tif (typeof window != 'undefined') {\n\t\t\t\ttry {\n\t\t\t\t\twindow.sessionStorage.setItem(testKey, '1');\n\t\t\t\t\twindow.sessionStorage.removeItem(testKey);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Session storage does not exist.', err);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t *  @private\n\t\t */\n\t\tsetItem(itemName, itemValue) {\n\t\t\t//TODO: Handle itemValue being an object instead of a string\n\t\t\tif (this.exists) {\n\t\t\t\twindow.sessionStorage.setItem(itemName, itemValue);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley gets an item from session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t *\n\t\t * @return {String}\n\t\t *\n\t\t */\n\t\tgetItem(itemName) {\n\t\t\tif (this.exists) {\n\t\t\t\treturn window.sessionStorage.getItem(itemName);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName - The items name\n\t\t *\n\t\t */\n\t\tremoveItem(itemName) {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (this.exists) {\n\t\t\t\ttry {\n\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.removeItem(itemName);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Item could not be removed from session storage.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName the items name\n\t\t * @param {String} itemValue the items value\n\t\t *\n\t\t *  @private\n\t\t */\n\t\tclear() {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (this.exists) {\n\t\t\t\ttry {\n\t\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.clear();\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn('Session storage could not be cleared.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n\tlet request = {\n\t\tget(endpoint, queryData) {\n\t\t\tvar req = superagent.get(endpoint);\n\t\t\tif (queryData) {\n\t\t\t\treq.query(queryData);\n\t\t\t}\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tpost(endpoint, data) {\n\t\t\tvar req = superagent.post(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tput(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tdel(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t}\n\n\t};\n\n\tfunction handleResponse(req) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treq.end((err, res) => {\n\t\t\t\tif (!err) {\n\t\t\t\t\t// console.log('Response:', res);\n\t\t\t\t\treturn resolve(res.body);\n\t\t\t\t} else {\n\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\tconsole.warn('Unauthorized. You must be signed into make this request.');\n\t\t\t\t\t}\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tfunction addAuthHeader(req) {\n\t\tif (storage.getItem(config.tokenName)) {\n\t\t\treq = req.set('Authorization', 'Bearer ' + storage.getItem(config.tokenName));\n\t\t\tconsole.log('Set auth header');\n\t\t}\n\t\treturn req;\n\t}\n\n\t/**\n\t * Application class.\n\t *\n\t */\n\tclass _Application {\n\t\tconstructor(appData) {\n\t\t\tthis.name = appData.name;\n\t\t\tthis.owner = appData.owner || null;\n\t\t\tthis.collaborators = appData.collaborators || [];\n\t\t\tthis.createdAt = appData.createdAt;\n\t\t\tthis.updatedAt = appData.updatedAt;\n\t\t\tthis.frontend = appData.frontend || {};\n\t\t\tthis.backend = appData.backend || {};\n\t\t\tif (Firebase) {\n\t\t\t\tthis.fbRef = new Firebase(config.fbUrl + appData.name);\n\t\t\t}\n\t\t}\n\t\t//Get files list and convert to structure\n\t\tgetStructure() {\n\t\t\treturn this.getFiles().then((filesArray) => {\n\t\t\t\tconst childStruct = childrenStructureFromArray(filesArray);\n\t\t\t\tconsole.log('Child struct from array:', childStruct);\n\t\t\t\treturn childStruct;\n\t\t\t}, (err) => {\n\t\t\t\tconsole.error('[Application.getStructure] Error getting files: ', err);\n\t\t\t\treturn Promise.reject({message: 'Error getting files.', error: err});\n\t\t\t});\n\t\t}\n\t\t//Get files list from S3\n\t\tgetFiles() {\n\t\t\tif (!this.frontend || !this.frontend.bucketName) {\n\t\t\t\tconsole.error('[Applicaiton.getFiles] Attempting to get objects for bucket without name.');\n\t\t\t\treturn Promise.reject({message: 'Bucket name required to get objects'});\n\t\t\t} else {\n\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t// console.info('AWS creds are being updated to make request');\n\t\t\t\t\tsetAWSConfig();\n\t\t\t\t}\n\t\t\t\tvar s3 = new AWS.S3();\n\t\t\t\tvar listParams = {Bucket: this.frontend.bucketName};\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\ts3.listObjects(listParams, function(err, data) {\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\tconsole.log('[Application.getObjects()] listObjects returned:', data);\n\t\t\t\t\t\t\treturn resolve(data.Contents);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error('[Application.getObjects()] Error listing objects:', err);\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tpublishFile(fileData) {\n\t\t\tif (!this.frontend) {\n\t\t\t\tconsole.error('Frontend data not available. Make sure to call .get().');\n\t\t\t\treturn Promise.reject({message: 'Front end data is required to publish file.'});\n\t\t\t}\n\t\t\tvar saveParams = {Bucket: this.frontent.bucketName, Key: fileData.key,  Body: fileData.content, ACL: 'public-read'};\n\t\t\t//Set contentType from fileData to ContentType parameter of new object\n\t\t\tif (fileData.contentType) {\n\t\t\t\tsaveParams.ContentType = fileData.contentType;\n\t\t\t}\n\t\t\t// console.log('[$aws.$saveFiles] saveParams:', saveParams);\n\t\t\treturn s3.putObject(saveParams, function(err, data) {\n\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\tif (!err) {\n\t\t\t\t\tconsole.log('[Application.publishFile()] file saved successfully. Returning:', data);\n\t\t\t\t\treturn data;\n\t\t\t\t}\telse {\n\t\t\t\t\tconsole.error('[Application.publishFile()] Error saving file:', err);\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\taddStorage() {\n\t\t\t//TODO:Add storage bucket\n\t\t\tvar endpoint = config.serverUrl + '/apps/' + this.name + '/storage';\n\t\t\treturn request.post(endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[Application.addStorage()] Apps:', response);\n\t\t\t\treturn new _Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[Application.addStorage()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\tapplyTemplate() {\n\t\t\tvar endpoint = config.serverUrl + '/apps/' + this.name + '/template';\n\t\t\tconsole.log('Applying templates to existing');\n\t\t\t// return request.post(endpoint, appData).then(function(response) {\n\t\t\t// \tconsole.log('[Application.addStorage()] Apps:', response);\n\t\t\t// \tif (!apps.isList) {\n\t\t\t// \t\treturn new Application(response);\n\t\t\t// \t}\n\t\t\t// \treturn response;\n\t\t\t// })['catch'](function(errRes) {\n\t\t\t// \tconsole.error('[Application.addStorage()] Error getting apps list: ', errRes);\n\t\t\t// \treturn Promise.reject(errRes);\n\t\t\t// });\n\t\t}\n\t}\n\n\t//------------------ Utility Functions ------------------//\n\n\t// AWS Config\n\tfunction setAWSConfig() {\n\t\tAWS.config.update({\n\t\t  credentials: new AWS.CognitoIdentityCredentials({\n\t\t  IdentityPoolId: config.aws.cognito.poolId\n\t\t  }),\n\t\t  region: config.aws.region\n\t\t});\n\t}\n\n\t//Convert from array file structure (from S3) to 'children' structure used in Editor GUI (angular-tree-control)\n\t//Examples for two files (index.html and /testFolder/file.js):\n\t//Array structure: [{path:'index.html'}, {path:'testFolder/file.js'}]\n\t//Children Structure [{type:'folder', name:'testfolder', children:[{path:'testFolder/file.js', name:'file.js', filetype:'javascript', contentType:'application/javascript'}]}]\n\tfunction childrenStructureFromArray(fileArray) {\n\t\t// console.log('childStructureFromArray called:', fileArray);\n\t\t//Create a object for each file that stores the file in the correct 'children' level\n\t\tvar mappedStructure = fileArray.map(function(file) {\n\t\t\treturn buildStructureObject(file);\n\t\t});\n\t\treturn combineLikeObjs(mappedStructure);\n\t}\n\t//Convert file with key into a folder/file children object\n\tfunction buildStructureObject(file) {\n\t\tvar pathArray;\n\t\t// console.log('buildStructureObject with:', file);\n\t\tif (_.has(file, 'path')) {\n\t\t\t//Coming from files already having path (structure)\n\t\t\tpathArray = file.path.split('/');\n\t\t} else {\n\t\t\t//Coming from aws\n\t\t\tpathArray = file.Key.split('/');\n\t\t\t// console.log('file before pick:', file);\n\t\t\tfile = _.pick(file, 'Key');\n\t\t\tfile.path = file.Key;\n\t\t\tfile.name = file.Key;\n\t\t}\n\t\tvar currentObj = file;\n\t\tif (pathArray.length == 1) {\n\t\t\tcurrentObj.name = pathArray[0];\n\t\t\tif (!_.has(currentObj,'type')) {\n\t\t\t\tcurrentObj.type = 'file';\n\t\t\t}\n\t\t\tcurrentObj.path = pathArray[0];\n\t\t\treturn currentObj;\n\t\t} else {\n\t\t\tvar finalObj = {};\n\t\t\t_.each(pathArray, (loc, ind, list) => {\n\t\t\t\tif (ind != list.length - 1) {//Not the last loc\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = _.first(list, ind + 1).join('/');\n\t\t\t\t\tcurrentObj.type = 'folder';\n\t\t\t\t\tcurrentObj.children = [{}];\n\t\t\t\t\t//TODO: Find out why this works\n\t\t\t\t\tif (ind == 0) {\n\t\t\t\t\t\tfinalObj = currentObj;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentObj = currentObj.children[0];\n\t\t\t\t} else {\n\t\t\t\t\tcurrentObj.type = 'file';\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = pathArray.join('/');\n\t\t\t\t\tif (file.$id) {\n\t\t\t\t\t\tcurrentObj.$id = file.$id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn finalObj;\n\t\t}\n\t}\n\t//Recursivley combine children of object's that have the same names\n\tfunction combineLikeObjs(mappedArray) {\n\t\tvar takenNames = [];\n\t\tvar finishedArray = [];\n\t\t_.each(mappedArray, (obj, ind, list) => {\n\t\t\tif (takenNames.indexOf(obj.name) == -1) {\n\t\t\t\ttakenNames.push(obj.name);\n\t\t\t\tfinishedArray.push(obj);\n\t\t\t} else {\n\t\t\t\tvar likeObj = _.findWhere(mappedArray, {name: obj.name});\n\t\t\t\t//Combine children of like objects\n\t\t\t\tlikeObj.children = _.union(obj.children, likeObj.children);\n\t\t\t\tlikeObj.children = combineLikeObjs(likeObj.children);\n\t\t\t\t// console.log('extended obj:',likeObj);\n\t\t\t}\n\t\t});\n\t\treturn finishedArray;\n\t}\n\n\t//Actions for specific application\n\tclass AppAction {\n\t\tconstructor(appName) {\n\t\t\tif (appName) {\n\t\t\t\tthis.name = appName;\n\t\t\t\tthis.endpoint = `${config.serverUrl}/apps/${this.name}`;\n\t\t\t} else {\n\t\t\t\tconsole.error('Application name is required to start an AppAction');\n\t\t\t\tthrow new Error('Application name is required to start an AppAction');\n\t\t\t}\n\t\t}\n\t\t//Get applications or single application\n\t\tget() {\n\t\t\treturn request.get(this.endpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.app().get()] App(s) data loaded:', response);\n\t\t\t\treturn new _Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.app().get()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update an application\n\t\tupdate(appData) {\n\t\t\treturn request.put(this.endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().update()] App:', response);\n\t\t\t\treturn new _Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.apps().update()] Error updating app: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete an application\n\t\tdel(appData) {\n\t\t\treturn request.delete(this.endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().del()] Apps:', response);\n\t\t\t\treturn new _Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.apps().del()] Error deleting app: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\tgetFiles() {\n\t\t\treturn this.get().then((app) => {\n\t\t\t\tapp.getFiles().then((filesArray)=> {\n\t\t\t\t\treturn filesArray;\n\t\t\t\t})['catch']((err) => {\n\t\t\t\t\tconsole.error('[MatterClient.app().getFiles()] Error getting application files: ', err);\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t});\n\t\t\t})['catch']((err) => {\n\t\t\t\tconsole.error('[MatterClient.app().getFiles()] Error getting application: ', err);\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t\t}\n\n\t\tgetStructure() {\n\t\t\treturn this.get().then((app) => {\n\t\t\t\treturn app.getStructure().then((structure)=> {\n\t\t\t\t\tconsole.log('Structure loaded: ', structure);\n\t\t\t\t\treturn structure;\n\t\t\t\t})['catch']((err) => {\n\t\t\t\t\tconsole.error('[MatterClient.app().getStructure()] Error getting application structure: ', err);\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t});\n\t\t\t})['catch']((err) => {\n\t\t\t\tconsole.error('[MatterClient.app().getStructure()] Error getting application: ', err);\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t\t}\n\t}\n\n\t//Actions for applications list\n\tclass AppsAction {\n\t\tconstructor() {\n\t\t\tthis.endpoint = config.serverUrl + '/apps';\n\t\t}\n\t\t//Get applications or single application\n\t\tget() {\n\t\t\treturn request.get(this.endpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().get()] App(s) data loaded:', response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.apps().get()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\treturn request.post(this.endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().add()] Application added successfully: ', response);\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.getApps()] Error adding application: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * User class.\n\t *\n\t */\n\tclass User {\n\t\tconstructor(userData) {\n\t\t\tthis.name = userData.name;\n\t\t\tthis.username = userData.username;\n\t\t\tthis.createdAt = userData.createdAt;\n\t\t\tthis.updatedAt = userData.updatedAt;\n\t\t}\n\t\tget apps() {\n\t\t\treturn new AppsAction();\n\t\t}\n\t\tapp(appName) {\n\t\t\t//TODO: Attach owner as well ?\n\t\t\treturn new AppAction(appName);\n\t\t}\n\t}\n\n\t//Actions for specific user\n\tclass UserAction {\n\t\tconstructor(userName) {\n\t\t\tif (userName) {\n\t\t\t\tthis.name = userName;\n\t\t\t\tthis.endpoint = `${config.serverUrl}/users/${this.name}`;\n\t\t\t} else {\n\t\t\t\tconsole.error('Username is required to start an UserAction');\n\t\t\t\tthrow new Error('Username is required to start an UserAction');\n\t\t\t}\n\t\t}\n\t\t//Get userlications or single userlication\n\t\tget() {\n\t\t\treturn request.get(this.endpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.user().get()] App(s) data loaded:', response);\n\t\t\t\treturn new User(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.user().get()] Error getting users list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update an userlication\n\t\tupdate(userData) {\n\t\t\treturn request.put(this.endpoint, userData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.users().update()] App:', response);\n\t\t\t\treturn new User(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.users().update()] Error updating user: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete an userlication\n\t\t//TODO: Only do request if deleting personal account\n\t\tdel(userData) {\n\t\t\tconsole.error('Deleting a user is currently disabled.');\n\t\t\t// return request.delete(this.endpoint, userData).then((response) => {\n\t\t\t// \tconsole.log('[MatterClient.users().del()] Apps:', response);\n\t\t\t// \treturn new User(response);\n\t\t\t// })['catch']((errRes) => {\n\t\t\t// \tconsole.error('[MatterClient.users().del()] Error deleting user: ', errRes);\n\t\t\t// \treturn Promise.reject(errRes);\n\t\t\t// });\n\t\t}\n\t}\n\n\t//Actions for applications list\n\tclass UsersAction {\n\t\tconstructor() {\n\t\t\tthis.endpoint = config.serverUrl + '/users';\n\t\t}\n\t\t//Get applications or single application\n\t\tget(query) {\n\t\t\tlet userEndpoint = this.endpoint;\n\t\t\tif (query && !_.isString(query)) {\n\t\t\t\tconst msg = 'Get only handles username as a string';\n\t\t\t\tconsole.error(msg);\n\t\t\t\treturn Promise.reject({message: msg});\n\t\t\t}\n\t\t\tif (query) {\n\t\t\t userEndpoint = userEndpoint + '/' + query;\n\t\t\t}\n\t\t\treturn request.get(userEndpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().get()] App(s) data loaded:', response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.apps().get()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\treturn request.post(this.endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().add()] Application added successfully: ', response);\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.getApps()] Error adding application: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Search with partial of username\n\t\tsearch(query) {\n\t\t\tconsole.log('search called:', query);\n\t\t\tvar searchEndpoint = this.endpoint + '/search/';\n\t\t\tif (query && _.isString(query)) {\n\t\t\t\tsearchEndpoint += query;\n\t\t\t}\n\t\t\tconsole.log('searchEndpoint:', searchEndpoint);\n\t\t\treturn request.get(searchEndpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.users().search()] Users(s) data loaded:', response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.users().search()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet user;\n\tlet token;\n\n\t/**Grout Client Class\n\t * @ description Extending matter provides token storage and login/logout/signup capabilities\n\t */\n\tclass Grout extends Matter {\n\t\t//TODO: Use getter/setter to make this not a function\n\t\tconstructor() {\n\t\t\t//Call matter with tessellate\n\t\t\tsuper('tessellate', {localServer: true});\n\t\t}\n\t\t//Start a new Apps Action\n\t\tget apps() {\n\t\t\tconsole.log('New AppsAction:', new AppsAction());\n\t\t\treturn new AppsAction();\n\t\t}\n\t\t//Start a new App action\n\t\tapp(appName) {\n\t\t\tconsole.log('New AppAction:', new AppAction(appName));\n\t\t\treturn new AppAction(appName);\n\t\t}\n\t\t//Start a new Users action\n\t\tget users() {\n\t\t\treturn new UsersAction();\n\t\t}\n\t\t//Start a new User action\n\t\tuser(username) {\n\t\t\treturn new UserAction(username);\n\t\t}\n\t};\n\n\treturn Grout;\n\n}));"],"sourceRoot":"/source/"}