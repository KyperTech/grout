{"version":3,"sources":["grout.min.js","/source/grout.js"],"names":["_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_classCallCheck","instance","Constructor","_get","_x","_x2","_x3","_again","object","property","receiver","desc","parent","getter","undefined","Function","getOwnPropertyDescriptor","get","call","getPrototypeOf","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","global","factory","exports","module","require","define","amd","Grout","_","jwtDecode","superagent","AWS","Firebase","this","runConsoleMethod","methodName","methodData","console","apply","log","buildMessageArgs","logData","msgStr","msgObj","isObject","logLevel","has","obj","func","file","each","omit","keys","ind","list","isString","msg","decodeToken","tokenStr","tokenData","err","____________logger","error","description","data","Error","handleResponse","req","Promise","resolve","reject","end","res","status","warn","response","text","body","addAuthHeader","token","string","set","info","message","_setAWSConfig","config","update","credentials","CognitoIdentityCredentials","IdentityPoolId","aws","cognito","poolId","region","setAWSConfig","childrenStructureFromArray","fileArray","mappedStructure","map","buildStructureObject","combineLikeObjs","pathArray","path","split","Key","pick","name","currentObj","type","finalObj","loc","take","join","children","$id","mappedArray","takenNames","finishedArray","indexOf","push","likeObj","findWhere","union","_config","serverUrl","tokenName","tokenDataName","tokenUserDataName","msgArgs","envName","debug","domUtil","loadCss","src","document","css","createElement","rel","href","getElementsByTagName","insertBefore","firstChild","element","loadJs","window","js","appendChild","asyncLoadJs","setTimeout","storage","item","itemName","itemValue","setItem","localExists","JSON","stringify","sessionStorage","getItem","itemStr","isObj","itemObj","parse","removeItem","clear","testKey","save","delete","___________request","endpoint","queryData","query","post","send","put","del","clientIds","ProviderAuth","actionData","app","redirectUri","provider","hello","on","auth","network","api","then","r","userData","errRes","_this","loadHello","providersConfig","init","redirect_uri","_this2","initHello","login","_this3","Matter","appName","opts","options","signupData","account","signup","loginData","_this4","password","username","_this5","isLoggedIn","currentUser","_this6","responseData","updateData","_this7","checkGroups","_this8","isArray","isInGroups","_ret","groupName","groupsArray","v","groups","group","userGroups","any","_this9","every","isInGroup","localServer","url","location","host","user","logger","request","dom","fbUrl","matterOptions","params","AuthRoleArn","UnauthRoleArn","matter","__________request","utils","___________logger","_Directory","directoryName","directoryEndpoint","directoryData","endpointArray","splice","endpointStr","_________request","__________logger","DirectoriesAction","action","providedData","directoriesEndpoint","descrption","appData","searchEndpoint","________request","_________logger","_Group","groupData","groupEndpoint","accountsData","accountsArray","accounts","_______request","________logger","GroupsAction","groupsEndpoint","newGroupData","______request","_______logger","_Account","accountData","extend","accountEndpoint","______logger","AccountsAction","accountsEndpoint","newAccount","_____request","_____logger","_Template","templateData","templateEndpoint","____logger","____request","TemplatesAction","templatesEndpoint","___logger","_File","fileData","_this10","frontend","saveParams","Bucket","bucketName","contentType","ContentType","s3","getObject","Body","content","ACL","putObject","divId","re","ext","exec","__logger","Files","filesData","_this11","applicationData","_ret2","S3","listParams","listObjects","Contents","filesArray","childStruct","childStructure","_request","_logger","Application","fbRef","appEndpoint","application","_this12","AppsAction","appsEndpoint","_Matter","template"],"mappings":"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","file":"grout.min.js","sourcesContent":[null,"(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('lodash'), require('jwt-decode'), require('superagent'), require('aws-sdk'), require('firebase')) :\n\ttypeof define === 'function' && define.amd ? define(['lodash', 'jwt-decode', 'superagent', 'aws-sdk', 'firebase'], factory) :\n\tglobal.Grout = factory(global._,global.jwtDecode,global.superagent,global.AWS,global.Firebase);\n}(this, function (_,jwtDecode,superagent,AWS,Firebase) { 'use strict';\n\n\t_ = 'default' in _ ? _['default'] : _;\n\tjwtDecode = 'default' in jwtDecode ? jwtDecode['default'] : jwtDecode;\n\tsuperagent = 'default' in superagent ? superagent['default'] : superagent;\n\tAWS = 'default' in AWS ? AWS['default'] : AWS;\n\tFirebase = 'default' in Firebase ? Firebase['default'] : Firebase;\n\n\tlet _config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'tessellate',\n\t\ttokenDataName: 'tessellate-tokenData',\n\t\ttokenUserDataName: 'tessellate-currentUser'\n\t};\n\n\t//Set default log level to debug\n\tlet logLevel = 'debug';\n\t//Set log level from config\n\tif (_config.logLevel) {\n\t\tlogLevel = _config.logLevel;\n\t}\n\n\tlet ____________logger = {\n\t\tlog(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'production') {\n\t\t\t\trunConsoleMethod('log', msgArgs);\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('log', msgArgs);\n\t\t\t}\n\t\t},\n\t\tinfo(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'production') {\n\t\t\t\trunConsoleMethod('info', msgArgs);\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('info', msgArgs);\n\t\t\t}\n\t\t},\n\t\twarn(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'production') {\n\t\t\t\trunConsoleMethod('warn', msgArgs);\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('warn', msgArgs);\n\t\t\t}\n\t\t},\n\t\tdebug(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'production') {\n\t\t\t\t// runConsoleMethod('debug', msgArgs);\n\t\t\t\t//Do not display console debugs in production\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('debug', msgArgs);\n\t\t\t}\n\t\t},\n\t\terror(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'production') {\n\t\t\t\t//TODO: Log to external logger\n\t\t\t\trunConsoleMethod('error', msgArgs);\n\t\t\t} else {\n\t\t\t\trunConsoleMethod('error', msgArgs);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction runConsoleMethod(methodName, methodData) {\n\t\t//Safley run console methods or use console log\n\t\tif (methodName && console[methodName]) {\n\t\t\treturn console[methodName].apply(console, methodData);\n\t\t} else {\n\t\t\treturn console.log.apply(console, methodData);\n\t\t}\n\t}\n\tfunction buildMessageArgs(logData) {\n\t\tvar msgStr = '';\n\t\tvar msgObj = {};\n\t\t//TODO: Attach time stamp\n\t\t//Attach location information to the beginning of message\n\t\tif (_.isObject(logData)) {\n\t\t\tif (logLevel == 'debug') {\n\t\t\t\tif (_.has(logData, 'func')) {\n\t\t\t\t\tif (_.has(logData, 'obj')) {\n\t\t\t\t\t\t//Object and function provided\n\t\t\t\t\t\tmsgStr += `[${logData.obj}.${logData.func}()]\\n `;\n\t\t\t\t\t} else if (_.has(logData, 'file')) {\n\t\t\t\t\t\tmsgStr += `[${logData.file} > ${logData.func}()]\\n `;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmsgStr += `[${logData.func}()]\\n `;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//Print each key and its value other than obj and func\n\t\t\t_.each(_.omit(_.keys(logData)), (key, ind, list) => {\n\t\t\t\tif (key != 'func' && key != 'obj') {\n\t\t\t\t\tif (key == 'description' || key == 'message') {\n\t\t\t\t\t\tmsgStr += logData[key];\n\t\t\t\t\t} else if (_.isString(logData[key])) {\n\t\t\t\t\t\t// msgStr += key + ': ' + logData[key] + ', ';\n\t\t\t\t\t\tmsgObj[key] = logData[key];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Print objects differently\n\t\t\t\t\t\t// msgStr += key + ': ' + logData[key] + ', ';\n\t\t\t\t\t\tmsgObj[key] = logData[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tmsgStr += '\\n';\n\t\t} else if (_.isString(logData)) {\n\t\t\tmsgStr = logData;\n\t\t}\n\t\tvar msg = [msgStr, msgObj];\n\n\t\treturn msg;\n\t}\n\n\tlet domUtil = {\n\t\t/**\n\t\t * @description\n\t\t * Appends given css source to DOM head.\n\t\t *\n\t\t * @param {String} src - url src for css to append\n\t\t *\n\t\t */\n\t\tloadCss: (src) => {\n\t\t\tif (typeof document == 'undefined') {\n\t\t\t\t____________logger.error({description: 'Document does not exsist to load assets into.', func: 'loadCss', obj: 'dom'});\n\t\t\t\tthrow new Error('Document object is required to load assets.');\n\t\t\t} else {\n\t\t\t\tlet css = document.createElement('link');\n\t\t\t\tcss.rel = 'stylesheet';\n\t\t\t\tcss.type = 'text/css';\n\t\t\t\tcss.href = src;\n\t\t\t\tdocument.getElementsByTagName('head')[0].insertBefore(css, document.getElementsByTagName('head')[0].firstChild);\n\t\t\t\t____________logger.log({description: 'CSS was loaded into document.', element: css, func: 'loadCss', obj: 'dom'});\n\t\t\t\treturn css; //Return link element\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Appends given javascript source to DOM head.\n\t\t *\n\t\t * @param {String} src - url src for javascript to append\n\t\t *\n\t\t */\n\t\tloadJs: (src) => {\n\t\t\tif (typeof window == 'undefined' || !_.has(window, 'document')) {\n\t\t\t\t____________logger.error({description: 'Document does not exsist to load assets into.', func: 'loadCss', obj: 'dom'});\n\t\t\t\tthrow new Error('Document object is required to load assets.');\n\t\t\t} else {\n\t\t\t\tlet js = window.document.createElement('script');\n\t\t\t\tjs.src = src;\n\t\t\t\tjs.type = 'text/javascript';\n\t\t\t\twindow.document.getElementsByTagName('head')[0].appendChild(js);\n\t\t\t\t____________logger.log({description: 'JS was loaded into document.', element: js, func: 'loadCss', obj: 'dom'});\n\t\t\t\treturn js; //Return script element\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Appends given javascript source to DOM head.\n\t\t *\n\t\t * @param {String} src - url src for javascript to append\n\t\t *\n\t\t */\n\t\tasyncLoadJs: (src) => {\n\t\t\tif (typeof window == 'undefined' || !_.has(window, 'document')) {\n\t\t\t\t____________logger.error({description: 'Document does not exsist to load assets into.', func: 'loadCss', obj: 'dom'});\n\t\t\t\tthrow new Error('Document object is required to load assets.');\n\t\t\t} else {\n\t\t\t\tlet js = window.document.createElement('script');\n\t\t\t\tjs.src = src;\n\t\t\t\tjs.type = 'text/javascript';\n\t\t\t\twindow.document.getElementsByTagName('head')[0].appendChild(js);\n\t\t\t\t____________logger.log({description: 'JS was loaded into document.', element: js, func: 'loadCss', obj: 'dom'});\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\twindow.setTimeout(resolve, 30);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tlet data = {};\n\tlet storage = {\n\t\tget localExists() {\n\t\t\tconst testKey = 'test';\n\t\t\tif (typeof window != 'undefined' && typeof window.sessionStorage != 'undefined') {\n\t\t\t\ttry {\n\t\t\t\t\twindow.sessionStorage.setItem(testKey, '1');\n\t\t\t\t\twindow.sessionStorage.removeItem(testKey);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (err) {\n\t\t\t\t\t____________logger.error({description: 'Error saving to session storage', error: err,  obj: 'storage', func: 'localExists'});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t */\n\t\titem(itemName, itemValue) {\n\t\t\treturn this.setItem(itemName, itemValue);\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage. Alias: item()\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t */\n\t\tsetItem(itemName, itemValue) {\n\t\t\tdata[itemName] = itemValue;\n\t\t\tif (this.localExists) {\n\t\t\t\t//Convert object to string\n\t\t\t\tif (_.isObject(itemValue)) {\n\t\t\t\t\titemValue = JSON.stringify(itemValue);\n\t\t\t\t}\n\t\t\t\twindow.sessionStorage.setItem(itemName, itemValue);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @description\n\t\t * Safley gets an item from session storage. Alias: item()\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t *\n\t\t * @return {String}\n\t\t *\n\t\t */\n\t\tgetItem(itemName) {\n\t\t\tif (data[itemName]) {\n\t\t\t\treturn data[itemName];\n\t\t\t} else if (this.localExists) {\n\t\t\t\tlet itemStr = window.sessionStorage.getItem(itemName);\n\t\t\t\t//Check that str is not null before parsing\n\t\t\t\tif (itemStr) {\n\t\t\t\t\tlet isObj = false;\n\t\t\t\t\tlet itemObj = null;\n\t\t\t\t\t//Try parsing to object\n\t\t\t\t\ttry {\n\t\t\t\t\t\titemObj = JSON.parse(itemStr);\n\t\t\t\t\t\tisObj = true;\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t// logger.log({message: 'String could not be parsed.', error: err, func: 'getItem', obj: 'storage'});\n\t\t\t\t\t\t//Parsing failed, this must just be a string\n\t\t\t\t\t\tisObj = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (isObj) {\n\t\t\t\t\t\treturn itemObj;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn itemStr;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName - The items name\n\t\t *\n\t\t */\n\t\tremoveItem(itemName) {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (data[itemName]) {\n\t\t\t\tdata[itemName] = null;\n\t\t\t}\n\t\t\tif (this.localExists) {\n\t\t\t\ttry {\n\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.removeItem(itemName);\n\t\t\t\t} catch (err) {\n\t\t\t\t\t____________logger.error({description: 'Error removing item from session storage', error: err,  obj: 'storage', func: 'removeItem'});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName the items name\n\t\t * @param {String} itemValue the items value\n\t\t *\n\t\t */\n\t\tclear() {\n\t\t\t//TODO: Only remove used items\n\t\t\tdata = {};\n\t\t\tif (this.localExists) {\n\t\t\t\ttry {\n\t\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.clear();\n\t\t\t\t} catch (err) {\n\t\t\t\t\t____________logger.warn('Session storage could not be cleared.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n\tfunction decodeToken(tokenStr) {\n\t\tlet tokenData;\n\t\tif (tokenStr && tokenStr != '') {\n\t\t\ttry {\n\t\t\t\ttokenData = jwtDecode(tokenStr);\n\t\t\t} catch (err) {\n\t\t\t\t____________logger.error({description: 'Error decoding token.', data: tokenData, error: err, func: 'decodeToken', file: 'token'});\n\t\t\t\tthrow new Error('Invalid token string.');\n\t\t\t}\n\t\t}\n\t\treturn tokenData;\n\t}\n\tlet token = {\n\t\tget string() {\n\t\t\treturn storage.getItem(_config.tokenName);\n\t\t},\n\t\tget data() {\n\t\t\tif (storage.getItem(_config.tokenDataName)) {\n\t\t\t\treturn storage.getItem(_config.tokenDataName);\n\t\t\t} else {\n\t\t\t\treturn decodeToken(this.string);\n\t\t\t}\n\t\t},\n\t\tset data(tokenData) {\n\t\t\tif (_.isString(tokenData)) {\n\t\t\t\tlet tokenStr = tokenData;\n\t\t\t\ttokenData = decodeToken(tokenStr);\n\t\t\t\t____________logger.info({description: 'Token data was set as string. Decoding token.', token: tokenStr, tokenData: tokenData, func: 'data', obj: 'token'});\n\t\t\t} else {\n\t\t\t\t____________logger.log({description: 'Token data was set.', data: tokenData, func: 'data', obj: 'token'});\n\t\t\t\tstorage.setItem(_config.tokenDataName, tokenData);\n\t\t\t}\n\t\t},\n\t\tset string(tokenData) {\n\t\t\tlet tokenStr;\n\t\t\t//Handle object being passed\n\t\t\tif (!_.isString(tokenData)) {\n\t\t\t\t//Token is included in object\n\t\t\t\t____________logger.log({description: 'Token data is not string.', token: tokenData, func: 'string', obj: 'token'});\n\n\t\t\t\tif (_.isObject(tokenData) && _.has(tokenData, 'token')) {\n\t\t\t\t\ttokenStr = tokenData.token;\n\t\t\t\t} else {\n\t\t\t\t\t//Input is either not an string or object that contains nessesary info\n\t\t\t\t\t____________logger.error({description: 'Invalid value set to token.', token: tokenData, func: 'string', obj: 'token'});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttokenStr = tokenData;\n\t\t\t}\n\t\t\t____________logger.log({description: 'Token was set.', token: tokenData, tokenStr: tokenStr, func: 'string', obj: 'token'});\n\t\t\tstorage.setItem(_config.tokenName, tokenStr);\n\t\t\tthis.data = jwtDecode(tokenStr);\n\t\t},\n\t\tsave(tokenStr) {\n\t\t\tthis.string = tokenStr;\n\t\t},\n\t\tdelete() {\n\t\t\t//Remove string token\n\t\t\tstorage.removeItem(_config.tokenName);\n\t\t\t//Remove user data\n\t\t\tstorage.removeItem(_config.tokenDataName);\n\t\t\t____________logger.log({description: 'Token was removed.', func: 'delete', obj: 'token'});\n\t\t}\n\t};\n\n\tlet ___________request = {\n\t\tget(endpoint, queryData) {\n\t\t\tvar req = superagent.get(endpoint);\n\t\t\tif (queryData) {\n\t\t\t\treq.query(queryData);\n\t\t\t}\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tpost(endpoint, data) {\n\t\t\tvar req = superagent.post(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tput(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tdel(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t}\n\t};\n\n\tfunction handleResponse(req) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treq.end((err, res) => {\n\t\t\t\tif (!err) {\n\t\t\t\t\t// logger.log({description: 'Response:', response:res, func:'handleResponse', file: 'request'});\n\t\t\t\t\treturn resolve(res.body);\n\t\t\t\t} else {\n\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\t____________logger.warn({description: 'Unauthorized. You must be signed into make this request.', func: 'handleResponse'});\n\t\t\t\t\t}\n\t\t\t\t\tif (err && err.response) {\n\t\t\t\t\t\treturn reject(err.response.text);\n\t\t\t\t\t}\n\t\t\t\t\t____________logger.warn({description: 'Unauthorized. You must be signed into make this request.', error: err, func: 'handleResponse'});\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tfunction addAuthHeader(req) {\n\t\tif (token.string) {\n\t\t\treq = req.set('Authorization', 'Bearer ' + token.string);\n\t\t\tconsole.info({message: 'Set auth header', func: 'addAuthHeader', file: 'request'});\n\t\t}\n\t\treturn req;\n\t}\n\n\t// import hello from 'hellojs'; //Modifies objects to have id parameter?\n\n\t// import hello from 'hellojs'; //After es version of module is created\n\t//Private object containing clientIds\n\tlet clientIds = {};\n\n\tclass ProviderAuth {\n\t\tconstructor(actionData) {\n\t\t\tthis.app = actionData.app ? actionData.app : null;\n\t\t\tthis.redirectUri = actionData.redirectUri ? actionData.redirectUri : 'redirect.html';\n\t\t\tthis.provider = actionData.provider ? actionData.provider : null;\n\t\t}\n\t\tloadHello() {\n\t\t\t//Load hellojs script\n\t\t\t//TODO: Replace this with es6ified version\n\t\t\tif (typeof window != 'undefined' && !window.hello) {\n\t\t\t\treturn domUtil.asyncLoadJs('https://s3.amazonaws.com/kyper-cdn/js/hello.js');\n\t\t\t} else {\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\t\t}\n\t\thelloLoginListener() {\n\t\t\t//Login Listener\n\t\t\twindow.hello.on('auth.login', (auth) => {\n\t\t\t\t____________logger.info({description: 'User logged in to google.', func: 'loadHello', obj: 'Google'});\n\t\t\t\t// Call user information, for the given network\n\t\t\t\twindow.hello(auth.network).api('/me').then(function(r) {\n\t\t\t\t\t// Inject it into the container\n\t\t\t\t\t//TODO:Send account informaiton to server\n\t\t\t\t\tvar userData = r;\n\t\t\t\t\tuserData.provider = auth.network;\n\t\t\t\t\t//Login or Signup endpoint\n\t\t\t\t\treturn ___________request.post(this.endpoint + '/provider', userData)\n\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\t____________logger.log({description: 'Provider request successful.',  response: response, func: 'signup', obj: 'GoogleUtil'});\n\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t['catch']((errRes) => {\n\t\t\t\t\t\t\t____________logger.error({description: 'Error requesting login.', error: errRes, func: 'signup', obj: 'Matter'});\n\t\t\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tinitHello() {\n\t\t\treturn this.loadHello().then(() => {\n\t\t\t\treturn ___________request.get(`${this.app.endpoint}/providers`)\n\t\t\t\t.then((response) => {\n\t\t\t\t\t____________logger.log({description: 'Provider request successful.',  response: response, func: 'initHello', obj: 'ProviderAuth'});\n\t\t\t\t\tlet provider = response[this.provider];\n\t\t\t\t\tif (!provider) {\n\t\t\t\t\t\t____________logger.error({description: 'Provider is not setup. Visit tessellate.kyper.io to enter your client id for ' + this.provider, provider: this.provider, clientIds: clientIds, func: 'login', obj: 'ProviderAuth'});\n\t\t\t\t\t\treturn Promise.reject({message: 'Provider is not setup.'});\n\t\t\t\t\t}\n\t\t\t\t\t____________logger.log({description: 'Providers config built', providersConfig: response, func: 'initHello', obj: 'ProviderAuth'});\n\t\t\t\t\treturn window.hello.init(response, {redirect_uri: 'redirect.html'});\n\t\t\t\t}, (err) => {\n\t\t\t\t\t____________logger.error({description: 'Error loading hellojs.', error: errRes, func: 'initHello', obj: 'ProviderAuth'});\n\t\t\t\t\treturn Promise.reject({message: 'Error requesting application third party providers.'});\n\t\t\t\t})\n\t\t\t\t['catch']((errRes) => {\n\t\t\t\t\t____________logger.error({description: 'Error loading hellojs.', error: errRes, func: 'initHello', obj: 'ProviderAuth'});\n\t\t\t\t\treturn Promise.reject({message: 'Error loading third party login capability.'});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tlogin() {\n\t\t\t//Initalize Hello\n\t\t\treturn this.initHello().then(() => {\n\t\t\t\treturn window.hello.login(this.provider);\n\t\t\t}, (err) => {\n\t\t\t\t____________logger.error({description: 'Error initalizing hellojs.', error: err, func: 'login', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Error with third party login.'});\n\t\t\t});\n\t\t}\n\t\tsignup() {\n\t\t\t//Initalize Hello\n\t\t\t// if (!_.has(clientIds, this.provider)) {\n\t\t\t// \tlogger.error({description: `${this.provider} is not setup as a provider on Tessellate. Please visit tessellate.kyper.io to enter your provider information.`, provider: this.provider, clientIds: clientIds, func: 'login', obj: 'ProviderAuth'});\n\t\t\t// \treturn Promise.reject();\n\t\t\t// }\n\t\t\t//TODO: send info to server\n\t\t\treturn this.initHello().then(() => {\n\t\t\t\treturn window.hello.login(this.provider);\n\t\t\t}, (errRes) => {\n\t\t\t\t____________logger.error({description: 'Error signing up.', error: errRes, func: 'signup', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Error signing up.'});\n\t\t\t});\n\t\t}\n\t}\n\n\tclass Matter {\n\t\t/* Constructor\n\t\t * @param {string} appName Name of application\n\t\t */\n\t\tconstructor(appName, opts) {\n\t\t\tif (!appName) {\n\t\t\t\t____________logger.error({description: 'Application name requires to use Matter.', func: 'constructor', obj: 'Matter'});\n\t\t\t\tthrow new Error('Application name is required to use Matter');\n\t\t\t} else {\n\t\t\t\tthis.name = appName;\n\t\t\t}\n\t\t\tif (opts) {\n\t\t\t\tthis.options = opts;\n\t\t\t}\n\t\t}\n\t\t/* Endpoint getter\n\t\t *\n\t\t */\n\t\tget endpoint() {\n\t\t\tlet serverUrl = _config.serverUrl;\n\t\t\tif (_.has(this, 'options') && this.options.localServer) {\n\t\t\t\tserverUrl = 'http://localhost:4000';\n\t\t\t\t____________logger.info({description: 'LocalServer option was set to true. Now server url is local server.', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t}\n\t\t\tif (this.name == 'tessellate') {\n\t\t\t\t//Remove url if host is server\n\t\t\t\tif (typeof window !== 'undefined' && _.has(window, 'location') && window.location.host === serverUrl) {\n\t\t\t\t\tserverUrl = '';\n\t\t\t\t\t____________logger.info({description: 'Host is Server, serverUrl simplified!', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tserverUrl = serverUrl + '/apps/' + this.name;\n\t\t\t\t____________logger.log({description: 'Server url set.', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t}\n\t\t\treturn serverUrl;\n\t\t}\n\t\t/* Signup\n\t\t *\n\t\t */\n\t\tsignup(signupData) {\n\t\t\t____________logger.log({description: 'Signup called.', signupData: signupData, func: 'signup', obj: 'Matter'});\n\t\t\tif (!signupData || (!_.isObject(signupData) && !_.isString(signupData))) {\n\t\t\t\t____________logger.error({description: 'Signup information is required to signup.', func: 'signup', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Login data is required to login.'});\n\t\t\t}\n\t\t\tif (_.isObject(signupData)) {\n\t\t\t\treturn ___________request.post(this.endpoint + '/signup', signupData)\n\t\t\t\t.then((response) => {\n\t\t\t\t\t____________logger.log({description: 'Account request successful.', signupData: signupData, response: response, func: 'signup', obj: 'Matter'});\n\t\t\t\t\tif (_.has(response, 'account')) {\n\t\t\t\t\t\treturn response.account;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t____________logger.warn({description: 'Account was not contained in signup response.', signupData: signupData, response: response, func: 'signup', obj: 'Matter'});\n\t\t\t\t\t\treturn response;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t['catch']((errRes) => {\n\t\t\t\t\t____________logger.error({description: 'Error requesting signup.', signupData: signupData, error: errRes, func: 'signup', obj: 'Matter'});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//Handle 3rd Party signups\n\t\t\t\tlet auth = new ProviderAuth({provider: signupData, app: this});\n\t\t\t\treturn auth.signup(signupData).then((res) => {\n\t\t\t\t\t____________logger.info({description: 'Provider signup successful.', provider: signupData, res: res, func: 'signup', obj: 'Matter'});\n\t\t\t\t\treturn Promise.resolve(res);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t/** Login\n\t\t *\n\t\t */\n\t\tlogin(loginData) {\n\t\t\tif (!loginData || (!_.isObject(loginData) && !_.isString(loginData))) {\n\t\t\t\t____________logger.error({description: 'Username/Email and Password are required to login', func: 'login', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Login data is required to login.'});\n\t\t\t}\n\t\t\tif (_.isObject(loginData)) {\n\t\t\t\tif (!loginData.password || !loginData.username) {\n\t\t\t\t\treturn Promise.reject({message: 'Username/Email and Password are required to login'});\n\t\t\t\t}\n\t\t\t\t//Username/Email Login\n\t\t\t\treturn ___________request.put(this.endpoint + '/login', loginData)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tif (_.has(response, 'data') && _.has(response.data, 'status') && response.data.status == 409) {\n\t\t\t\t\t\t____________logger.warn({description: 'Account not found.', response: response, func: 'login', obj: 'Matter'});\n\t\t\t\t\t\treturn Promise.reject(response.data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t____________logger.log({description: 'Successful login.', response: response, func: 'login', obj: 'Matter'});\n\t\t\t\t\t\tif (_.has(response, 'token')) {\n\t\t\t\t\t\t\tthis.token.string = response.token;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (_.has(response, 'account')) {\n\t\t\t\t\t\t\tthis.storage.setItem(_config.tokenUserDataName, response.account);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn response.account;\n\t\t\t\t\t}\n\t\t\t\t})['catch']((errRes) => {\n\t\t\t\t\t____________logger.error({description: 'Error requesting login.', error: errRes, status: errRes.status,  func: 'login', obj: 'Matter'});\n\t\t\t\t\tif (errRes.status == 409 || errRes.status == 400) {\n\t\t\t\t\t\terrRes = errRes.response.text;\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//Provider login\n\t\t\t\tlet auth = new ProviderAuth({provider: loginData, app: this});\n\t\t\t\treturn auth.login().then((res) => {\n\t\t\t\t\t____________logger.info({description: 'Provider login successful.', provider: loginData, res: res, func: 'login', obj: 'Matter'});\n\t\t\t\t\treturn Promise.resolve(res);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t/** Logout\n\t\t */\n\t\tlogout() {\n\t\t\t//TODO: Handle logging out of providers\n\t\t\tif (!this.isLoggedIn) {\n\t\t\t\t____________logger.warn({description: 'No logged in account to log out.', func: 'logout', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'No logged in account to log out.'});\n\t\t\t}\n\t\t\treturn ___________request.put(this.endpoint + '/logout').then((response) => {\n\t\t\t\t____________logger.log({description: 'Logout successful.', response: response, func: 'logout', obj: 'Matter'});\n\t\t\t\tthis.currentUser = null;\n\t\t\t\tthis.token.delete();\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____________logger.error({description: 'Error requesting log out: ', error: errRes, func: 'logout', obj: 'Matter'});\n\t\t\t\tthis.storage.removeItem(_config.tokenUserDataName);\n\t\t\t\tthis.token.delete();\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\tgetCurrentUser() {\n\t\t\tif (this.currentUser) {\n\t\t\t\treturn Promise.resolve(this.currentUser);\n\t\t\t} else {\n\t\t\t\tif (this.isLoggedIn) {\n\t\t\t\t\treturn ___________request.get(this.endpoint + '/user').then((response) => {\n\t\t\t\t\t\t//TODO: Save user information locally\n\t\t\t\t\t\t____________logger.log({description: 'Current User Request responded.', responseData: response, func: 'currentUser', obj: 'Matter'});\n\t\t\t\t\t\tthis.currentUser = response;\n\t\t\t\t\t\treturn response;\n\t\t\t\t\t})['catch']((errRes) => {\n\t\t\t\t\t\tif (errRes.status == 401) {\n\t\t\t\t\t\t\t____________logger.warn({description: 'Called for current user without token.', error: errRes, func: 'currentUser', obj: 'Matter'});\n\t\t\t\t\t\t\ttoken.delete();\n\t\t\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t____________logger.error({description: 'Error requesting current user.', error: errRes, func: 'currentUser', obj: 'Matter'});\n\t\t\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/** updateProfile\n\t\t */\n\t\tupdateProfile(updateData) {\n\t\t\tif (!this.isLoggedIn) {\n\t\t\t\t____________logger.error({description: 'No current user profile to update.', func: 'updateProfile', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Must be logged in to update profile.'});\n\t\t\t}\n\t\t\t//Send update request\n\t\t\t____________logger.warn({description: 'Calling update endpoint.', endpoint: `${this.endpoint}/user/${this.token.data.username}` , func: 'updateProfile', obj: 'Matter'});\n\t\t\treturn ___________request.put(`${this.endpoint}/user/${this.token.data.username}` , updateData).then((response) => {\n\t\t\t\t____________logger.log({description: 'Update profile request responded.', responseData: response, func: 'updateProfile', obj: 'Matter'});\n\t\t\t\tthis.currentUser = response;\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____________logger.error({description: 'Error requesting current user.', error: errRes, func: 'updateProfile', obj: 'Matter'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\tchangePassword(updateData) {\n\t\t\tif (!this.isLoggedIn) {\n\t\t\t\t____________logger.error({description: 'No current user profile for which to change password.', func: 'changePassword', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Must be logged in to change password.'});\n\t\t\t}\n\t\t\t//Send update request\n\t\t\t____________logger.log({description: 'Calling update endpoint to change password.', endpoint: `${this.endpoint}/user/${this.token.data.username}` , func: 'changePassword', obj: 'Matter'});\n\t\t\treturn ___________request.put(`${this.endpoint}/user/${this.token.data.username}` , updateData).then((response) => {\n\t\t\t\t____________logger.log({description: 'Update password request responded.', responseData: response, func: 'changePassword', obj: 'Matter'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____________logger.error({description: 'Error requesting password change.', error: errRes, func: 'changePassword', obj: 'Matter'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\trecoverPassword() {\n\t\t\tif (!this.isLoggedIn) {\n\t\t\t\t____________logger.error({description: 'No current user for which to recover password.', func: 'recoverPassword', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Must be logged in to recover password.'});\n\t\t\t}\n\t\t\t//Send update request\n\t\t\t____________logger.log({description: 'Calling recover password endpoint.', endpoint: `${this.endpoint}/accounts/${this.token.data.username}/recover` , func: 'recoverPassword', obj: 'Matter'});\n\t\t\treturn ___________request.post(`${this.endpoint}/accounts/${this.token.data.username}/recover`).then((response) => {\n\t\t\t\t____________logger.log({description: 'Recover password request responded.', responseData: response, func: 'recoverPassword', obj: 'Matter'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____________logger.error({description: 'Error requesting password recovery.', error: errRes, func: 'recoverPassword', obj: 'Matter'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\n\t\t/* set currentUser\n\t\t * @description Sets currently user data\n\t\t */\n\t\tset currentUser(userData) {\n\t\t\t____________logger.log({description: 'Current User set.', user: userData, func: 'currentUser', obj: 'Matter'});\n\t\t\tthis.storage.setItem(_config.tokenUserDataName, userData);\n\t\t}\n\t\t/* get currentUser\n\t\t * @description Gets currently logged in user or returns null\n\t\t */\n\t\tget currentUser() {\n\t\t\tif (this.storage.getItem(_config.tokenUserDataName)) {\n\t\t\t\treturn this.storage.getItem(_config.tokenUserDataName);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t/* Storage\n\t\t *\n\t\t */\n\t\tget storage() {\n\t\t\treturn storage;\n\t\t}\n\t\t/** Token\n\t\t */\n\t\tget token() {\n\t\t\treturn token;\n\t\t}\n\t\tget utils() {\n\t\t\treturn {logger: ____________logger, request: ___________request, storage: storage, dom: domUtil};\n\t\t}\n\t\tget isLoggedIn() {\n\t\t\treturn this.token.string ? true : false;\n\t\t}\n\t\t//Check that user is in a single group or in all of a list of groups\n\t\tisInGroup(checkGroups) {\n\t\t\tif (!this.isLoggedIn) {\n\t\t\t\t____________logger.log({description: 'No logged in user to check.', func: 'isInGroup', obj: 'Matter'});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//Check if user is\n\t\t\tif (checkGroups && _.isString(checkGroups)) {\n\t\t\t\tlet groupName = checkGroups;\n\t\t\t\t//Single role or string list of roles\n\t\t\t\tlet groupsArray = groupName.split(',');\n\t\t\t\tif (groupsArray.length > 1) {\n\t\t\t\t\t//String list of groupts\n\t\t\t\t\t____________logger.info({description: 'String list of groups.', list: groupsArray, func: 'isInGroup', obj: 'Matter'});\n\t\t\t\t\treturn this.isInGroups(groupsArray);\n\t\t\t\t} else {\n\t\t\t\t\t//Single group\n\t\t\t\t\tlet groups = this.token.data.groups || [];\n\t\t\t\t\t____________logger.log({description: 'Checking if user is in group.', group: groupName, userGroups: this.token.data.groups || [],  func: 'isInGroup', obj: 'Matter'});\n\t\t\t\t\treturn _.any(groups, (group) =>  {\n\t\t\t\t\t\treturn groupName == group.name;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else if (checkGroups && _.isArray(checkGroups)) {\n\t\t\t\t//Array of roles\n\t\t\t\t//Check that user is in every group\n\t\t\t\t____________logger.info({description: 'Array of groups.', list: checkGroups, func: 'isInGroup', obj: 'Matter'});\n\t\t\t\treturn this.isInGroups(checkGroups);\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//TODO: Handle string and array inputs\n\t\t}\n\t\tisInGroups(checkGroups) {\n\t\t\tif (!this.isLoggedIn) {\n\t\t\t\t____________logger.log({description: 'No logged in user to check.', func: 'isInGroups', obj: 'Matter'});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//Check if user is in any of the provided groups\n\t\t\tif (checkGroups && _.isArray(checkGroups)) {\n\t\t\t\treturn _.every(_.map(checkGroups, (group) =>  {\n\t\t\t\t\tif (_.isString(group)) {\n\t\t\t\t\t\t//Group is string\n\t\t\t\t\t\treturn this.isInGroup(group);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Group is object\n\t\t\t\t\t\tif (_.has(group, 'name')) {\n\t\t\t\t\t\t\treturn this.isInGroup(group.name);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t____________logger.error({description: 'Invalid group object.', group: group, func: 'isInGroups', obj: 'Matter'});\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}), true);\n\t\t\t} else if (checkGroups && _.isString(checkGroups)) {\n\t\t\t\t//TODO: Handle spaces within string list\n\t\t\t\tlet groupsArray = checkGroups.split(',');\n\t\t\t\tif (groupsArray.length > 1) {\n\t\t\t\t\treturn this.isInGroups(groupsArray);\n\t\t\t\t}\n\t\t\t\treturn this.isInGroup(groupsArray[0]);\n\t\t\t} else {\n\t\t\t\t____________logger.error({description: 'Invalid groups list.', func: 'isInGroups', obj: 'Matter'});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\tlet config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'grout',\n\t\tfbUrl: 'https://kyper-tech.firebaseio.com/tessellate',\n\t\tappName: 'tessellate',\n\t\tmatterOptions: {\n\t\t\tlocalServer: false\n\t\t},\n\t\taws: {\n\t\t\tregion: 'us-east-1',\n\t\t\tcognito: {\n\t\t\t\tpoolId: 'us-east-1:72a20ffd-c638-48b0-b234-3312b3e64b2e',\n\t\t\t\tparams: {\n\t\t\t\t\tAuthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateUnauth_Role',\n\t\t\t\t\tUnauthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateAuth_Role'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tlet matter = new Matter(config.appName, config.matterOptions);\n\n\tlet __________request = matter.utils.request;\n\tlet ___________logger = matter.utils.logger;\n\n\t//Actions for specific directory\n\tclass Directory {\n\t\tconstructor(actionData) {\n\t\t\tif (actionData && _.isObject(actionData) && (_.has(actionData, 'directoryName') || _.has(actionData, 'name'))) { //Data is object containing directory data\n\t\t\t\tthis.name = actionData.directoryName || actionData.name;\n\t\t\t\tif (_.has(actionData, 'appName')) {\n\t\t\t\t\tthis.appName = actionData.appName;\n\t\t\t\t}\n\t\t\t} else if (actionData && _.isString(actionData)) { //Data is string name\n\t\t\t\tthis.name = actionData;\n\t\t\t} else {\n\t\t\t\t___________logger.error({description: 'Action data object with name is required to start a Directory Action.', func: 'constructor', obj: 'Directory'});\n\t\t\t\tthrow new Error('Directory Data object with name is required to start a Directory action.');\n\t\t\t}\n\t\t}\n\t\tget directoryEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'directories', this.name];\n\t\t\t//Check for app account action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t___________logger.log({description: 'Directory endpoint built.', endpoint: endpointStr, func: 'directoryEndpoint', obj: 'Directory'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get userlications or single userlication\n\t\tget() {\n\t\t\treturn __________request.get(this.directoryEndpoint).then((response) => {\n\t\t\t\t___________logger.info({description: 'Directory data loaded successfully.', directoryData: directoryData, response: response, func: 'get', obj: 'Directory'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t___________logger.info({description: 'Error getting directory.', directoryData: directoryData, error: errRes, func: 'get', obj: 'Directory'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update an Directory\n\t\tupdate(directoryData) {\n\t\t\t___________logger.debug({description: 'Directory updated called.', directoryData: directoryData, func: 'update', obj: 'Directory'});\n\t\t\treturn matter.utils.request.put(this.directoryEndpoint, directoryData).then((response) => {\n\t\t\t\t___________logger.info({description: 'Directory updated successfully.', directoryData: directoryData, response: response, func: 'update', obj: 'Directory'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t___________logger.error({description: 'Error updating directory.', directoryData: directoryData, error: errRes, func: 'update', obj: 'Directory'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete an Directory\n\t\tdel(directoryData) {\n\t\t\t___________logger.debug({description: 'Delete directory called.', directoryData: directoryData, func: 'del', obj: 'Directory'});\n\t\t\treturn __________request.delete(this.directoryEndpoint, userData).then((response) => {\n\t\t\t\t___________logger.info({description: 'Directory deleted successfully.', directoryData: directoryData, func: 'del', obj: 'Directory'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t___________logger.error({description: 'Error deleting directory.', directoryData: directoryData, error: errRes, func: 'del', obj: 'Directory'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet _________request = matter.utils.request;\n\tlet __________logger = matter.utils.logger;\n\n\t//Actions for directories list\n\tclass DirectoriesAction {\n\t\tconstructor(actionData) {\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t__________logger.log({description: 'Provided app data set to app parameter.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction'});\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = {name: actionData};\n\t\t\t\t__________logger.log({description: 'App name provided as string was set.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction'});\n\t\t\t}\n\t\t\t__________logger.info({description: 'New directories action.', action: this, providedData: actionData, func: 'constructor', obj: 'DirectoriesAction'});\n\t\t}\n\t\tget directoriesEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'directories'];\n\t\t\t//Check for app groups action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t__________logger.log({description: 'Directories endpoint built.', endpoint: endpointStr, func: 'directoriesEndpoint', obj: 'DirectoriesAction'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get users or single application\n\t\tget() {\n\t\t\t__________logger.debug({description: 'Directories get called.', action: this, func: 'get', obj: 'DirectoriesAction'});\n\t\t\treturn _________request.get(this.directoriesEndpoint).then((response) => {\n\t\t\t\t__________logger.info({descrption: 'Directories loaded successfully.', response: response, func: 'get', obj: 'DirectoriesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t__________logger.error({descrption: 'error getting users', error: errRes, func: 'get', obj: 'DirectoriesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\t__________logger.debug({description: 'Add directory called.', action: this, appData: appData, func: 'get', obj: 'DirectoriesAction'});\n\t\t\treturn _________request.post(this.directoriesEndpoint, appData).then((response) => {\n\t\t\t\t__________logger.log({description: 'Application added successfully.', response: response, func: 'add', obj: 'DirectoriesAction'});\n\t\t\t\t//TODO: Return list of group objects\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t__________logger.error({description: 'Error adding group.', error: errRes, func: 'add', obj: 'DirectoriesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Search with partial of directory name\n\t\tsearch(query) {\n\t\t\tvar searchEndpoint = this.directoriesEndpoint + '/search/';\n\t\t\tif (query && _.isString(query)) {\n\t\t\t\tsearchEndpoint += query;\n\t\t\t}\n\t\t\tif (!query || query == '') {\n\t\t\t\t__________logger.debug({description: 'Null query, returning empty array.', func: 'search', obj: 'DirectoriesAction'});\n\t\t\t\treturn Promise.resolve([]);\n\t\t\t}\n\t\t\treturn _________request.get(searchEndpoint).then((response) => {\n\t\t\t\t__________logger.log({description: 'Found directories based on search.', response: response, func: 'search', obj: 'DirectoriesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t__________logger.error({description: 'Error searching directories.', error: errRes, func: 'search', obj: 'DirectoriesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ________request = matter.utils.request;\n\tlet _________logger = matter.utils.logger;\n\n\t//Actions for specific user\n\tclass Group {\n\t\tconstructor(actionData) {\n\t\t\t//Call matter with name and settings\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'groupData')) { //Data is object containing group data\n\t\t\t\tthis.name = _.isObject(actionData.groupData) ? actionData.groupData.name : actionData.groupData;\n\t\t\t\tif (_.has(actionData, 'app')) {\n\t\t\t\t\tthis.app = actionData.app;\n\t\t\t\t}\n\t\t\t} else if (actionData && _.isString(actionData)) { //Data is string name\n\t\t\t\tthis.name = actionData;\n\t\t\t} else {\n\t\t\t\t_________logger.error({description: 'Action data is required to start a Group Action.', func: 'constructor', obj: 'Group'});\n\t\t\t\tthrow new Error('Username is required to start an Group');\n\t\t\t}\n\t\t}\n\t\tget groupEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'groups', this.name];\n\t\t\t//Check for app account action\n\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t_________logger.log({description: 'Group Endpoint built.', endpoint: endpointStr, func: 'groupEndpoint', obj: 'Group'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get userlications or single userlication\n\t\tget() {\n\t\t\treturn ________request.get(this.groupEndpoint).then((response) => {\n\t\t\t\t_________logger.info({description: 'Group data loaded successfully.', response: response, func: 'get', obj: 'Group'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_________logger.info({description: 'Error getting group.', error: errRes, func: 'get', obj: 'Group'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Update an Group\n\t\tupdate(groupData) {\n\t\t\t_________logger.log({description: 'Group updated called.', groupData: groupData, func: 'update', obj: 'Group'});\n\t\t\treturn matter.utils.request.put(this.groupEndpoint, groupData).then((response) => {\n\t\t\t\t_________logger.info({description: 'Group updated successfully.', groupData: groupData, response: response, func: 'update', obj: 'Group'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_________logger.error({description: 'Error updating group.', groupData: groupData, error: errRes, func: 'update', obj: 'Group'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Delete an Group\n\t\tdel(groupData) {\n\t\t\t_________logger.log({description: 'Delete group called.', groupData: groupData, func: 'del', obj: 'Group'});\n\t\t\treturn ________request.del(this.groupEndpoint, {}).then((response) => {\n\t\t\t\t_________logger.info({description: 'Group deleted successfully.', groupData: groupData, func: 'del', obj: 'Group'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_________logger.error({description: 'Error deleting group.', error: errRes, text: errRes.response.text, groupData: groupData,  func: 'del', obj: 'Group'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Update an Group\n\t\taddAccounts(accountsData) {\n\t\t\t_________logger.log({description: 'Group updated called.', accountsData: accountsData, func: 'update', obj: 'Group'});\n\t\t\tlet accountsArray = accountsData;\n\t\t\t//Handle provided data being a string list\n\t\t\tif (_.isString(accountsData)) {\n\t\t\t\taccountsArray = accountsData.split(',');\n\t\t\t}\n\t\t\t//Check item in array to see if it is a string (username) instead of _id\n\t\t\tif (_.isString(accountsArray[0])) {\n\t\t\t\t_________logger.error({description: 'Accounts array only currently supports account._id not account.username.', accountsData: accountsData, func: 'update', obj: 'Group'});\n\t\t\t\treturn Promise.reject({message: 'Accounts array only currently supports account._id not account.username.'});\n\t\t\t}\n\t\t\t_________logger.log({description: 'Updating group with accounts array.', accountsArray: accountsArray, func: 'update', obj: 'Group'});\n\t\t\treturn this.update({accounts: accountsArray}).then((response) => {\n\t\t\t\t_________logger.info({description: 'Account(s) added to group successfully.', response: response, func: 'addAccounts', obj: 'Group'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_________logger.error({description: 'Error addAccountseting group.', error: errRes,  func: 'addAccounts', obj: 'Group'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet _______request = matter.utils.request;\n\tlet ________logger = matter.utils.logger;\n\n\t//Actions for users list\n\tclass GroupsAction {\n\t\tconstructor(actionData) {\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t________logger.log({description: 'Provided app data set to app parameter.', action: this, providedData: actionData, func: 'constructor', obj: 'GroupsAction'});\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = {name: actionData};\n\t\t\t\t________logger.log({description: 'App name provided as string was set.', action: this, providedData: actionData, func: 'constructor', obj: 'GroupsAction'});\n\t\t\t}\n\t\t\t________logger.info({description: 'New Groups action.', action: this, providedData: actionData, func: 'constructor', obj: 'GroupsAction'});\n\t\t}\n\t\tget groupsEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'groups'];\n\t\t\t//Check for app groups action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t________logger.log({description: 'Groups Endpoint built.', endpoint: endpointStr, func: 'groupsEndpoint', obj: 'GroupsAction'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get users or single application\n\t\tget() {\n\t\t\t________logger.debug({description: 'Get group called.', func: 'get', obj: 'GroupsAction'});\n\t\t\treturn _______request.get(this.groupsEndpoint).then((response) => {\n\t\t\t\t________logger.info({description: 'Groups loaded successfully.', response: response, func: 'get', obj: 'GroupsAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t________logger.info({description: 'Error getting groups.', error: errRes, func: 'get', obj: 'GroupsAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(groupData) {\n\t\t\tvar newGroupData = groupData;\n\t\t\t________logger.debug({description: 'Add group called.', groupData: groupData, func: 'add', obj: 'GroupsAction'});\n\t\t\tif (_.isString(groupData)) {\n\t\t\t\t//Group data is string\n\t\t\t\tnewGroupData = {name: groupData};\n\t\t\t}\n\t\t\t________logger.debug({description: 'Add group called.', newGroupData: newGroupData, func: 'add', obj: 'GroupsAction'});\n\t\t\treturn _______request.post(this.groupsEndpoint, newGroupData).then((response) => {\n\t\t\t\t________logger.log({description: 'Group added to application successfully.', response: response, func: 'add', obj: 'GroupsAction'});\n\t\t\t\t//TODO: Return list of group objects\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t________logger.error({description: 'Error adding group.', error: errRes, func: 'add', obj: 'GroupsAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Search with partial of username\n\t\tsearch(query) {\n\t\t\t________logger.debug({description: 'Add group called.', groupData: groupData, func: 'search', obj: 'GroupsAction'});\n\t\t\tif (!query || query == '' || !_.isString(query)) {\n\t\t\t\t________logger.log({description: 'Null or invalid query, returning empty array.', func: 'search', obj: 'GroupsAction'});\n\t\t\t\treturn Promise.resolve([]);\n\t\t\t}\n\t\t\tlet searchEndpoint = `${this.groupsEndpoint}/search/${query}`;\n\t\t\t________logger.debug({description: 'Search endpoint created.', endpoint: searchEndpoint, func: 'search', obj: 'GroupsAction'});\n\t\t\treturn _______request.get(searchEndpoint).then((response) => {\n\t\t\t\t________logger.log({description: 'Found groups based on search.', response: response, func: 'search', obj: 'GroupsAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t________logger.error({description: 'Error searching groups.', error: errRes, func: 'search', obj: 'GroupsAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ______request = matter.utils.request;\n\tlet _______logger = matter.utils.logger;\n\n\t//Actions for specific user\n\tclass Account {\n\t\tconstructor(accountData) {\n\t\t\t//Call matter with name and settings\n\t\t\tif (accountData && _.isObject(accountData) && _.has(accountData, 'username')) {\n\t\t\t\t_.extend(this, accountData);\n\t\t\t} else if (accountData && _.isString(accountData)) {\n\t\t\t\tthis.username = accountData;\n\t\t\t} else {\n\t\t\t\t_______logger.error({description: 'AccountData is required to start an AccountAction', func: 'constructor', obj: 'Account'});\n\t\t\t\tthrow new Error('username is required to start an AccountAction');\n\t\t\t}\n\t\t}\n\t\t//Build endpoint based on accountData\n\t\tget accountEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'accounts', this.username];\n\t\t\t//Check for app account action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t_______logger.log({description: 'Account Endpoint built.', endpoint: endpointStr, func: 'accountEndpoint', obj: 'Account'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get a user\n\t\tget() {\n\t\t\t_______logger.debug({description: 'Account data loaded successfully.', func: 'get', obj: 'Account'});\n\t\t\treturn ______request.get(this.accountEndpoint).then((response) => {\n\t\t\t\t_______logger.info({description: 'Account data loaded successfully.', response: response, func: 'get', obj: 'Account'});\n\t\t\t\treturn new Account(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_______logger.error({description: 'Error getting user.', error: errRes, func: 'get', obj: 'Account'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update a Account\n\t\tupdate(accountData) {\n\t\t\t_______logger.debug({description: 'Update user called.', accountData: accountData, func: 'update', obj: 'Account'});\n\t\t\treturn ______request.put(this.accountEndpoint, accountData).then((response) => {\n\t\t\t\t_______logger.info({description: 'Account updated successfully.', func: 'update', obj: 'Account'});\n\t\t\t\t//TODO: Extend this with current info before returning\n\t\t\t\treturn new Account(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_______logger.error({description: 'Error updating user.', func: 'update', obj: 'Account'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete a Account\n\t\tdel(accountData) {\n\t\t\t_______logger.debug({description: 'Delete user called.', func: 'del', obj: 'Account'});\n\t\t\treturn ______request.del(this.accountEndpoint, accountData).then((response) => {\n\t\t\t\t_______logger.info({description: 'Delete user successful.', response: response, func: 'del', obj: 'Account'});\n\t\t\t\treturn new Account(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_______logger.error({description: 'Error deleting user.', accountData: accountData, error: errRes, func: 'del', obj: 'Account'});\n\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ______logger = matter.utils.logger;\n\t//Actions for accounts list\n\tclass AccountsAction {\n\t\tconstructor(actionData) {\n\t\t\t//Check to see if action is for a specific app\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'app')) {\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\t______logger.log({description: 'Provided app data set to app parameter.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction'});\n\t\t\t} else if (actionData && _.isString(actionData)) {\n\t\t\t\tthis.app = {name: actionData};\n\t\t\t\t______logger.log({description: 'App name provided as string was set.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction'});\n\t\t\t}\n\t\t\t______logger.info({description: 'New Accounts action.', action: this, providedData: actionData, func: 'constructor', obj: 'AccountsAction'});\n\t\t}\n\t\tget accountsEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'accounts'];\n\t\t\t//Check for app account action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t//Splice apps, appName into index 1\n\t\t\t\tendpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t______logger.log({description: 'Accounts Endpoint built.', endpoint: endpointStr, func: 'accountsEndpoint', obj: 'AccountsAction'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get accounts or single application\n\t\tget() {\n\t\t\t______logger.log({description: 'Accounts get called.', func: 'get', obj: 'AccountsAction'});\n\t\t\treturn matter.utils.request.get(this.accountsEndpoint).then((response) => {\n\t\t\t\t______logger.info({description: 'Accounts loaded successfully.', func: 'get', obj: 'AccountsAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t______logger.info({description: 'Error getting accounts.', error: errRes, func: 'get', obj: 'AccountsAction'});\n\t\t\t\treturn Promise.reject(errRes.message || 'Error getting accounts.');\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(accountData) {\n\t\t\t______logger.info({description: 'Account add called.', accountData: accountData, func: 'add', obj: 'AccountsAction'});\n\t\t\treturn this.utils.request.post(this.accountsEndpoint, accountData).then((response) => {\n\t\t\t\t______logger.info({description: 'Account added successfully.', response: response, newAccount: new Account(response), func: 'add', obj: 'AccountsAction'});\n\t\t\t\treturn new Account(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t______logger.error({description: 'Account add called.', error: errRes, accountData: accountData, func: 'add', obj: 'AccountsAction'});\n\t\t\t\treturn Promise.reject(errRes.message || 'Error adding account.');\n\t\t\t});\n\t\t}\n\t\t//Search with partial of accountname\n\t\tsearch(query) {\n\t\t\t______logger.log({description: 'Accounts search called.', query: query, func: 'search', obj: 'AccountsAction'});\n\t\t\tvar searchEndpoint = this.accountsEndpoint + '/search/';\n\t\t\tif (query && _.isString(query)) {\n\t\t\t\tsearchEndpoint += query;\n\t\t\t}\n\t\t\tif (!query || query == '') {\n\t\t\t\t______logger.log({description: 'Null query, returning empty array.', func: 'search', obj: 'AccountsAction'});\n\t\t\t\treturn Promise.resolve([]);\n\t\t\t}\n\t\t\treturn matter.utils.request.get(searchEndpoint).then((response) => {\n\t\t\t\t______logger.log({description: 'Accounts search responded.', response: response, query: query, func: 'search', obj: 'AccountsAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t______logger.error({description: 'Error searching Accounts.', error: errRes, query: query, func: 'search', obj: 'AccountsAction'});\n\t\t\t\treturn Promise.reject(errRes.message || 'Error searching accounts.');\n\t\t\t});\n\t\t}\n\t}\n\n\tlet _____request = matter.utils.request;\n\tlet _____logger = matter.utils.logger;\n\t//Actions for specific user\n\tclass Template {\n\t\tconstructor(templateData) {\n\t\t\t//Call matter with name and settings\n\t\t\tif (templateData && _.isString(templateData)) {\n\t\t\t\tthis.name = templateData;\n\t\t\t} else {\n\t\t\t\t_____logger.error({description: 'Template data is required to start a Template action.', func: 'construcotr', obj: ''});\n\t\t\t\tthrow new Error('Template data is required to start a Template action.');\n\t\t\t}\n\t\t}\n\t\tget templateEndpoint() {\n\t\t\treturn `${matter.endpoint}/templates/${this.name}`;\n\t\t}\n\t\t//Get userlications or single userlication\n\t\tget() {\n\t\t\t_____logger.log({description: 'Get template called.', name: this.name, func: 'get', obj: 'Template'});\n\t\t\treturn _____request.get(this.templateEndpoint).then((response) => {\n\t\t\t\t_____logger.log({description: 'Get template responded.', response: response, func: 'get', obj: 'Template'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_____logger.error({description: 'Error getting template.', error: errRes, func: 'get', obj: 'Template'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update an userlication\n\t\tupdate(templateData) {\n\t\t\t_____logger.log({description: 'Update template called.', templateData: templateData, func: 'update', obj: 'Template'});\n\t\t\treturn _____request.put(this.templateEndpoint, templateData).then((response) => {\n\t\t\t\t_____logger.log({description: 'Update template responded.', response: response, templateData: templateData, func: 'update', obj: 'Template'});\n\t\t\t\t//TODO: Return template object\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_____logger.error({description: 'Error updating template.', error: errRes, func: 'update', obj: 'Template'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete a template\n\t\tdel(templateData) {\n\t\t\t_____logger.log({description: 'Delete template called.', templateData: templateData, func: 'del', obj: 'Template'});\n\t\t\treturn _____request.delete(this.endpoint, templateData).then((response) => {\n\t\t\t\t_____logger.log({description: 'Template deleted successfully.', response: response, func: 'del', obj: 'Template'});\n\t\t\t\t//TODO: Return template object\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_____logger.error({description: 'Error deleting template.', error: errRes, func: 'del', obj: 'Template'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ____logger = matter.utils.logger;\n\tlet ____request = matter.utils.request;\n\n\t//Actions for templates list\n\tclass TemplatesAction {\n\t\tget templatesEndpoint() {\n\t\t\tlet endpointArray = [matter.endpoint, 'templates'];\n\t\t\t//Check for app groups action\n\t\t\tif (_.has(this, 'app') && _.has(this.app, 'name')) {\n\t\t\t\t// endpointArray.splice(1, 0, 'apps', this.app.name);\n\t\t\t\t____logger.log({description: 'Templates action is not currently supported for a specific application.', func: 'accountsEndpoint', obj: 'AccountsAction'});\n\t\t\t}\n\t\t\t//Create string from endpointArray\n\t\t\tlet endpointStr = endpointArray.join('/');\n\t\t\t____logger.log({description: 'Templates endpoint built.', endpoint: endpointStr, func: 'templatesEndpoint', obj: 'TemplatesAction'});\n\t\t\treturn endpointStr;\n\t\t}\n\t\t//Get templates or single application\n\t\tget() {\n\t\t\t____logger.log({description: 'Get template called.', func: 'get', obj: 'TemplatesAction'});\n\t\t\treturn ____request.get(this.templatesEndpoint).then((response) => {\n\t\t\t\t____logger.log({description: 'Templates loaded.', response: response, func: 'get', obj: 'TemplatesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____logger.error({description: 'Error getting templates.', error: errRes, func: 'get', obj: 'TemplatesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\t____logger.log({description: 'Add template called.', func: 'add', obj: 'TemplatesAction'});\n\t\t\treturn ____request.post(this.templatesEndpoint, appData).then((response) => {\n\t\t\t\t____logger.log({description: 'Templates added successfully.', func: 'add', obj: 'TemplatesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____logger.error({description: 'Error adding template.', error: errRes, func: 'add', obj: 'TemplatesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Search with partial of username\n\t\tsearch(query) {\n\t\t\t____logger.log({description: 'Search template called.', query: query, func: 'search', obj: 'TemplatesAction'});\n\t\t\tvar searchEndpoint = this.templatesEndpoint + '/search/';\n\t\t\tif (query && _.isString(query)) {\n\t\t\t\tsearchEndpoint += query;\n\t\t\t}\n\t\t\t____logger.log({description: 'Search endpoint created.', endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction'});\n\t\t\treturn ____request.get(searchEndpoint).then((response) => {\n\t\t\t\t____logger.log({description: 'Template(s) found successfully.', response: response, endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction'});\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t____logger.log({description: 'Error searching for templates.', query: query, error: errRes, endpoint: searchEndpoint, func: 'search', obj: 'TemplatesAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\tlet ___logger = matter.utils.logger;\n\n\tclass File {\n\t\tconstructor(actionData) {\n\t\t\tif (actionData && _.isObject(actionData) && _.has(actionData, 'fileData') && _.has(actionData, 'app')) {\n\t\t\t\t_.extend(this, actionData.fileData);\n\t\t\t\tthis.app = actionData.app;\n\t\t\t\tthis.pathArray = this.path.split('/');\n\t\t\t\t//Get name from data or from pathArray\n\t\t\t\tthis.name = _.has(actionData.fileData, 'name') ? actionData.fileData.name : this.pathArray[this.pathArray.length - 1];\n\t\t\t} else if (actionData && !_.isObject(actionData)) {\n\t\t\t\t___logger.error({description: 'File data is not an object. File data must be an object that includes path and appName.', func: 'constructor', obj: 'File'});\n\t\t\t\t//TODO: Get appName from path data?\n\t\t\t\tthrow new Error('File data must be an object that includes path and appName.');\n\t\t\t} else {\n\t\t\t\t___logger.error({description: 'File data that includes path and app is needed to create a File action.', func: 'constructor', obj: 'File'});\n\t\t\t\tthrow new Error('File data with path and app is needed to create file action.');\n\t\t\t}\n\t\t\tthis.type = 'file';\n\t\t\t___logger.debug({description: 'File object constructed.', file: this, func: 'constructor', obj: 'File'});\n\t\t}\n\t\tget ext() {\n\t\t\tlet re = /(?:\\.([^.]+))?$/;\n\t\t\tthis.ext = re.exec(this.name)[1];\n\t\t}\n\t\tget() {\n\t\t\tif (!this.app || !this.app.frontend) {\n\t\t\t\t___logger.log({description: 'Application Frontend data not available. Calling applicaiton get.', func: 'get', obj: 'File'});\n\t\t\t\treturn this.app.get().then((appData) => {\n\t\t\t\t\tthis.app = appData;\n\t\t\t\t\t___logger.log({description: 'Application get successful. Getting file.', app: appData, func: 'get', obj: 'File'});\n\t\t\t\t\treturn this.get();\n\t\t\t\t}, (err) => {\n\t\t\t\t\t___logger.error({description: 'Application Frontend data not available. Make sure to call .get().', error: err, func: 'get', obj: 'File'});\n\t\t\t\t\treturn Promise.reject({message: 'Front end data is required to get file.'});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet saveParams = {\n\t\t\t\t\tBucket: this.app.frontend.bucketName,\n\t\t\t\t\tKey: this.path\n\t\t\t\t};\n\t\t\t\t//Set contentType from actionData to ContentType parameter of new object\n\t\t\t\tif (this.contentType) {\n\t\t\t\t\tsaveParams.ContentType = this.contentType;\n\t\t\t\t}\n\t\t\t\t___logger.debug({description: 'File get params built.', saveParams: saveParams, fileData: fileData, func: 'get', obj: 'File'});\n\t\t\t\treturn s3.getObject(saveParams, function(err, data) {\n\t\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t___logger.error({description: 'File loaded successfully.', fileData: data, func: 'get', obj: 'File'});\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t}\telse {\n\t\t\t\t\t\t___logger.error({description: 'Error loading file from S3.', error: err, func: 'get', obj: 'File'});\n\t\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t//Alias for get\n\t\topen() {\n\t\t\treturn this.get();\n\t\t}\n\t\tpublish(fileData) {\n\t\t\t//TODO: Publish file to application\n\t\t\t___logger.debug({description: 'File publish called.', file: this, fileData: fileData, func: 'publish', obj: 'File'});\n\t\t\tif (!this.app.frontend) {\n\t\t\t\t___logger.error({description: 'Application Frontend data not available. Make sure to call .get().', func: 'publish', obj: 'File'});\n\t\t\t\treturn Promise.reject({message: 'Front end data is required to publish file.'});\n\t\t\t} else {\n\t\t\t\tif (!_.has(fileData, ['content', 'path'])) {\n\t\t\t\t\t___logger.error({description: 'File data including path and content required to publish.', func: 'publish', obj: 'File'});\n\t\t\t\t\treturn Promise.reject({message: 'File data including path and content required to publish.'});\n\t\t\t\t}\n\t\t\t\tlet saveParams = {\n\t\t\t\t\tBucket: this.app.frontend.bucketName,\n\t\t\t\t\tKey: fileData.path,\n\t\t\t\t\tBody: fileData.content,\n\t\t\t\t\tACL: 'public-read'\n\t\t\t\t};\n\t\t\t\t//Set contentType from fileData to ContentType parameter of new object\n\t\t\t\tif (fileData.contentType) {\n\t\t\t\t\tsaveParams.ContentType = fileData.contentType;\n\t\t\t\t}\n\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t___logger.debug({description: 'AWS creds do not exist, so they are being set.', func: 'publish', obj: 'File'});\n\t\t\t\t\t_setAWSConfig();\n\t\t\t\t}\n\t\t\t\t___logger.debug({description: 'File publish params built.', saveParams: saveParams, fileData: fileData, func: 'publish', obj: 'File'});\n\t\t\t\treturn s3.putObject(saveParams, function(err, data) {\n\t\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t___logger.error({description: 'File saved successfully.', fileData: data, func: 'publish', obj: 'File'});\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t}\telse {\n\t\t\t\t\t\t___logger.error({description: 'Error saving file to S3.', error: err, func: 'publish', obj: 'File'});\n\t\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tgetTypes() {\n\t\t\t//Get content type and file type from extension\n\t\t}\n\t\topenWithFirepad(divId) {\n\t\t\t//TODO:Create new Firepad instance within div\n\t\t}\n\t\tgetDefaultContent() {\n\t\t\t//TODO: Fill with default data for matching file type\n\t\t}\n\t}\n\t//------------------ Utility Functions ------------------//\n\n\t// AWS Config\n\tfunction _setAWSConfig() {\n\t\tAWS.config.update({\n\t\t  credentials: new AWS.CognitoIdentityCredentials({\n\t\t  IdentityPoolId: config.aws.cognito.poolId\n\t\t  }),\n\t\t  region: config.aws.region\n\t\t});\n\t}\n\n\tlet __logger = matter.utils.logger;\n\n\tclass Files {\n\t\tconstructor(filesData) {\n\t\t\tif (filesData && _.isObject(filesData) && _.has(filesData, 'app')) { //Data is object containing directory data\n\t\t\t\tthis.app = filesData.app;\n\t\t\t} else if (filesData && _.isString(filesData)) { //Data is string name\n\t\t\t\tthis.app = {name: filesData};\n\t\t\t} else if (filesData && _.isArray(filesData)) {\n\t\t\t\t//TODO: Handle an array of files being passed as data\n\t\t\t\t__logger.error({description: 'Action data object with name is required to start a Files Action.', func: 'constructor', obj: 'Files'});\n\t\t\t\tthrow new Error('Files Data object with application is required to start a Files action.');\n\t\t\t} else {\n\t\t\t\t__logger.error({description: 'Action data object with name is required to start a Files Action.', func: 'constructor', obj: 'Files'});\n\t\t\t\tthrow new Error('Files Data object with name is required to start a Files action.');\n\t\t\t}\n\t\t\t__logger.debug({description: 'Files object constructed.', func: 'constructor', obj: 'Files'});\n\t\t}\n\t\tpublish() {\n\t\t\t//TODO: Publish all files\n\t\t}\n\t\tget() {\n\t\t\tif (!this.app.frontend || !this.app.frontend.bucketName) {\n\t\t\t\t__logger.warn({description: 'Application Frontend data not available. Calling .get().', app: this.app, func: 'get', obj: 'Files'});\n\t\t\t\treturn this.app.get().then((applicationData) => {\n\t\t\t\t\t__logger.log({description: 'Application get returned.', data: applicationData, func: 'get', obj: 'Files'});\n\t\t\t\t\tthis.app = applicationData;\n\t\t\t\t\tif (_.has(applicationData, 'frontend')) {\n\t\t\t\t\t\treturn this.get();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t__logger.error({description: 'Application does not have Frontend to get files from.', func: 'get', obj: 'Files'});\n\t\t\t\t\t\treturn Promise.reject({message: 'Application does not have frontend to get files from.'});\n\t\t\t\t\t}\n\t\t\t\t}, (err) => {\n\t\t\t\t\t__logger.error({description: 'Application Frontend data not available. Make sure to call .get().', func: 'get', obj: 'Files'});\n\t\t\t\t\treturn Promise.reject({message: 'Bucket name required to get objects'});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t// logger.info('AWS creds are being updated to make request');\n\t\t\t\t\tsetAWSConfig();\n\t\t\t\t}\n\t\t\t\tlet s3 = new AWS.S3();\n\t\t\t\tlet listParams = {Bucket: this.app.frontend.bucketName};\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\ts3.listObjects(listParams, function(err, data) {\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t__logger.info({description: 'Files list loaded.', filesData: data, func: 'get', obj: 'Files'});\n\t\t\t\t\t\t\treturn resolve(data.Contents);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t__logger.error({description: 'Error getting files from S3.', error: err, func: 'get', obj: 'Files'});\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tadd(fileData) {\n\t\t\t//TODO: Add a file to files list\n\t\t}\n\t\tdel() {\n\t\t\t//TODO: Delete a file from files list\n\t\t}\n\t\tbuildStructure() {\n\t\t\t__logger.debug({description: 'Build Structure called.', func: 'buildStructure', obj: 'Application'});\n\t\t\treturn this.get().then((filesArray) => {\n\t\t\t\tconst childStruct = childrenStructureFromArray(filesArray);\n\t\t\t\t__logger.log({description: 'Child struct from array.', childStructure: childStruct, func: 'buildStructure', obj: 'Application'});\n\t\t\t\treturn childStruct;\n\t\t\t}, (err) => {\n\t\t\t\t__logger.error({description: 'Error getting application files.', error: err, func: 'buildStructure', obj: 'Application'});\n\t\t\t\treturn Promise.reject({message: 'Error getting files.', error: err});\n\t\t\t});\n\t\t}\n\t\t//ALIAS FOR buildStructure\n\t\t// get structure() {\n\t\t// \treturn this.buildStructure();\n\t\t// }\n\t}\n\t//------------------ Utility Functions ------------------//\n\n\t// AWS Config\n\tfunction setAWSConfig() {\n\t\tAWS.config.update({\n\t\t  credentials: new AWS.CognitoIdentityCredentials({\n\t\t  IdentityPoolId: config.aws.cognito.poolId\n\t\t  }),\n\t\t  region: config.aws.region\n\t\t});\n\t}\n\t//Convert from array file structure (from S3) to 'children' structure used in Editor GUI (angular-tree-control)\n\t//Examples for two files (index.html and /testFolder/file.js):\n\t//Array structure: [{path:'index.html'}, {path:'testFolder/file.js'}]\n\t//Children Structure [{type:'folder', name:'testfolder', children:[{path:'testFolder/file.js', name:'file.js', filetype:'javascript', contentType:'application/javascript'}]}]\n\tfunction childrenStructureFromArray(fileArray) {\n\t\t// logger.log('childStructureFromArray called:', fileArray);\n\t\t//Create a object for each file that stores the file in the correct 'children' level\n\t\tvar mappedStructure = fileArray.map(function(file) {\n\t\t\treturn buildStructureObject(file);\n\t\t});\n\t\treturn combineLikeObjs(mappedStructure);\n\t}\n\t//Convert file with key into a folder/file children object\n\tfunction buildStructureObject(file) {\n\t\tvar pathArray;\n\t\t// console.log('buildStructureObject with:', file);\n\t\tif (_.has(file, 'path')) {\n\t\t\t//Coming from files already having path (structure)\n\t\t\tpathArray = file.path.split('/');\n\t\t} else {\n\t\t\t//Coming from aws\n\t\t\tpathArray = file.Key.split('/');\n\t\t\t// console.log('file before pick:', file);\n\t\t\tfile = _.pick(file, 'Key');\n\t\t\tfile.path = file.Key;\n\t\t\tfile.name = file.Key;\n\t\t}\n\t\tvar currentObj = file;\n\t\tif (pathArray.length == 1) {\n\t\t\tcurrentObj.name = pathArray[0];\n\t\t\tif (!_.has(currentObj,'type')) {\n\t\t\t\tcurrentObj.type = 'file';\n\t\t\t}\n\t\t\tcurrentObj.path = pathArray[0];\n\t\t\treturn currentObj;\n\t\t} else {\n\t\t\tvar finalObj = {};\n\t\t\t_.each(pathArray, (loc, ind, list) => {\n\t\t\t\tif (ind != list.length - 1) {//Not the last loc\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = _.take(list, ind + 1).join('/');\n\t\t\t\t\tcurrentObj.type = 'folder';\n\t\t\t\t\tcurrentObj.children = [{}];\n\t\t\t\t\t//TODO: Find out why this works\n\t\t\t\t\tif (ind == 0) {\n\t\t\t\t\t\tfinalObj = currentObj;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentObj = currentObj.children[0];\n\t\t\t\t} else {\n\t\t\t\t\tcurrentObj.type = 'file';\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = pathArray.join('/');\n\t\t\t\t\tif (file.$id) {\n\t\t\t\t\t\tcurrentObj.$id = file.$id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn finalObj;\n\t\t}\n\t}\n\t//Recursivley combine children of object's that have the same names\n\tfunction combineLikeObjs(mappedArray) {\n\t\tvar takenNames = [];\n\t\tvar finishedArray = [];\n\t\t_.each(mappedArray, (obj, ind, list) => {\n\t\t\tif (takenNames.indexOf(obj.name) == -1) {\n\t\t\t\ttakenNames.push(obj.name);\n\t\t\t\tfinishedArray.push(obj);\n\t\t\t} else {\n\t\t\t\tvar likeObj = _.findWhere(mappedArray, {name: obj.name});\n\t\t\t\t//Combine children of like objects\n\t\t\t\tlikeObj.children = _.union(obj.children, likeObj.children);\n\t\t\t\tlikeObj.children = combineLikeObjs(likeObj.children);\n\t\t\t\t// logger.log('extended obj:',likeObj);\n\t\t\t}\n\t\t});\n\t\treturn finishedArray;\n\t}\n\n\t//Convenience vars\n\tlet _request = matter.utils.request;\n\tlet _logger = matter.utils.logger;\n\n\t/**\n\t * Application class.\n\t *\n\t */\n\tclass Application {\n\t\tconstructor(appData) {\n\t\t\t//Setup application data based on input\n\t\t\tif (appData && _.isObject(appData)) {\n\t\t\t\t_.extend(this, appData);\n\t\t\t} else if (appData && _.isString(appData)) {\n\t\t\t\tthis.name = appData;\n\t\t\t}\n\t\t\tif (Firebase && _.has(config, 'fbUrl') && _.has(this, 'name')) {\n\t\t\t\tthis.fbRef = new Firebase(config.fbUrl + this.name);\n\t\t\t}\n\t\t\t// logger.debug({description: 'Application object created.', application: this, func: 'constructor', obj: 'Application'});\n\t\t}\n\t\tget appEndpoint() {\n\t\t\treturn `${matter.endpoint}/apps/${this.name}`;\n\t\t}\n\t\t//Get applications or single application\n\t\tget() {\n\t\t\t_logger.debug({description: 'Application get called.', func: 'get', obj: 'Application'});\n\t\t\treturn _request.get(this.appEndpoint).then((response) => {\n\t\t\t\t_logger.info({description: 'Application loaded successfully.', response: response, application: new Application(response), func: 'get', obj: 'Application'});\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_logger.error({description: 'Error getting Application.', message: errRes.response.text ,error: errRes, func: 'get', obj: 'Application'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Update an application\n\t\tupdate(appData) {\n\t\t\t_logger.debug({description: 'Application update called.', func: 'update', obj: 'Application'});\n\t\t\treturn _request.put(this.appEndpoint, appData).then((response) => {\n\t\t\t\t_logger.info({description: 'Application updated successfully.', response: response, func: 'update', obj: 'Application'});\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_logger.error({description: 'Error updating application.', error: errRes, func: 'update', obj: 'Application'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\n\t\taddStorage() {\n\t\t\t_logger.debug({description: 'Application add storage called.', application: this, func: 'addStorage', obj: 'Application'});\n\t\t\treturn _request.post(`${this.appEndpoint}/storage`, appData).then((response) => {\n\t\t\t\t_logger.info({description: 'Storage successfully added to application.', response: response, application: new Application(response), func: 'addStorage', obj: 'Application'});\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_logger.error({description: 'Error adding storage to application.', error: errRes, func: 'addStorage', obj: 'Application'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\tapplyTemplate() {\n\t\t\t_logger.error({description: 'Applying templates to existing applications is not currently supported.', func: 'applyTemplate', obj: 'Application'});\n\t\t\treturn _request.post(this.appEndpoint, appData).then((response) => {\n\t\t\t\t_logger.info({description: 'Template successfully applied to application.', response: response, application: this, func: 'applyTemplate', obj: 'Application'});\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\t_logger.error({description: 'Error applying template to application.', error: errRes, application: this, func: 'applyTemplate', obj: 'Application'});\n\t\t\t\treturn Promise.reject(errRes.response.text || errRes.response);\n\t\t\t});\n\t\t}\n\t\t//Files object that contains files methods\n\t\tget Files() {\n\t\t\t_logger.debug({description: 'Applications files action called.', application: this, func: 'files', obj: 'Application'});\n\t\t\treturn new Files({app: this});\n\t\t}\n\t\tFile(fileData) {\n\t\t\t_logger.debug({description: 'Applications file action called.', fileData: fileData, application: this, func: 'file', obj: 'Application'});\n\t\t\treturn new File({app: this, fileData: fileData});\n\t\t}\n\t\tget Users() {\n\t\t\t_logger.debug({description: 'Applications users action called.', application: this, func: 'user', obj: 'Application'});\n\t\t\treturn new AccountsAction({app: this});\n\t\t}\n\t\tUser(userData) {\n\t\t\t_logger.debug({description: 'Applications user action called.', userData: userData, application: this, func: 'user', obj: 'Application'});\n\t\t\treturn new Account({app: this, userData: userData});\n\t\t}\n\t\tget Accounts() {\n\t\t\t_logger.debug({description: 'Applications account action called.', application: this, func: 'user', obj: 'Application'});\n\t\t\treturn new AccountsAction({app: this});\n\t\t}\n\t\tAccount(userData) {\n\t\t\t_logger.debug({description: 'Applications account action called.', userData: userData, application: this, func: 'user', obj: 'Application'});\n\t\t\treturn new Account({app: this, userData: userData});\n\t\t}\n\t\tget Groups() {\n\t\t\t_logger.debug({description: 'Applications groups action called.', application: this, func: 'groups', obj: 'Application'});\n\t\t\treturn new GroupsAction({app: this});\n\t\t}\n\t\tGroup(groupData) {\n\t\t\t_logger.debug({description: 'Applications group action called.', groupData: groupData, application: this, func: 'group', obj: 'Application'});\n\t\t\treturn new Group({app: this, groupData: groupData});\n\t\t}\n\t\tget Directories() {\n\t\t\t_logger.debug({description: 'Applications directories action called.', application: this, func: 'directories', obj: 'Application'});\n\t\t\treturn new DirectoriesAction({app: this});\n\t\t}\n\t\tDirectory(directoryData) {\n\t\t\t_logger.debug({description: 'Applications directory action called.', directoryData: directoryData, application: this, func: 'directory', obj: 'Application'});\n\t\t\treturn new Directory({app: this, directoryData: directoryData});\n\t\t}\n\t}\n\n\tlet request = matter.utils.request;\n\tlet logger = matter.utils.logger;\n\n\t//Actions for applications list\n\tclass AppsAction {\n\t\tconstructor() {\n\t\t\t//Call matter with name and settings\n\t\t}\n\t\tget appsEndpoint() {\n\t\t\treturn `${matter.endpoint}/apps`;\n\t\t}\n\t\t//Get applications or single application\n\t\tget() {\n\t\t\tlogger.debug({description: 'Apps get called.', action: this, func: 'get', obj: 'AppsAction'});\n\t\t\treturn request.get(this.appsEndpoint).then((response) => {\n\t\t\t\tlogger.info({description: 'Apps data loaded successfully.', response: response, func: 'get', obj: 'AppsAction'});\n\t\t\t\t//TODO: Return application object\n\t\t\t\t// return new Application(response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error getting apps data.', error: errRes, func: 'get', obj: 'AppsAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\tlogger.debug({description: 'Application add called.', appData: appData, func: 'add', obj: 'AppsAction'});\n\t\t\treturn matter.utils.request.post(this.appsEndpoint, appData).then((response) => {\n\t\t\t\tlogger.info({description: 'Application added successfully.', response: response, func: 'add', obj: 'AppsAction'});\n\t\t\t\t// TODO: Return application object\n\t\t\t\t// return new Application(response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error adding app.', error: errRes, func: 'add', obj: 'AppsAction'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**Grout Client Class\n\t * @ description Extending matter provides token storage and login/logout/signup capabilities\n\t */\n\tclass Grout extends Matter {\n\t\t//TODO: Use getter/setter to make this not a function\n\t\tconstructor() {\n\t\t\t//Call matter with tessellate\n\t\t\tsuper(config.appName, config.matterOptions);\n\t\t}\n\t\t//Start a new Apps Action\n\t\tget Apps() {\n\t\t\tthis.utils.logger.debug({description: 'Apps Action called.', action: new AppsAction(), func: 'Apps', obj: 'Grout'});\n\t\t\treturn new AppsAction();\n\t\t}\n\t\t//Start a new App action\n\t\tApp(appName) {\n\t\t\tthis.utils.logger.debug({description: 'Application action called.', appName: appName, template: new Application(appName), func: 'App', obj: 'Grout'});\n\t\t\treturn new Application(appName);\n\t\t}\n\t\t//Start a new Apps Action\n\t\tget Templates() {\n\t\t\tthis.utils.logger.debug({description: 'Templates Action called.', action: new TemplatesAction(), func: 'Templates', obj: 'Grout'});\n\t\t\treturn new TemplatesAction();\n\t\t}\n\t\t//Start a new App action\n\t\tTemplate(templateData) {\n\t\t\tthis.utils.logger.debug({description: 'Template Action called.', templateData: templateData, template: new Template(templateData), func: 'Template', obj: 'Grout'});\n\t\t\treturn new Template(templateData);\n\t\t}\n\t\t//Start a new Accounts action\n\t\tget Accounts() {\n\t\t\tthis.utils.logger.debug({description: 'Account Action called.', action: new AccountsAction(), func: 'users', obj: 'Grout'});\n\t\t\treturn new AccountsAction();\n\t\t}\n\t\t//Start a new Account action\n\t\tAccount(userData) {\n\t\t\tthis.utils.logger.debug({description: 'Account Action called.', userData: userData, user: new Account(userData), func: 'user', obj: 'Grout'});\n\t\t\treturn new Account(userData);\n\t\t}\n\t\t//ALIAS OF ACCOUNTS\n\t\t//Start a new Accounts action\n\t\tget Users() {\n\t\t\tthis.utils.logger.debug({description: 'Accounts Action called.', action: new AccountsAction(), func: 'Users', obj: 'Grout'});\n\t\t\treturn new AccountsAction();\n\t\t}\n\t\t//ALIAS OF ACCOUNT\n\t\t//Start a new Account action\n\t\tUser(userData) {\n\t\t\tthis.utils.logger.debug({description: 'Account Action called.', userData: userData, user: new Account(userData), func: 'user', obj: 'Grout'});\n\t\t\treturn new Account(userData);\n\t\t}\n\t\t//Start a new Groups action\n\t\tget Groups() {\n\t\t\tthis.utils.logger.debug({description: 'Groups Action called.', action: new GroupsAction(), func: 'groups', obj: 'Grout'});\n\t\t\treturn new GroupsAction();\n\t\t}\n\t\t//Start a new Group action\n\t\tGroup(groupData) {\n\t\t\tthis.utils.logger.debug({description: 'Group Action called.', groupData: groupData, action: new Group({app: this, groupData: groupData}), func: 'group', obj: 'Grout'});\n\t\t\treturn new Group(groupData);\n\t\t}\n\t\t//Start a new Directories action\n\t\tget Directories() {\n\t\t\tthis.utils.logger.debug({description: 'Directories Action called.', action: new DirectoriesAction(), func: 'directories', obj: 'Grout'});\n\t\t\treturn new DirectoriesAction();\n\t\t}\n\t\t//Start a new Group action\n\t\tDirectory(directoryData) {\n\t\t\tthis.utils.logger.debug({description: 'Directory Action called.', directoryData: directoryData, action: new Directory(directoryData), func: 'directory', obj: 'Grout'});\n\t\t\treturn new Directory(directoryData);\n\t\t}\n\n\t};\n\n\treturn Grout;\n\n}));"],"sourceRoot":"/source/"}