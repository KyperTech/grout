{"version":3,"sources":["grout.min.js","/source/grout.js"],"names":["_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_classCallCheck","instance","Constructor","_get","_x","_x2","_x3","_again","object","property","receiver","desc","parent","getter","undefined","Function","getOwnPropertyDescriptor","get","call","getPrototypeOf","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","global","factory","exports","module","require","define","amd","Grout","_","jwtDecode","superagent","Firebase","this","buildMessageArgs","logData","msgStr","msgObj","isObject","has","obj","func","file","each","omit","keys","ind","list","isString","msg","decodeToken","tokenStr","tokenData","err","logger","error","description","data","Error","_handleResponse","req","Promise","resolve","reject","end","res","status","warn","body","_addAuthHeader","token","string","set","info","message","handleResponse","console","addAuthHeader","storage","getItem","config","tokenName","log","setAWSConfig","AWS","update","credentials","CognitoIdentityCredentials","IdentityPoolId","aws","cognito","poolId","region","childrenStructureFromArray","fileArray","mappedStructure","map","buildStructureObject","combineLikeObjs","pathArray","path","split","Key","pick","name","currentObj","type","finalObj","loc","first","join","children","$id","mappedArray","takenNames","finishedArray","indexOf","push","likeObj","findWhere","union","_config","serverUrl","tokenDataName","msgArgs","envName","apply","debug","_storage","item","itemName","itemValue","setItem","localExists","window","sessionStorage","removeItem","clear","testKey","save","delete","_request","endpoint","queryData","query","post","send","put","del","Matter","appName","opts","options","signupData","then","response","account","errRes","loginData","_this","password","username","text","_this2","localServer","url","location","host","_this3","resove","responseData","currentUser","fbUrl","params","AuthRoleArn","UnauthRoleArn","request","_Application","appData","owner","collaborators","createdAt","updatedAt","frontend","backend","fbRef","getFiles","filesArray","childStruct","bucketName","s3","S3","listParams","Bucket","listObjects","Contents","fileData","saveParams","frontent","Body","content","ACL","contentType","ContentType","putObject","AppAction","app","getStructure","structure","AppsAction","Application","User","userData","UserAction","userName","UsersAction","userEndpoint","searchEndpoint","_Matter"],"mappings":"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","file":"grout.min.js","sourcesContent":["function _inherits(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}var _get=function(e,t,n){for(var r=!0;r;){var o=e,i=t,s=n;a=u=c=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if(\"value\"in a)return a.value;var c=a.get;return void 0===c?void 0:c.call(s)}var u=Object.getPrototypeOf(o);if(null===u)return void 0;e=u,t=i,n=s,r=!0}},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t(require(\"lodash\"),require(\"jwt-decode\"),require(\"superagent\"),require(\"firebase\")):\"function\"==typeof define&&define.amd?define([\"lodash\",\"jwt-decode\",\"superagent\",\"firebase\"],t):e.Grout=t(e._,e.jwtDecode,e.superagent,e.Firebase)}(this,function(e,t,n,r){\"use strict\";function o(t){var n=\"\",r={};e.isObject(t)?(e.has(t,\"func\")&&(n+=e.has(t,\"obj\")?\"[\"+t.obj+\".\"+t.func+\"()] \":e.has(t,\"file\")?\"[\"+t.file+\" > \"+t.func+\"()] \":\"[\"+t.func+\"()] \"),e.each(e.omit(e.keys(t)),function(o,i,s){\"func\"!=o&&\"obj\"!=o&&(\"description\"==o||\"message\"==o?n+=t[o]:e.isString(t[o])?r[o]=t[o]:r[o]=t[o])}),n+=\"\\n\"):e.isString(t)&&(n=t);var o=[n,r];return o}function i(e){var n=void 0;if(e&&\"\"!=e)try{n=t(e)}catch(r){throw h.error({description:\"Error decoding token.\",data:n,error:r,func:\"decodeToken\",file:\"token\"}),new Error(\"Invalid token string.\")}return n}function s(e){return new Promise(function(t,n){e.end(function(e,r){return e?(401==e.status&&h.warn(\"Unauthorized. You must be signed into make this request.\"),n(e)):t(r.body)})})}function a(e){return k.string&&(e=e.set(\"Authorization\",\"Bearer \"+k.string),h.info({message:\"Set auth header\",func:\"addAuthHeader\",file:\"request\"})),e}function c(e){return new Promise(function(t,n){e.end(function(e,r){return e?(401==e.status&&console.warn(\"Unauthorized. You must be signed into make this request.\"),n(e)):t(r.body)})})}function u(e){return j.getItem(w.tokenName)&&(e=e.set(\"Authorization\",\"Bearer \"+j.getItem(w.tokenName)),console.log(\"Set auth header\")),e}function l(){AWS.config.update({credentials:new AWS.CognitoIdentityCredentials({IdentityPoolId:w.aws.cognito.poolId}),region:w.aws.region})}function p(e){var t=e.map(function(e){return f(e)});return d(t)}function f(t){var n;e.has(t,\"path\")?n=t.path.split(\"/\"):(n=t.Key.split(\"/\"),t=e.pick(t,\"Key\"),t.path=t.Key,t.name=t.Key);var r=t;if(1==n.length)return r.name=n[0],e.has(r,\"type\")||(r.type=\"file\"),r.path=n[0],r;var o={};return e.each(n,function(i,s,a){s!=a.length-1?(r.name=i,r.path=e.first(a,s+1).join(\"/\"),r.type=\"folder\",r.children=[{}],0==s&&(o=r),r=r.children[0]):(r.type=\"file\",r.name=i,r.path=n.join(\"/\"),t.$id&&(r.$id=t.$id))}),o}function d(t){var n=[],r=[];return e.each(t,function(o,i,s){if(-1==n.indexOf(o.name))n.push(o.name),r.push(o);else{var a=e.findWhere(t,{name:o.name});a.children=e.union(o.children,a.children),a.children=d(a.children)}}),r}e=\"default\"in e?e[\"default\"]:e,t=\"default\"in t?t[\"default\"]:t,n=\"default\"in n?n[\"default\"]:n,r=\"default\"in r?r[\"default\"]:r;var g={serverUrl:\"http://tessellate.elasticbeanstalk.com\",tokenName:\"tessellate\",tokenDataName:\"tessellate-tokenData\"},h={log:function(e){var t=o(e);\"local\"==g.envName?console.log(e):console.log.apply(console,t)},info:function(e){var t=o(e);\"local\"==g.envName?console.info(e):console.info.apply(console,t)},warn:function(e){var t=o(e);\"local\"==g.envName?console.warn(e):console.warn.apply(console,t)},debug:function(e){var t=o(e);\"local\"==g.envName?console.log(e):console.log.apply(console,t)},error:function(e){var t=o(e);\"local\"==g.envName?console.error(e):console.error.apply(console,t)}},m={},v=Object.defineProperties({item:function(e,t){return this.setItem(e,t)},setItem:function(e,t){m[e]=t,this.localExists&&window.sessionStorage.setItem(e,t)},getItem:function(e){return m[e]?m[e]:this.localExists?window.sessionStorage.getItem(e):null},removeItem:function(e){if(m[e]&&(m[e]=null),this.localExists)try{window.sessionStorage.removeItem(e)}catch(t){h.error({description:\"Error removing item from session storage\",error:t,obj:\"storage\",func:\"removeItem\"})}},clear:function(){if(m={},this.localExists)try{window.sessionStorage.clear()}catch(e){h.warn(\"Session storage could not be cleared.\",e)}}},{localExists:{get:function(){var e=\"test\";if(\"undefined\"==typeof window||\"undefined\"==typeof window.sessionStorage)return!1;try{return window.sessionStorage.setItem(e,\"1\"),window.sessionStorage.removeItem(e),!0}catch(t){return h.error({description:\"Error saving to session storage\",error:t,obj:\"storage\",func:\"localExists\"}),!1}},configurable:!0,enumerable:!0}}),k=Object.defineProperties({save:function(e){this.string=e},\"delete\":function(){v.removeItem(g.tokenName),h.log({description:\"Token was removed.\",func:\"delete\",obj:\"token\"})}},{string:{get:function(){return v.getItem(g.tokenName)},set:function(e){h.log({description:\"Token was set.\",token:e,func:\"string\",obj:\"token\"}),this.data=t(e),v.setItem(g.tokenName,e)},configurable:!0,enumerable:!0},data:{get:function(){return v.getItem(g.tokenDataName)?v.getItem(g.tokenDataName):i(this.string)},set:function(t){if(e.isString(t)){var n=t;t=i(n),h.info({description:\"Token data was set as string. Decoding token.\",token:n,tokenData:t,func:\"data\",obj:\"token\"})}else h.log({description:\"Token data was set.\",data:t,func:\"data\",obj:\"token\"}),v.setItem(g.tokenDataName,t)},configurable:!0,enumerable:!0}}),y={get:function(e,t){var r=n.get(e);return t&&r.query(t),r=a(r),s(r)},post:function(e,t){var r=n.post(e).send(t);return r=a(r),s(r)},put:function(e,t){var r=n.put(e).send(t);return r=a(r),s(r)},del:function(e,t){var r=n.put(e).send(t);return r=a(r),s(r)}},b=function(){function t(e,n){if(_classCallCheck(this,t),!e)throw h.error({description:\"Application name requires to use Matter.\",func:\"constructor\",obj:\"Matter\"}),new Error(\"Application name is required to use Matter\");this.name=e,n&&(this.options=n)}return _createClass(t,[{key:\"signup\",value:function(t){return y.post(this.endpoint+\"/signup\",t).then(function(n){return h.log({description:\"Account request successful.\",signupData:t,response:n,func:\"signup\",obj:\"Matter\"}),e.has(n,\"account\")?n.account:(h.warn({description:\"Account was not contained in signup response.\",signupData:t,response:n,func:\"signup\",obj:\"Matter\"}),n)})[\"catch\"](function(e){return h.error({description:\"Error requesting signup.\",signupData:t,error:e,func:\"signup\",obj:\"Matter\"}),Promise.reject(e)})}},{key:\"login\",value:function(t){var n=this;return t&&t.password&&t.username?y.put(this.endpoint+\"/login\",t).then(function(t){return e.has(t,\"data\")&&e.has(t.data,\"status\")&&409==t.data.status?(h.warn({description:\"Account not found.\",response:t,func:\"login\",obj:\"Matter\"}),Promise.reject(t.data)):(h.log({description:\"Successful login.\",response:t,func:\"login\",obj:\"Matter\"}),e.has(t,\"token\")&&(n.token.string=t.token),e.has(t,\"account\")&&n.storage.setItem(\"currentUser\"),t.account)})[\"catch\"](function(e){return h.error({description:\"Error requesting login.\",error:e,status:e.status,func:\"login\",obj:\"Matter\"}),(409==e.status||400==e.status)&&(e=e.response.text),Promise.reject(e)}):(h.error({description:\"Username/Email and Password are required to login\",func:\"login\",obj:\"Matter\"}),Promise.reject({message:\"Username/Email and Password are required to login\"}))}},{key:\"logout\",value:function(){var e=this;return y.put(this.endpoint+\"/logout\").then(function(t){return h.log({description:\"Logout successful.\",response:t,func:\"logout\",obj:\"Matter\"}),e.storage.removeItem(\"currentUser\"),e.token[\"delete\"](),t})[\"catch\"](function(t){return h.error({description:\"Error requesting log out: \",error:t,func:\"logout\",obj:\"Matter\"}),e.storage.removeItem(\"currentUser\"),e.token[\"delete\"](),Promise.reject(t)})}},{key:\"endpoint\",get:function(){var t=g.serverUrl;return e.has(this,\"options\")&&this.options.localServer&&(t=\"http://localhost:4000\",h.info({description:\"LocalServer option was set to true. Now server url is local server.\",url:t,func:\"endpoint\",obj:\"Matter\"})),\"tessellate\"==this.name?window&&e.has(window,\"location\")&&window.location.host==t&&(t=\"\",h.info({description:\"Host is Server, serverUrl simplified!\",url:t,func:\"endpoint\",obj:\"Matter\"})):(t=g.serverUrl+\"/apps/\"+this.name,h.info({description:\"Server url set.\",url:t,func:\"endpoint\",obj:\"Matter\"})),t}},{key:\"currentUser\",get:function(){var e=this;return this.storage.item(\"currentUser\")?Promise.resove(this.storage.item(\"currentUser\")):y.get(this.endpoint+\"/user\").then(function(t){return h.log({description:\"Current User Request responded.\",responseData:t.data,func:\"currentUser\",obj:\"Matter\"}),e.currentUser=t.data,t.data})[\"catch\"](function(e){return h.error({description:\"Error requesting current user.\",error:e,func:\"currentUser\",obj:\"Matter\"}),Promise.reject(e)})}},{key:\"storage\",get:function(){return v}},{key:\"token\",get:function(){return k}},{key:\"isLoggedIn\",get:function(){return this.token.string?!0:!1}}]),t}(),w={serverUrl:\"http://tessellate.elasticbeanstalk.com\",tokenName:\"grout\",fbUrl:\"https://pruvit.firebaseio.com/\",aws:{region:\"us-east-1\",cognito:{poolId:\"us-east-1:72a20ffd-c638-48b0-b234-3312b3e64b2e\",params:{AuthRoleArn:\"arn:aws:iam::823322155619:role/Cognito_TessellateUnauth_Role\",UnauthRoleArn:\"arn:aws:iam::823322155619:role/Cognito_TessellateAuth_Role\"}}}},j=new b(\"tesselate\").storage,A={get:function(e,t){var r=n.get(e);return t&&r.query(t),r=u(r),c(r)},post:function(e,t){var r=n.post(e).send(t);return r=u(r),c(r)},put:function(e,t){var r=n.put(e).send(t);return r=u(r),c(r)},del:function(e,t){var r=n.put(e).send(t);return r=u(r),c(r)}},C=function(){function e(t){_classCallCheck(this,e),this.name=t.name,this.owner=t.owner||null,this.collaborators=t.collaborators||[],this.createdAt=t.createdAt,this.updatedAt=t.updatedAt,this.frontend=t.frontend||{},this.backend=t.backend||{},r&&(this.fbRef=new r(w.fbUrl+t.name))}return _createClass(e,[{key:\"getStructure\",value:function(){return this.getFiles().then(function(e){var t=p(e);return console.log(\"Child struct from array:\",t),t},function(e){return console.error(\"[Application.getStructure] Error getting files: \",e),Promise.reject({message:\"Error getting files.\",error:e})})}},{key:\"getFiles\",value:function(){if(this.frontend&&this.frontend.bucketName){\"undefined\"!=typeof AWS.config.credentials&&AWS.config.credentials||l();var e=new AWS.S3,t={Bucket:this.frontend.bucketName};return new Promise(function(n,r){e.listObjects(t,function(e,t){return e?(console.error(\"[Application.getObjects()] Error listing objects:\",e),r(e)):(console.log(\"[Application.getObjects()] listObjects returned:\",t),n(t.Contents))})})}return console.error(\"[Applicaiton.getFiles] Attempting to get objects for bucket without name.\"),Promise.reject({message:\"Bucket name required to get objects\"})}},{key:\"publishFile\",value:function(e){if(!this.frontend)return console.error(\"Frontend data not available. Make sure to call .get().\"),Promise.reject({message:\"Front end data is required to publish file.\"});var t={Bucket:this.frontent.bucketName,Key:e.key,Body:e.content,ACL:\"public-read\"};return e.contentType&&(t.ContentType=e.contentType),s3.putObject(t,function(e,t){return e?(console.error(\"[Application.publishFile()] Error saving file:\",e),Promise.reject(e)):(console.log(\"[Application.publishFile()] file saved successfully. Returning:\",t),t)})}},{key:\"addStorage\",value:function(){var t=w.serverUrl+\"/apps/\"+this.name+\"/storage\";return A.post(t,appData).then(function(t){return console.log(\"[Application.addStorage()] Apps:\",t),new e(t)})[\"catch\"](function(e){return console.error(\"[Application.addStorage()] Error getting apps list: \",e),Promise.reject(e)})}},{key:\"applyTemplate\",value:function(){w.serverUrl+\"/apps/\"+this.name+\"/template\";console.log(\"Applying templates to existing\")}}]),e}(),M=function(){function e(t){if(_classCallCheck(this,e),!t)throw console.error(\"Application name is required to start an AppAction\"),new Error(\"Application name is required to start an AppAction\");this.name=t,this.endpoint=w.serverUrl+\"/apps/\"+this.name}return _createClass(e,[{key:\"get\",value:function(){return A.get(this.endpoint).then(function(e){return console.log(\"[MatterClient.app().get()] App(s) data loaded:\",e),new C(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.app().get()] Error getting apps list: \",e),Promise.reject(e)})}},{key:\"update\",value:function(e){return A.put(this.endpoint,e).then(function(e){return console.log(\"[MatterClient.apps().update()] App:\",e),new C(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.apps().update()] Error updating app: \",e),Promise.reject(e)})}},{key:\"del\",value:function(e){return A[\"delete\"](this.endpoint,e).then(function(e){return console.log(\"[MatterClient.apps().del()] Apps:\",e),new C(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.apps().del()] Error deleting app: \",e),Promise.reject(e)})}},{key:\"getFiles\",value:function(){return this.get().then(function(e){e.getFiles().then(function(e){return e})[\"catch\"](function(e){return console.error(\"[MatterClient.app().getFiles()] Error getting application files: \",e),Promise.reject(e)})})[\"catch\"](function(e){return console.error(\"[MatterClient.app().getFiles()] Error getting application: \",e),Promise.reject(e)})}},{key:\"getStructure\",value:function(){return this.get().then(function(e){return e.getStructure().then(function(e){return console.log(\"Structure loaded: \",e),e})[\"catch\"](function(e){return console.error(\"[MatterClient.app().getStructure()] Error getting application structure: \",e),Promise.reject(e)})})[\"catch\"](function(e){return console.error(\"[MatterClient.app().getStructure()] Error getting application: \",e),Promise.reject(e)})}}]),e}(),E=function(){function e(){_classCallCheck(this,e),this.endpoint=w.serverUrl+\"/apps\"}return _createClass(e,[{key:\"get\",value:function(){return A.get(this.endpoint).then(function(e){return console.log(\"[MatterClient.apps().get()] App(s) data loaded:\",e),e})[\"catch\"](function(e){return console.error(\"[MatterClient.apps().get()] Error getting apps list: \",e),Promise.reject(e)})}},{key:\"add\",value:function(e){return A.post(this.endpoint,e).then(function(e){return console.log(\"[MatterClient.apps().add()] Application added successfully: \",e),new Application(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.getApps()] Error adding application: \",e),Promise.reject(e)})}}]),e}(),P=function(){function e(t){_classCallCheck(this,e),this.name=t.name,this.username=t.username,this.createdAt=t.createdAt,this.updatedAt=t.updatedAt}return _createClass(e,[{key:\"app\",value:function(e){return new M(e)}},{key:\"apps\",get:function(){return new E}}]),e}(),S=function(){function e(t){if(_classCallCheck(this,e),!t)throw console.error(\"Username is required to start an UserAction\"),new Error(\"Username is required to start an UserAction\");this.name=t,this.endpoint=w.serverUrl+\"/users/\"+this.name}return _createClass(e,[{key:\"get\",value:function(){return A.get(this.endpoint).then(function(e){return console.log(\"[MatterClient.user().get()] App(s) data loaded:\",e),new P(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.user().get()] Error getting users list: \",e),Promise.reject(e)})}},{key:\"update\",value:function(e){return A.put(this.endpoint,e).then(function(e){return console.log(\"[MatterClient.users().update()] App:\",e),new P(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.users().update()] Error updating user: \",e),Promise.reject(e)})}},{key:\"del\",value:function(e){console.error(\"Deleting a user is currently disabled.\")}}]),e}(),U=function(){function t(){_classCallCheck(this,t),this.endpoint=w.serverUrl+\"/users\"}return _createClass(t,[{key:\"get\",value:function(t){var n=this.endpoint;if(t&&!e.isString(t)){var r=\"Get only handles username as a string\";return console.error(r),Promise.reject({message:r})}return t&&(n=n+\"/\"+t),A.get(n).then(function(e){return console.log(\"[MatterClient.apps().get()] App(s) data loaded:\",e),e})[\"catch\"](function(e){return console.error(\"[MatterClient.apps().get()] Error getting apps list: \",e),Promise.reject(e)})}},{key:\"add\",value:function(e){return A.post(this.endpoint,e).then(function(e){return console.log(\"[MatterClient.apps().add()] Application added successfully: \",e),new Application(e)})[\"catch\"](function(e){return console.error(\"[MatterClient.getApps()] Error adding application: \",e),Promise.reject(e)})}},{key:\"search\",value:function(t){console.log(\"search called:\",t);var n=this.endpoint+\"/search/\";return t&&e.isString(t)&&(n+=t),console.log(\"searchEndpoint:\",n),A.get(n).then(function(e){return console.log(\"[MatterClient.users().search()] Users(s) data loaded:\",e),e})[\"catch\"](function(e){return console.error(\"[MatterClient.users().search()] Error getting apps list: \",e),Promise.reject(e)})}}]),t}(),_=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),\"constructor\",this).call(this,\"tessellate\",{localServer:!0})}return _inherits(t,e),_createClass(t,[{key:\"app\",value:function(e){return console.log(\"New AppAction:\",new M(e)),new M(e)}},{key:\"user\",value:function(e){return new S(e)}},{key:\"apps\",get:function(){return console.log(\"New AppsAction:\",new E),new E}},{key:\"users\",get:function(){return new U}}]),t}(b);return _});\n//# sourceMappingURL=grout.min.js.map","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('lodash'), require('jwt-decode'), require('superagent'), require('firebase')) :\n\ttypeof define === 'function' && define.amd ? define(['lodash', 'jwt-decode', 'superagent', 'firebase'], factory) :\n\tglobal.Grout = factory(global._,global.jwtDecode,global.superagent,global.Firebase);\n}(this, function (_,jwtDecode,superagent,Firebase) { 'use strict';\n\n\t_ = 'default' in _ ? _['default'] : _;\n\tjwtDecode = 'default' in jwtDecode ? jwtDecode['default'] : jwtDecode;\n\tsuperagent = 'default' in superagent ? superagent['default'] : superagent;\n\tFirebase = 'default' in Firebase ? Firebase['default'] : Firebase;\n\n\tlet _config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'tessellate',\n\t\ttokenDataName: 'tessellate-tokenData'\n\t};\n\n\tlet logger = {\n\t\tlog(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'local') {\n\t\t\t\tconsole.log(logData);\n\t\t\t} else {\n\t\t\t\tconsole.log.apply(console, msgArgs);\n\t\t\t}\n\t\t},\n\t\tinfo(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'local') {\n\t\t\t\tconsole.info(logData);\n\t\t\t} else {\n\t\t\t\tconsole.info.apply(console, msgArgs);\n\t\t\t}\n\t\t},\n\t\twarn(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'local') {\n\t\t\t\tconsole.warn(logData);\n\t\t\t} else {\n\t\t\t\tconsole.warn.apply(console, msgArgs);\n\t\t\t}\n\t\t},\n\t\tdebug(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'local') {\n\t\t\t\tconsole.log(logData);\n\t\t\t} else {\n\t\t\t\tconsole.log.apply(console, msgArgs);\n\t\t\t}\n\t\t},\n\t\terror(logData) {\n\t\t\tlet msgArgs = buildMessageArgs(logData);\n\t\t\tif (_config.envName == 'local') {\n\t\t\t\tconsole.error(logData);\n\t\t\t} else {\n\t\t\t\tconsole.error.apply(console, msgArgs);\n\t\t\t\t//TODO: Log to external logger\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction buildMessageArgs(logData) {\n\t\tvar msgStr = '';\n\t\tvar msgObj = {};\n\t\t//TODO: Attach time stamp\n\t\tif (_.isObject(logData)) {\n\t\t\tif (_.has(logData, 'func')) {\n\t\t\t\tif (_.has(logData, 'obj')) {\n\t\t\t\t\tmsgStr += '[' + logData.obj + '.' + logData.func + '()] ';\n\t\t\t\t} else if (_.has(logData, 'file')) {\n\t\t\t\t\tmsgStr += '[' + logData.file + ' > ' + logData.func + '()] ';\n\t\t\t\t} else {\n\t\t\t\t\tmsgStr += '[' + logData.func + '()] ';\n\t\t\t\t}\n\t\t\t}\n\t\t\t//Print each key and its value other than obj and func\n\t\t\t_.each(_.omit(_.keys(logData)), function(key, ind, list) {\n\t\t\t\tif (key != 'func' && key != 'obj') {\n\t\t\t\t\tif (key == 'description' || key == 'message') {\n\t\t\t\t\t\tmsgStr += logData[key];\n\t\t\t\t\t} else if (_.isString(logData[key])) {\n\t\t\t\t\t\t// msgStr += key + ': ' + logData[key] + ', ';\n\t\t\t\t\t\tmsgObj[key] = logData[key];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Print objects differently\n\t\t\t\t\t\t// msgStr += key + ': ' + logData[key] + ', ';\n\t\t\t\t\t\tmsgObj[key] = logData[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tmsgStr += '\\n';\n\t\t} else if (_.isString(logData)) {\n\t\t\tmsgStr = logData;\n\t\t}\n\t\tvar msg = [msgStr, msgObj];\n\n\t\treturn msg;\n\t}\n\n\tlet data = {};\n\t// TODO: Store objects within local storage.\n\tlet _storage = {\n\t\tget localExists() {\n\t\t\tconst testKey = 'test';\n\t\t\tif (typeof window != 'undefined' && typeof window.sessionStorage != 'undefined') {\n\t\t\t\ttry {\n\t\t\t\t\twindow.sessionStorage.setItem(testKey, '1');\n\t\t\t\t\twindow.sessionStorage.removeItem(testKey);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tlogger.error({description: 'Error saving to session storage', error: err,  obj: 'storage', func: 'localExists'});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage.\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t */\n\t\titem(itemName, itemValue) {\n\t\t\t//TODO: Handle itemValue being an object instead of a string\n\t\t\treturn this.setItem(itemName, itemValue);\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley sets item to session storage. Alias: item()\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t * @param {String} itemValue The items value\n\t\t *\n\t\t */\n\t\tsetItem(itemName, itemValue) {\n\t\t\t//TODO: Handle itemValue being an object instead of a string\n\t\t\t// this.item(itemName) = itemValue;\n\t\t\tdata[itemName] = itemValue;\n\t\t\tif (this.localExists) {\n\t\t\t\twindow.sessionStorage.setItem(itemName, itemValue);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @description\n\t\t * Safley gets an item from session storage. Alias: item()\n\t\t *\n\t\t * @param {String} itemName The items name\n\t\t *\n\t\t * @return {String}\n\t\t *\n\t\t */\n\t\tgetItem(itemName) {\n\t\t\tif (data[itemName]) {\n\t\t\t\treturn data[itemName];\n\t\t\t} else if (this.localExists) {\n\t\t\t\treturn window.sessionStorage.getItem(itemName);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName - The items name\n\t\t *\n\t\t */\n\t\tremoveItem(itemName) {\n\t\t\t//TODO: Only remove used items\n\t\t\tif (data[itemName]) {\n\t\t\t\tdata[itemName] = null;\n\t\t\t}\n\t\t\tif (this.localExists) {\n\t\t\t\ttry {\n\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.removeItem(itemName);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tlogger.error({description: 'Error removing item from session storage', error: err,  obj: 'storage', func: 'removeItem'});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @description\n\t\t * Safley removes item from session storage.\n\t\t *\n\t\t * @param {String} itemName the items name\n\t\t * @param {String} itemValue the items value\n\t\t *\n\t\t */\n\t\tclear() {\n\t\t\t//TODO: Only remove used items\n\t\t\tdata = {};\n\t\t\tif (this.localExists) {\n\t\t\t\ttry {\n\t\t\t\t\t\t//Clear session storage\n\t\t\t\t\twindow.sessionStorage.clear();\n\t\t\t\t} catch (err) {\n\t\t\t\t\tlogger.warn('Session storage could not be cleared.', err);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n\tfunction decodeToken(tokenStr) {\n\t\tlet tokenData;\n\t\tif (tokenStr && tokenStr != '') {\n\t\t\ttry {\n\t\t\t\ttokenData = jwtDecode(tokenStr);\n\t\t\t} catch (err) {\n\t\t\t\tlogger.error({description: 'Error decoding token.', data: tokenData, error: err, func: 'decodeToken', file: 'token'});\n\t\t\t\tthrow new Error('Invalid token string.');\n\t\t\t}\n\t\t}\n\t\treturn tokenData;\n\t}\n\tlet token = {\n\t\tget string() {\n\t\t\treturn _storage.getItem(_config.tokenName);\n\t\t},\n\t\tget data() {\n\t\t\tif (_storage.getItem(_config.tokenDataName)) {\n\t\t\t\treturn _storage.getItem(_config.tokenDataName);\n\t\t\t} else {\n\t\t\t\treturn decodeToken(this.string);\n\t\t\t}\n\t\t},\n\t\tset data(tokenData) {\n\t\t\tif (_.isString(tokenData)) {\n\t\t\t\tlet tokenStr = tokenData;\n\t\t\t\ttokenData = decodeToken(tokenStr);\n\t\t\t\tlogger.info({description: 'Token data was set as string. Decoding token.', token: tokenStr, tokenData: tokenData, func: 'data', obj: 'token'});\n\t\t\t} else {\n\t\t\t\tlogger.log({description: 'Token data was set.', data: tokenData, func: 'data', obj: 'token'});\n\t\t\t\t_storage.setItem(_config.tokenDataName, tokenData);\n\t\t\t}\n\t\t},\n\t\tset string(tokenStr) {\n\t\t\tlogger.log({description: 'Token was set.', token: tokenStr, func: 'string', obj: 'token'});\n\t\t\tthis.data = jwtDecode(tokenStr);\n\t\t\t_storage.setItem(_config.tokenName, tokenStr);\n\t\t},\n\t\tsave(tokenStr) {\n\t\t\tthis.string = tokenStr;\n\t\t},\n\t\tdelete() {\n\t\t\t_storage.removeItem(_config.tokenName);\n\t\t\tlogger.log({description: 'Token was removed.', func: 'delete', obj: 'token'});\n\t\t}\n\t};\n\n\tlet _request = {\n\t\tget(endpoint, queryData) {\n\t\t\tvar req = superagent.get(endpoint);\n\t\t\tif (queryData) {\n\t\t\t\treq.query(queryData);\n\t\t\t}\n\t\t\treq = _addAuthHeader(req);\n\t\t\treturn _handleResponse(req);\n\t\t},\n\t\tpost(endpoint, data) {\n\t\t\tvar req = superagent.post(endpoint).send(data);\n\t\t\treq = _addAuthHeader(req);\n\t\t\treturn _handleResponse(req);\n\t\t},\n\t\tput(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = _addAuthHeader(req);\n\t\t\treturn _handleResponse(req);\n\t\t},\n\t\tdel(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = _addAuthHeader(req);\n\t\t\treturn _handleResponse(req);\n\t\t}\n\t};\n\n\tfunction _handleResponse(req) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treq.end((err, res) => {\n\t\t\t\tif (!err) {\n\t\t\t\t\t// logger.log({description: 'Response:', response:res, func:'handleResponse', file: 'request'});\n\t\t\t\t\treturn resolve(res.body);\n\t\t\t\t} else {\n\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\tlogger.warn('Unauthorized. You must be signed into make this request.');\n\t\t\t\t\t}\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tfunction _addAuthHeader(req) {\n\t\tif (token.string) {\n\t\t\treq = req.set('Authorization', 'Bearer ' + token.string);\n\t\t\tlogger.info({message: 'Set auth header', func: 'addAuthHeader', file: 'request'});\n\t\t}\n\t\treturn req;\n\t}\n\n\tclass Matter {\n\t\t/* Constructor\n\t\t * @param {string} appName Name of application\n\t\t */\n\t\tconstructor(appName, opts) {\n\t\t\tif (!appName) {\n\t\t\t\tlogger.error({description: 'Application name requires to use Matter.', func: 'constructor', obj: 'Matter'});\n\t\t\t\tthrow new Error('Application name is required to use Matter');\n\t\t\t} else {\n\t\t\t\tthis.name = appName;\n\t\t\t}\n\t\t\tif (opts) {\n\t\t\t\tthis.options = opts;\n\t\t\t}\n\t\t}\n\t\t/* Endpoint getter\n\t\t *\n\t\t */\n\t\tget endpoint() {\n\t\t\tlet serverUrl = _config.serverUrl;\n\t\t\tif (_.has(this, 'options') && this.options.localServer) {\n\t\t\t\tserverUrl = 'http://localhost:4000';\n\t\t\t\tlogger.info({description: 'LocalServer option was set to true. Now server url is local server.', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t}\n\t\t\tif (this.name == 'tessellate') {\n\t\t\t\t//Remove url if host is server\n\t\t\t\tif (window && _.has(window, 'location') && window.location.host == serverUrl) {\n\t\t\t\t\tserverUrl = '';\n\t\t\t\t\tlogger.info({description: 'Host is Server, serverUrl simplified!', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tserverUrl = _config.serverUrl + '/apps/' + this.name;\n\t\t\t\tlogger.info({description: 'Server url set.', url: serverUrl, func: 'endpoint', obj: 'Matter'});\n\t\t\t}\n\t\t\treturn serverUrl;\n\t\t}\n\t\t/* Signup\n\t\t *\n\t\t */\n\t\tsignup(signupData) {\n\t\t\treturn _request.post(this.endpoint + '/signup', signupData)\n\t\t\t.then((response) => {\n\t\t\t\tlogger.log({description: 'Account request successful.', signupData: signupData, response: response, func: 'signup', obj: 'Matter'});\n\t\t\t\tif (_.has(response, 'account')) {\n\t\t\t\t\treturn response.account;\n\t\t\t\t} else {\n\t\t\t\t\tlogger.warn({description: 'Account was not contained in signup response.', signupData: signupData, response: response, func: 'signup', obj: 'Matter'});\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t})\n\t\t\t['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error requesting signup.', signupData: signupData, error: errRes, func: 'signup', obj: 'Matter'});\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Login\n\t\t *\n\t\t */\n\t\tlogin(loginData) {\n\t\t\tif (!loginData || !loginData.password || !loginData.username) {\n\t\t\t\tlogger.error({description: 'Username/Email and Password are required to login', func: 'login', obj: 'Matter'});\n\t\t\t\treturn Promise.reject({message: 'Username/Email and Password are required to login'});\n\t\t\t}\n\t\t\treturn _request.put(this.endpoint + '/login', loginData)\n\t\t\t.then((response) => {\n\t\t\t\tif (_.has(response, 'data') && _.has(response.data, 'status') && response.data.status == 409) {\n\t\t\t\t\tlogger.warn({description: 'Account not found.', response: response, func: 'login', obj: 'Matter'});\n\t\t\t\t\treturn Promise.reject(response.data);\n\t\t\t\t} else {\n\t\t\t\t\tlogger.log({description: 'Successful login.', response: response, func: 'login', obj: 'Matter'});\n\t\t\t\t\tif (_.has(response, 'token')) {\n\t\t\t\t\t\tthis.token.string = response.token;\n\t\t\t\t\t}\n\t\t\t\t\tif (_.has(response, 'account')) {\n\t\t\t\t\t\tthis.storage.setItem('currentUser');\n\t\t\t\t\t}\n\t\t\t\t\treturn response.account;\n\t\t\t\t}\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error requesting login.', error: errRes, status: errRes.status,  func: 'login', obj: 'Matter'});\n\t\t\t\tif (errRes.status == 409 || errRes.status == 400) {\n\t\t\t\t\terrRes = errRes.response.text;\n\t\t\t\t}\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t/** Logout\n\t\t */\n\t\tlogout() {\n\t\t\treturn _request.put(this.endpoint + '/logout').then((response) => {\n\t\t\t\tlogger.log({description: 'Logout successful.', response: response, func: 'logout', obj: 'Matter'});\n\t\t\t\tthis.storage.removeItem('currentUser');\n\t\t\t\tthis.token.delete();\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tlogger.error({description: 'Error requesting log out: ', error: errRes, func: 'logout', obj: 'Matter'});\n\t\t\t\tthis.storage.removeItem('currentUser');\n\t\t\t\tthis.token.delete();\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\tget currentUser() {\n\t\t\tif (this.storage.item('currentUser')) {\n\t\t\t\t//TODO: Check to see if this comes back as a string\n\t\t\t\treturn Promise.resove(this.storage.item('currentUser'));\n\t\t\t} else {\n\t\t\t\treturn _request.get(this.endpoint + '/user').then((response) => {\n\t\t\t\t\t//TODO: Save user information locally\n\t\t\t\t\tlogger.log({description: 'Current User Request responded.', responseData: response.data, func: 'currentUser', obj: 'Matter'});\n\t\t\t\t\tthis.currentUser = response.data;\n\t\t\t\t\treturn response.data;\n\t\t\t\t})['catch']((errRes) => {\n\t\t\t\t\tlogger.error({description: 'Error requesting current user.', error: errRes, func: 'currentUser', obj: 'Matter'});\n\t\t\t\t\treturn Promise.reject(errRes);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tget storage() {\n\t\t\treturn _storage;\n\t\t}\n\t\tget token() {\n\t\t\treturn token;\n\t\t}\n\t\tget isLoggedIn() {\n\t\t\treturn this.token.string ? true : false;\n\t\t}\n\t}\n\n\tlet config = {\n\t\tserverUrl: 'http://tessellate.elasticbeanstalk.com',\n\t\ttokenName: 'grout',\n\t\tfbUrl: 'https://pruvit.firebaseio.com/',\n\t\taws: {\n\t\t\tregion: 'us-east-1',\n\t\t\tcognito: {\n\t\t\t\tpoolId: 'us-east-1:72a20ffd-c638-48b0-b234-3312b3e64b2e',\n\t\t\t\tparams: {\n\t\t\t\t\tAuthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateUnauth_Role',\n\t\t\t\t\tUnauthRoleArn: 'arn:aws:iam::823322155619:role/Cognito_TessellateAuth_Role'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tlet storage = new Matter('tesselate').storage;\n\n\tlet request = {\n\t\tget(endpoint, queryData) {\n\t\t\tvar req = superagent.get(endpoint);\n\t\t\tif (queryData) {\n\t\t\t\treq.query(queryData);\n\t\t\t}\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tpost(endpoint, data) {\n\t\t\tvar req = superagent.post(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tput(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t},\n\t\tdel(endpoint, data) {\n\t\t\tvar req = superagent.put(endpoint).send(data);\n\t\t\treq = addAuthHeader(req);\n\t\t\treturn handleResponse(req);\n\t\t}\n\n\t};\n\n\tfunction handleResponse(req) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\treq.end((err, res) => {\n\t\t\t\tif (!err) {\n\t\t\t\t\t// console.log('Response:', res);\n\t\t\t\t\treturn resolve(res.body);\n\t\t\t\t} else {\n\t\t\t\t\tif (err.status == 401) {\n\t\t\t\t\t\tconsole.warn('Unauthorized. You must be signed into make this request.');\n\t\t\t\t\t}\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\tfunction addAuthHeader(req) {\n\t\tif (storage.getItem(config.tokenName)) {\n\t\t\treq = req.set('Authorization', 'Bearer ' + storage.getItem(config.tokenName));\n\t\t\tconsole.log('Set auth header');\n\t\t}\n\t\treturn req;\n\t}\n\n\t/**\n\t * Application class.\n\t *\n\t */\n\tclass _Application {\n\t\tconstructor(appData) {\n\t\t\tthis.name = appData.name;\n\t\t\tthis.owner = appData.owner || null;\n\t\t\tthis.collaborators = appData.collaborators || [];\n\t\t\tthis.createdAt = appData.createdAt;\n\t\t\tthis.updatedAt = appData.updatedAt;\n\t\t\tthis.frontend = appData.frontend || {};\n\t\t\tthis.backend = appData.backend || {};\n\t\t\tif (Firebase) {\n\t\t\t\tthis.fbRef = new Firebase(config.fbUrl + appData.name);\n\t\t\t}\n\t\t}\n\t\t//Get files list and convert to structure\n\t\tgetStructure() {\n\t\t\treturn this.getFiles().then((filesArray) => {\n\t\t\t\tconst childStruct = childrenStructureFromArray(filesArray);\n\t\t\t\tconsole.log('Child struct from array:', childStruct);\n\t\t\t\treturn childStruct;\n\t\t\t}, (err) => {\n\t\t\t\tconsole.error('[Application.getStructure] Error getting files: ', err);\n\t\t\t\treturn Promise.reject({message: 'Error getting files.', error: err});\n\t\t\t});\n\t\t}\n\t\t//Get files list from S3\n\t\tgetFiles() {\n\t\t\tif (!this.frontend || !this.frontend.bucketName) {\n\t\t\t\tconsole.error('[Applicaiton.getFiles] Attempting to get objects for bucket without name.');\n\t\t\t\treturn Promise.reject({message: 'Bucket name required to get objects'});\n\t\t\t} else {\n\t\t\t\t//If AWS Credential do not exist, set them\n\t\t\t\tif (typeof AWS.config.credentials == 'undefined' || !AWS.config.credentials) {\n\t\t\t\t\t// console.info('AWS creds are being updated to make request');\n\t\t\t\t\tsetAWSConfig();\n\t\t\t\t}\n\t\t\t\tvar s3 = new AWS.S3();\n\t\t\t\tvar listParams = {Bucket: this.frontend.bucketName};\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\ts3.listObjects(listParams, function(err, data) {\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\tconsole.log('[Application.getObjects()] listObjects returned:', data);\n\t\t\t\t\t\t\treturn resolve(data.Contents);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error('[Application.getObjects()] Error listing objects:', err);\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tpublishFile(fileData) {\n\t\t\tif (!this.frontend) {\n\t\t\t\tconsole.error('Frontend data not available. Make sure to call .get().');\n\t\t\t\treturn Promise.reject({message: 'Front end data is required to publish file.'});\n\t\t\t}\n\t\t\tvar saveParams = {Bucket: this.frontent.bucketName, Key: fileData.key,  Body: fileData.content, ACL: 'public-read'};\n\t\t\t//Set contentType from fileData to ContentType parameter of new object\n\t\t\tif (fileData.contentType) {\n\t\t\t\tsaveParams.ContentType = fileData.contentType;\n\t\t\t}\n\t\t\t// console.log('[$aws.$saveFiles] saveParams:', saveParams);\n\t\t\treturn s3.putObject(saveParams, function(err, data) {\n\t\t\t\t//[TODO] Add putting object ACL (make public)\n\t\t\t\tif (!err) {\n\t\t\t\t\tconsole.log('[Application.publishFile()] file saved successfully. Returning:', data);\n\t\t\t\t\treturn data;\n\t\t\t\t}\telse {\n\t\t\t\t\tconsole.error('[Application.publishFile()] Error saving file:', err);\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\taddStorage() {\n\t\t\t//TODO:Add storage bucket\n\t\t\tvar endpoint = config.serverUrl + '/apps/' + this.name + '/storage';\n\t\t\treturn request.post(endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[Application.addStorage()] Apps:', response);\n\t\t\t\treturn new _Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[Application.addStorage()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\tapplyTemplate() {\n\t\t\tvar endpoint = config.serverUrl + '/apps/' + this.name + '/template';\n\t\t\tconsole.log('Applying templates to existing');\n\t\t\t// return request.post(endpoint, appData).then(function(response) {\n\t\t\t// \tconsole.log('[Application.addStorage()] Apps:', response);\n\t\t\t// \tif (!apps.isList) {\n\t\t\t// \t\treturn new Application(response);\n\t\t\t// \t}\n\t\t\t// \treturn response;\n\t\t\t// })['catch'](function(errRes) {\n\t\t\t// \tconsole.error('[Application.addStorage()] Error getting apps list: ', errRes);\n\t\t\t// \treturn Promise.reject(errRes);\n\t\t\t// });\n\t\t}\n\t}\n\n\t//------------------ Utility Functions ------------------//\n\n\t// AWS Config\n\tfunction setAWSConfig() {\n\t\tAWS.config.update({\n\t\t  credentials: new AWS.CognitoIdentityCredentials({\n\t\t  IdentityPoolId: config.aws.cognito.poolId\n\t\t  }),\n\t\t  region: config.aws.region\n\t\t});\n\t}\n\n\t//Convert from array file structure (from S3) to 'children' structure used in Editor GUI (angular-tree-control)\n\t//Examples for two files (index.html and /testFolder/file.js):\n\t//Array structure: [{path:'index.html'}, {path:'testFolder/file.js'}]\n\t//Children Structure [{type:'folder', name:'testfolder', children:[{path:'testFolder/file.js', name:'file.js', filetype:'javascript', contentType:'application/javascript'}]}]\n\tfunction childrenStructureFromArray(fileArray) {\n\t\t// console.log('childStructureFromArray called:', fileArray);\n\t\t//Create a object for each file that stores the file in the correct 'children' level\n\t\tvar mappedStructure = fileArray.map(function(file) {\n\t\t\treturn buildStructureObject(file);\n\t\t});\n\t\treturn combineLikeObjs(mappedStructure);\n\t}\n\t//Convert file with key into a folder/file children object\n\tfunction buildStructureObject(file) {\n\t\tvar pathArray;\n\t\t// console.log('buildStructureObject with:', file);\n\t\tif (_.has(file, 'path')) {\n\t\t\t//Coming from files already having path (structure)\n\t\t\tpathArray = file.path.split('/');\n\t\t} else {\n\t\t\t//Coming from aws\n\t\t\tpathArray = file.Key.split('/');\n\t\t\t// console.log('file before pick:', file);\n\t\t\tfile = _.pick(file, 'Key');\n\t\t\tfile.path = file.Key;\n\t\t\tfile.name = file.Key;\n\t\t}\n\t\tvar currentObj = file;\n\t\tif (pathArray.length == 1) {\n\t\t\tcurrentObj.name = pathArray[0];\n\t\t\tif (!_.has(currentObj,'type')) {\n\t\t\t\tcurrentObj.type = 'file';\n\t\t\t}\n\t\t\tcurrentObj.path = pathArray[0];\n\t\t\treturn currentObj;\n\t\t} else {\n\t\t\tvar finalObj = {};\n\t\t\t_.each(pathArray, (loc, ind, list) => {\n\t\t\t\tif (ind != list.length - 1) {//Not the last loc\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = _.first(list, ind + 1).join('/');\n\t\t\t\t\tcurrentObj.type = 'folder';\n\t\t\t\t\tcurrentObj.children = [{}];\n\t\t\t\t\t//TODO: Find out why this works\n\t\t\t\t\tif (ind == 0) {\n\t\t\t\t\t\tfinalObj = currentObj;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentObj = currentObj.children[0];\n\t\t\t\t} else {\n\t\t\t\t\tcurrentObj.type = 'file';\n\t\t\t\t\tcurrentObj.name = loc;\n\t\t\t\t\tcurrentObj.path = pathArray.join('/');\n\t\t\t\t\tif (file.$id) {\n\t\t\t\t\t\tcurrentObj.$id = file.$id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn finalObj;\n\t\t}\n\t}\n\t//Recursivley combine children of object's that have the same names\n\tfunction combineLikeObjs(mappedArray) {\n\t\tvar takenNames = [];\n\t\tvar finishedArray = [];\n\t\t_.each(mappedArray, (obj, ind, list) => {\n\t\t\tif (takenNames.indexOf(obj.name) == -1) {\n\t\t\t\ttakenNames.push(obj.name);\n\t\t\t\tfinishedArray.push(obj);\n\t\t\t} else {\n\t\t\t\tvar likeObj = _.findWhere(mappedArray, {name: obj.name});\n\t\t\t\t//Combine children of like objects\n\t\t\t\tlikeObj.children = _.union(obj.children, likeObj.children);\n\t\t\t\tlikeObj.children = combineLikeObjs(likeObj.children);\n\t\t\t\t// console.log('extended obj:',likeObj);\n\t\t\t}\n\t\t});\n\t\treturn finishedArray;\n\t}\n\n\t//Actions for specific application\n\tclass AppAction {\n\t\tconstructor(appName) {\n\t\t\tif (appName) {\n\t\t\t\tthis.name = appName;\n\t\t\t\tthis.endpoint = `${config.serverUrl}/apps/${this.name}`;\n\t\t\t} else {\n\t\t\t\tconsole.error('Application name is required to start an AppAction');\n\t\t\t\tthrow new Error('Application name is required to start an AppAction');\n\t\t\t}\n\t\t}\n\t\t//Get applications or single application\n\t\tget() {\n\t\t\treturn request.get(this.endpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.app().get()] App(s) data loaded:', response);\n\t\t\t\treturn new _Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.app().get()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update an application\n\t\tupdate(appData) {\n\t\t\treturn request.put(this.endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().update()] App:', response);\n\t\t\t\treturn new _Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.apps().update()] Error updating app: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete an application\n\t\tdel(appData) {\n\t\t\treturn request.delete(this.endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().del()] Apps:', response);\n\t\t\t\treturn new _Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.apps().del()] Error deleting app: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\tgetFiles() {\n\t\t\treturn this.get().then((app) => {\n\t\t\t\tapp.getFiles().then((filesArray)=> {\n\t\t\t\t\treturn filesArray;\n\t\t\t\t})['catch']((err) => {\n\t\t\t\t\tconsole.error('[MatterClient.app().getFiles()] Error getting application files: ', err);\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t});\n\t\t\t})['catch']((err) => {\n\t\t\t\tconsole.error('[MatterClient.app().getFiles()] Error getting application: ', err);\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t\t}\n\n\t\tgetStructure() {\n\t\t\treturn this.get().then((app) => {\n\t\t\t\treturn app.getStructure().then((structure)=> {\n\t\t\t\t\tconsole.log('Structure loaded: ', structure);\n\t\t\t\t\treturn structure;\n\t\t\t\t})['catch']((err) => {\n\t\t\t\t\tconsole.error('[MatterClient.app().getStructure()] Error getting application structure: ', err);\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t});\n\t\t\t})['catch']((err) => {\n\t\t\t\tconsole.error('[MatterClient.app().getStructure()] Error getting application: ', err);\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t\t}\n\t}\n\n\t//Actions for applications list\n\tclass AppsAction {\n\t\tconstructor() {\n\t\t\tthis.endpoint = config.serverUrl + '/apps';\n\t\t}\n\t\t//Get applications or single application\n\t\tget() {\n\t\t\treturn request.get(this.endpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().get()] App(s) data loaded:', response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.apps().get()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\treturn request.post(this.endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().add()] Application added successfully: ', response);\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.getApps()] Error adding application: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * User class.\n\t *\n\t */\n\tclass User {\n\t\tconstructor(userData) {\n\t\t\tthis.name = userData.name;\n\t\t\tthis.username = userData.username;\n\t\t\tthis.createdAt = userData.createdAt;\n\t\t\tthis.updatedAt = userData.updatedAt;\n\t\t}\n\t\tget apps() {\n\t\t\treturn new AppsAction();\n\t\t}\n\t\tapp(appName) {\n\t\t\t//TODO: Attach owner as well ?\n\t\t\treturn new AppAction(appName);\n\t\t}\n\t}\n\n\t//Actions for specific user\n\tclass UserAction {\n\t\tconstructor(userName) {\n\t\t\tif (userName) {\n\t\t\t\tthis.name = userName;\n\t\t\t\tthis.endpoint = `${config.serverUrl}/users/${this.name}`;\n\t\t\t} else {\n\t\t\t\tconsole.error('Username is required to start an UserAction');\n\t\t\t\tthrow new Error('Username is required to start an UserAction');\n\t\t\t}\n\t\t}\n\t\t//Get userlications or single userlication\n\t\tget() {\n\t\t\treturn request.get(this.endpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.user().get()] App(s) data loaded:', response);\n\t\t\t\treturn new User(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.user().get()] Error getting users list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Update an userlication\n\t\tupdate(userData) {\n\t\t\treturn request.put(this.endpoint, userData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.users().update()] App:', response);\n\t\t\t\treturn new User(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.users().update()] Error updating user: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Delete an userlication\n\t\t//TODO: Only do request if deleting personal account\n\t\tdel(userData) {\n\t\t\tconsole.error('Deleting a user is currently disabled.');\n\t\t\t// return request.delete(this.endpoint, userData).then((response) => {\n\t\t\t// \tconsole.log('[MatterClient.users().del()] Apps:', response);\n\t\t\t// \treturn new User(response);\n\t\t\t// })['catch']((errRes) => {\n\t\t\t// \tconsole.error('[MatterClient.users().del()] Error deleting user: ', errRes);\n\t\t\t// \treturn Promise.reject(errRes);\n\t\t\t// });\n\t\t}\n\t}\n\n\t//Actions for applications list\n\tclass UsersAction {\n\t\tconstructor() {\n\t\t\tthis.endpoint = config.serverUrl + '/users';\n\t\t}\n\t\t//Get applications or single application\n\t\tget(query) {\n\t\t\tlet userEndpoint = this.endpoint;\n\t\t\tif (query && !_.isString(query)) {\n\t\t\t\tconst msg = 'Get only handles username as a string';\n\t\t\t\tconsole.error(msg);\n\t\t\t\treturn Promise.reject({message: msg});\n\t\t\t}\n\t\t\tif (query) {\n\t\t\t userEndpoint = userEndpoint + '/' + query;\n\t\t\t}\n\t\t\treturn request.get(userEndpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().get()] App(s) data loaded:', response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.apps().get()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Add an application\n\t\tadd(appData) {\n\t\t\treturn request.post(this.endpoint, appData).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.apps().add()] Application added successfully: ', response);\n\t\t\t\treturn new Application(response);\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.getApps()] Error adding application: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t\t//Search with partial of username\n\t\tsearch(query) {\n\t\t\tconsole.log('search called:', query);\n\t\t\tvar searchEndpoint = this.endpoint + '/search/';\n\t\t\tif (query && _.isString(query)) {\n\t\t\t\tsearchEndpoint += query;\n\t\t\t}\n\t\t\tconsole.log('searchEndpoint:', searchEndpoint);\n\t\t\treturn request.get(searchEndpoint).then((response) => {\n\t\t\t\tconsole.log('[MatterClient.users().search()] Users(s) data loaded:', response);\n\t\t\t\treturn response;\n\t\t\t})['catch']((errRes) => {\n\t\t\t\tconsole.error('[MatterClient.users().search()] Error getting apps list: ', errRes);\n\t\t\t\treturn Promise.reject(errRes);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**Grout Client Class\n\t * @ description Extending matter provides token storage and login/logout/signup capabilities\n\t */\n\tclass Grout extends Matter {\n\t\t//TODO: Use getter/setter to make this not a function\n\t\tconstructor() {\n\t\t\t//Call matter with tessellate\n\t\t\tsuper('tessellate', {localServer: true});\n\t\t}\n\t\t//Start a new Apps Action\n\t\tget apps() {\n\t\t\tconsole.log('New AppsAction:', new AppsAction());\n\t\t\treturn new AppsAction();\n\t\t}\n\t\t//Start a new App action\n\t\tapp(appName) {\n\t\t\tconsole.log('New AppAction:', new AppAction(appName));\n\t\t\treturn new AppAction(appName);\n\t\t}\n\t\t//Start a new Users action\n\t\tget users() {\n\t\t\treturn new UsersAction();\n\t\t}\n\t\t//Start a new User action\n\t\tuser(username) {\n\t\t\treturn new UserAction(username);\n\t\t}\n\t};\n\n\treturn Grout;\n\n}));"],"sourceRoot":"/source/"}